<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Castie! Notes</title>
  <meta name="description"
    content="  å›é¡¾ä¸ŠæœŸçš„å†…å®¹, æˆ‘ä»¬é€šè¿‡Koaæ­å»ºæœåŠ¡å™¨å®ç°äº†ç§»åŠ¨ç«¯ä¸åç«¯çš„äº¤äº’, ä½¿å¾—appä¸å†åªæ˜¯ä¸ªå£³å­,  é€šè¿‡CocoaPodsé›†æˆäº†AlamofireæˆåŠŸè°ƒç”¨åç«¯çš„API, å®ç°äº†æœ€ç²¾ç®€ä¹Ÿæ˜¯æœ€ç»å…¸çš„MVCæ¶æ„, ä»Šå¤©æˆ‘ä»¬æ¥è¯´è¯´ä¹‹å‰å¤§çƒ­çš„MVVMæ¶æ„.ä»£ç è¯¦è§:github">
  <meta name="author" content="Wei Wang">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title"
    content="Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM">
  <meta name="twitter:description"
    content="  å›é¡¾ä¸ŠæœŸçš„å†…å®¹, æˆ‘ä»¬é€šè¿‡Koaæ­å»ºæœåŠ¡å™¨å®ç°äº†ç§»åŠ¨ç«¯ä¸åç«¯çš„äº¤äº’, ä½¿å¾—appä¸å†åªæ˜¯ä¸ªå£³å­,  é€šè¿‡CocoaPodsé›†æˆäº†AlamofireæˆåŠŸè°ƒç”¨åç«¯çš„API, å®ç°äº†æœ€ç²¾ç®€ä¹Ÿæ˜¯æœ€ç»å…¸çš„MVCæ¶æ„, ä»Šå¤©æˆ‘ä»¬æ¥è¯´è¯´ä¹‹å‰å¤§çƒ­çš„MVVMæ¶æ„.ä»£ç è¯¦è§:github">

  <meta property="og:type" content="article">
  <meta property="og:title"
    content="Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM">
  <meta property="og:description"
    content="  å›é¡¾ä¸ŠæœŸçš„å†…å®¹, æˆ‘ä»¬é€šè¿‡Koaæ­å»ºæœåŠ¡å™¨å®ç°äº†ç§»åŠ¨ç«¯ä¸åç«¯çš„äº¤äº’, ä½¿å¾—appä¸å†åªæ˜¯ä¸ªå£³å­,  é€šè¿‡CocoaPodsé›†æˆäº†AlamofireæˆåŠŸè°ƒç”¨åç«¯çš„API, å®ç°äº†æœ€ç²¾ç®€ä¹Ÿæ˜¯æœ€ç»å…¸çš„MVCæ¶æ„, ä»Šå¤©æˆ‘ä»¬æ¥è¯´è¯´ä¹‹å‰å¤§çƒ­çš„MVVMæ¶æ„.ä»£ç è¯¦è§:github">

  <link rel="icon" type="image/ico" href="/assets/images/favicon.ico" />
  <link href="/assets/images/favicon.ico" rel="shortcut icon" type="image/ico">

  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%90%8E%E7%AB%AFKoa.js%E5%B9%B6%E8%BF%87%E5%BA%A6%E5%88%B0MVVM/">
  <link rel="alternate" type="application/rss+xml" title="Castie!"
    href="http://localhost:4000/feed.xml">

  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
</head>

  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/#blog" title="å‰å¾€ Castie! çš„ä¸»é¡µ" class="blog-button"><img src="/assets/images/avatar.jpg" width="80" alt="Castie! logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for Castie!" class="blog-button">Castie!</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">æ­£æ€åˆ†å¸ƒ, ä¼˜åŠ£ä¼´ç”Ÿ</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">åŒ—å†¥æœ‰é±¼ï¼Œå…¶åä¸ºé²²ï¼ˆkÅ«nï¼‰ã€‚é²²ä¹‹å¤§ï¼Œä¸çŸ¥å…¶å‡ åƒé‡Œä¹Ÿï¼›åŒ–è€Œä¸ºé¸Ÿï¼Œå…¶åä¸ºé¹ã€‚é¹ä¹‹èƒŒï¼Œä¸çŸ¥å…¶å‡ åƒé‡Œä¹Ÿï¼›æ€’è€Œé£ï¼Œå…¶ç¿¼è‹¥å‚å¤©ä¹‹äº‘ã€‚æ˜¯é¸Ÿä¹Ÿï¼Œæµ·è¿åˆ™å°†å¾™äºå—å†¥ã€‚å—å†¥è€…ï¼Œå¤©æ± ä¹Ÿã€‚</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        <p class="panel-cover__description">åŒ—æµ·è‹¥æ›°ï¼šâ€œäº•é¼ƒä¸å¯ä»¥è¯­äºæµ·è€…ï¼Œæ‹˜äºè™šä¹Ÿï¼›å¤è™«ä¸å¯ä»¥è¯­äºå†°è€…ï¼Œç¬ƒäºæ—¶ä¹Ÿï¼›æ›²å£«ä¸å¯ä»¥è¯­äºé“è€…ï¼ŒæŸäºæ•™ä¹Ÿã€‚ä»Šå°”å‡ºäºå´–æ¶˜ï¼Œè§‚äºå¤§æµ·ï¼Œä¹ƒçŸ¥å°”ä¸‘ï¼Œå°”å°†å¯ä¸è¯­å¤§ç†çŸ£ã€‚</p>
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="è®¿é—®åšå®¢" class="blog-button">åšå®¢</a></li>
                
                  <li class="navigation__item"><a href="https://coderzsq.github.io/coderZsq.practice.web/" target="_blank" title="æˆ‘çš„ç®€å†">ç®€å†</a></li>
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
    <!-- juejin-->
    <li class="navigation__item">
      <a href="https://juejin.im/user/57e735dfa22b9d00614eecb8/posts" title="@coderZsq çš„ç¨€åœŸæ˜é‡‘" target="_blank">
        <i class='social fa fa-book'></i>
        <span class="label">juejin</span>
      </a>
    </li>
    

  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/coderZsq" title="@coderZsq çš„ Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  

  

  

  <!-- RSS -->
  <li class="navigation__item">
    <a href="/feed.xml" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>

  
  <!-- Email -->
  <li class="navigation__item">
    <a href="mailto:a13701777868@gmail.com" title="Contact me">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>
  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-disabled"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2017-04-11 12:42:00 +0800" itemprop="datePublished" class="post-meta__date date">2017-04-11</time> &#8226; <span class="post-meta__tags tags">ç§»åŠ¨å¼€å‘</span>
    </div>
    <h1 class="post-title">Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM</h1>
  </header>

  <section class="post">
    <blockquote>
  <p>å›é¡¾ä¸ŠæœŸçš„å†…å®¹, æˆ‘ä»¬é€šè¿‡Koaæ­å»ºæœåŠ¡å™¨å®ç°äº†ç§»åŠ¨ç«¯ä¸åç«¯çš„äº¤äº’, ä½¿å¾—appä¸å†åªæ˜¯ä¸ªå£³å­,  é€šè¿‡CocoaPodsé›†æˆäº†AlamofireæˆåŠŸè°ƒç”¨åç«¯çš„API, å®ç°äº†æœ€ç²¾ç®€ä¹Ÿæ˜¯æœ€ç»å…¸çš„MVCæ¶æ„, ä»Šå¤©æˆ‘ä»¬æ¥è¯´è¯´ä¹‹å‰å¤§çƒ­çš„MVVMæ¶æ„.ä»£ç è¯¦è§:<a href="coderZsq.target.swift">github</a></p>
</blockquote>

<p><img src="http://upload-images.jianshu.io/upload_images/1229762-3866097366648136.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

<h6 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥:</h6>

<ul>
  <li><a href="http://www.jianshu.com/p/5a03995a6ce1">Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹</a></li>
</ul>

<p>ä»¥ä¸‹å†…å®¹åœ¨ä¸Šè¿°æ–‡ç« åŸºç¡€ä¸Šè¿›è¡Œ, è¯·äº‹å…ˆæŸ¥é˜….</p>

<p>å…¶å®ç°åœ¨iOSå¼€å‘è¿˜æ˜¯åœ¨Objective-Cçš„å¤§ç¯å¢ƒä¸‹, è®©æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨MVVMè¿™ç§æ¶æ„, å…¶å®æˆ‘æ˜¯æ‹’ç»çš„, å› ä¸ºä¸ªäººè§‰å¾—OCçš„ä»£ç è®¾è®¡æ˜¯ä¸é€‚åˆä½¿ç”¨MVVMæ¡†æ¶çš„, å…·ä½“åŸå› å°±æ˜¯ â€œä¸‘â€, ä¸€ä¸ªå­—ä»£è¡¨äº†æ‰€æœ‰çš„è§‚ç‚¹. ä½†ä½œä¸ºæŠ€æœ¯ç ”è®¨, MVVMçš„æ€æƒ³è¿˜æ˜¯æœ‰å‘å¤§å®¶æ™®åŠçš„å¿…è¦çš„.</p>

<p>MVVM</p>

<p>MVVMæ˜¯æŒ‡ Model, View, ViewModel, è¿™é‡Œçš„ViewModelä»£æ›¿äº†åŸå…ˆControllerçš„éƒ¨åˆ†å·¥ä½œ, MVVMçš„æ¦‚å¿µæœ€åˆæ˜¯ä»å‰ç«¯å¼€å§‹çš„, ä»¥åé¢ä¼šè¯´åˆ°çš„Vueä¸¾ä¾‹, æ¯ä¸€ä¸ªVueæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªViewModel, å®ç°äº†åŠ¨æ€ç»‘å®šçš„åŠŸèƒ½, é€šä¿—çš„è¯´å°±æ˜¯å½“æ•°æ®å‘ç”Ÿæ”¹å˜, è§†å›¾ç«‹å³æ”¹å˜, ç›¸åå½“ç”¨æˆ·æ“ä½œè§†å›¾ä¹ŸåŒæ—¶æ“ä½œäº†æ•°æ®. ViewModelä»åå­—ä¸Šæ¥çœ‹å°±æ˜¯Viewå’ŒModelçš„ä¸­é—´å±‚.</p>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç§»åŠ¨ç«¯æ€ä¹ˆå®ç°MVVMæ¶æ„:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>.
â”œâ”€â”€ Controller.swift
â”œâ”€â”€ Model.swift
â”œâ”€â”€ View.swift
â””â”€â”€ ViewModel.swift

</code></pre>
</div>

<p>æˆ‘ä»¬å…ˆåœ¨é¡¹ç›®ç»“æ„ä¸‹æ·»åŠ ViewModel.swift, å°†ä¹‹å‰åœ¨Controllerä¸­çš„ç½‘ç»œè¯·æ±‚ä»£ç ç§»æ¤åˆ°VMä¸­:</p>

<p>ViewModel.swift</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class ViewModel {
    lazy var models: [Model] = [Model]()
}

extension ViewModel {
    
    func dynamicBinding(finishedCallback : @escaping () -&gt; ()) {
        
        Http.requestData(.get, URLString: "http://localhost:3001/api/J1/getJ1List") { (response) in
            guard let result = response as? [String : Any] else { return }
            guard let data:[String : Any] = result["data"] as? [String : Any] else { return }
            guard let models:[[String : Any]] = data["models"] as? [[String : Any]] else { return }
            
            self.models.removeAll()
            for dict in models {
                self.models.append(Model(dict: dict))
            }
            
            finishedCallback()
        }
    }
}

</code></pre>
</div>

<p>å°è´´å£«:
Swiftä¸­çš„Classå¯ä»¥ä¸ç”¨ç»§æ‰¿ç›´æ¥å®šä¹‰, é™ä½å¼€é”€.</p>

<p>æˆ‘ä»¬å¯¹åº”ä¿®æ”¹å…¶ä»–ä»£ç å¦‚ä¸‹:</p>

<p>View.swift</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
class View: UIView {
    
    var viewModel: ViewModel? { //update
        
        didSet {
            tableView.reloadData()
        }
    }
    
    fileprivate lazy var tableView: UITableView = { [weak self] in
        var tableView = UITableView(frame: self!.bounds, style: .plain)
        tableView.dataSource = self
        return tableView
        }()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        addSubview(tableView)
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
}

extension View: UITableViewDataSource {
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {
        return viewModel?.models.count ?? 0 //update
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
        
        let identifier = "identifier"
        let model: Model? = viewModel?.models[indexPath.row] //update
        let cell = tableView.dequeueReusableCell(withIdentifier: identifier) ?? UITableViewCell(style: .subtitle, reuseIdentifier: identifier)
        cell.textLabel?.text = model?.text
        cell.detailTextLabel?.text = model?.detailText
        return cell
    }
}
</code></pre>
</div>

<p>Controller.swift</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
class Controller: UIViewController {

    fileprivate lazy var viewModel: ViewModel = ViewModel() //update
    fileprivate lazy var baseView: View = { [weak self] in
        return View(frame: self!.view.bounds)
    }()
    
    override func loadView() {
        super.loadView()
        title = "J1"
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupView()
        adapterView()
    }
}

extension Controller {
    
    fileprivate func setupView() {
        view.addSubview(baseView)
    }
    

    fileprivate func adapterView() { //update
        viewModel.dynamicBinding {
            self.baseView.viewModel = self.viewModel
        }
    }
}


</code></pre>
</div>

<p>æˆ‘ä»¬é€šè¿‡å°†ç½‘ç»œè¯·æ±‚å°è£…åˆ°ViewModelä¸­å®ç°äº†ä»£ç åˆ†å±‚, è®¾è®¡ä¹Ÿæ›´ä¸ºç®€æ´. ä½†æ˜¯æˆ‘ä»¬ç°åœ¨çš„ç”¨æˆ·ç•Œé¢å¥½Lowå•Š, æ˜¯ä¸æ˜¯åº”è¯¥åšç‚¹ä»€ä¹ˆ? å¯¹äº†, æˆ‘ä»¬ç»™ç•Œé¢é‡Œæ·»åŠ ç‚¹å›¾ç‰‡å§!</p>

<p>å½“ç„¶å›¾ç‰‡æˆ‘ä»¬ä¹Ÿæ˜¯é€šè¿‡åç«¯è·å–, æˆ‘ä»¬åœ¨åç«¯ç›®å½•ä¸­æ·»åŠ image.jsæ–‡ä»¶æ¥å®ç°å›¾ç‰‡æœåŠ¡å™¨.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>.
â””â”€â”€ public
  â””â”€â”€ images
	â””â”€â”€ image.js

</code></pre>
</div>

<p>image.js</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
const http = require('http');
const fs = require('fs');

http.createServer((req, res) =&gt; {
    console.log(req.url);

    let path = '..' + decodeURI(req.url);
    fs.readFile(path, 'binary', (err, file) =&gt; {
        if (err) {
            // console.log(err);
            return;
        } else {
            res.writeHead(200, {
                'Content-Type': 'image/png'
            });
            res.write(file, 'binary');
            res.end();
            return;
        }
    })
}).listen(3002);
console.log('port = 3002');

</code></pre>
</div>
<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯åŸç”Ÿçš„Node.jsæ­å»ºçš„å›¾ç‰‡æœåŠ¡å™¨, ç›‘å¬3002ç«¯å£.</p>

<p>è¿™é‡Œæˆ‘ä»¬æ¥è¯´è¯´æœåŠ¡å™¨æ˜¯å¦‚ä½•å®ç°æƒ³å®¢æˆ·ç«¯ä¼ é€æ•°æ®çš„, æˆ‘ä»¬ç°åœ¨åˆ†ä¸ºAPIæœåŠ¡å™¨: 3001å’Œå›¾ç‰‡æœåŠ¡å™¨: 3002. APIæœåŠ¡å™¨ä¼ è¾“çš„ç±»å‹æ˜¯Content-Type : application/jsonè¿™ç§æ ¼å¼çš„, è€Œå›¾ç‰‡æœåŠ¡å™¨è¿”å›çš„æ˜¯äºŒè¿›åˆ¶çš„æ ¼å¼Content-Typeâ€™: â€˜image/png. åŸç†å°±æ˜¯å°†æ–‡æœ¬æˆ–æ•°æ®å†™åœ¨Bodyä¸Š.</p>

<p>æˆ‘ä»¬cd åˆ°ç›®å½•ä¸­ é€šè¿‡nodeå‘½ä»¤ $ node image.js æ¥æ‰§è¡Œjsè„šæœ¬æ–‡ä»¶. çœ‹åˆ°port = 3002æ‰“å°åœ¨ç»ˆç«¯ä¸Šè¯´æ˜, æœåŠ¡å¯åŠ¨æˆåŠŸ.</p>

<p>æœ‰å›¾ç‰‡æœåŠ¡å™¨, æ²¡æœ‰å›¾ç‰‡æ€ä¹ˆè¡Œ? æˆ‘ä»¬åœ¨imagesä¸­æ·»åŠ å›¾ç‰‡æ–‡ä»¶. æ·»åŠ å®Œååœ¨æµè§ˆå™¨ä¸­è¾“å…¥: http://localhost:3002/images/J1/å…³äºå¥ä¸€@2x.png, å°±èƒ½å¤Ÿè®¿é—®åˆ°æœåŠ¡å™¨çš„å›¾ç‰‡äº†.</p>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å›¾ç‰‡çš„URLåœ°å€é€šè¿‡APIçš„å½¢å¼è¿”å›ç»™ç§»åŠ¨ç«¯è°ƒç”¨.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>.
â””â”€â”€ app
  â””â”€â”€ controllers
	â””â”€â”€ J1.js

</code></pre>
</div>

<p>J1.js</p>

<div class="highlighter-rouge"><pre class="highlight"><code>exports.getJ1List = async(ctx, next) =&gt; {

    ctx.body = {
        models: [{
            text: 'æˆ‘çš„è´¦æˆ·',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;æˆ‘çš„è´¦æˆ·",
            imageUrl: "http://localhost:3002/images/J1/æˆ‘çš„è´¦æˆ·@2x.png"
        }, {
            text: 'æˆ‘çš„ä¼˜æƒ åˆ¸',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;æˆ‘çš„ä¼˜æƒ åˆ¸",
            imageUrl: "http://localhost:3002/images/J1/æˆ‘çš„ä¼˜æƒ åˆ¸@2x.png"
        }, {
            text: 'æ”¶è´§åœ°å€',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;æ”¶è´§åœ°å€",
            imageUrl: "http://localhost:3002/images/J1/æ”¶è´§åœ°å€@2x.png"
        }, {
            text: 'åœ¨çº¿å®¢æœ',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;åœ¨çº¿å®¢æœ",
            imageUrl: "http://localhost:3002/images/J1/åœ¨çº¿å®¢æœ@2x.png"
        }, {
            text: 'ç”¨è¯æé†’',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;ç”¨è¯æé†’",
            imageUrl: "http://localhost:3002/images/J1/ç”¨è¯æé†’@2x.png"
        }, {
            text: 'è¯æŸ¥æŸ¥',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;è¯æŸ¥æŸ¥",
            imageUrl: "http://localhost:3002/images/J1/è¯æŸ¥æŸ¥@2x.png"
        }, {
            text: 'ç–¾ç—…ç™¾ç§‘',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;ç–¾ç—…ç™¾ç§‘",
            imageUrl: "http://localhost:3002/images/J1/ç–¾ç—…ç™¾ç§‘@2x.png"
        }, {
            text: 'è¯å“ç™¾ç§‘',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;è¯å“ç™¾ç§‘",
            imageUrl: "http://localhost:3002/images/J1/è¯å“ç™¾ç§‘@2x.png"
        }, {
            text: 'å¥ä¸€å’¨è¯¢',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;å¥ä¸€å’¨è¯¢",
            imageUrl: "http://localhost:3002/images/J1/å¥ä¸€å’¨è¯¢@2x.png"
        }, {
            text: 'å¸®åŠ©ä¸­å¿ƒ',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;å¸®åŠ©ä¸­å¿ƒ",
            imageUrl: "http://localhost:3002/images/J1/å¸®åŠ©ä¸­å¿ƒ@2x.png"
        }, {
            text: 'ç‚¹èµ/åæ§½',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;ç‚¹èµ/åæ§½",
            imageUrl: "http://localhost:3002/images/J1/ç‚¹èµ:åæ§½@2x.png"
        }, {
            text: 'å…³äºå¥ä¸€',
            detailText: "æ¬¢è¿è¿›å…¥=&gt;å…³äºå¥ä¸€",
            imageUrl: "http://localhost:3002/images/J1/å…³äºå¥ä¸€@2x.png"
        }]
    }
}


</code></pre>
</div>

<p>åœ¨æµè§ˆå™¨è®¿é—®æ¥å£ http://localhost:3001/api/J1/getJ1List</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"models"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æˆ‘çš„è´¦æˆ·"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;æˆ‘çš„è´¦æˆ·"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/æˆ‘çš„è´¦æˆ·@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æˆ‘çš„ä¼˜æƒ åˆ¸"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;æˆ‘çš„ä¼˜æƒ åˆ¸"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/æˆ‘çš„ä¼˜æƒ åˆ¸@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ”¶è´§åœ°å€"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;æ”¶è´§åœ°å€"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/æ”¶è´§åœ°å€@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"åœ¨çº¿å®¢æœ"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;åœ¨çº¿å®¢æœ"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/åœ¨çº¿å®¢æœ@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ç”¨è¯æé†’"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;ç”¨è¯æé†’"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/ç”¨è¯æé†’@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"è¯æŸ¥æŸ¥"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;è¯æŸ¥æŸ¥"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/è¯æŸ¥æŸ¥@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ç–¾ç—…ç™¾ç§‘"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;ç–¾ç—…ç™¾ç§‘"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/ç–¾ç—…ç™¾ç§‘@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"è¯å“ç™¾ç§‘"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;è¯å“ç™¾ç§‘"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/è¯å“ç™¾ç§‘@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"å¥ä¸€å’¨è¯¢"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;å¥ä¸€å’¨è¯¢"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/å¥ä¸€å’¨è¯¢@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"å¸®åŠ©ä¸­å¿ƒ"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;å¸®åŠ©ä¸­å¿ƒ"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/å¸®åŠ©ä¸­å¿ƒ@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ç‚¹èµ/åæ§½"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;ç‚¹èµ/åæ§½"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/ç‚¹èµ:åæ§½@2x.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"å…³äºå¥ä¸€"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ¬¢è¿è¿›å…¥=&gt;å…³äºå¥ä¸€"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"imageUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3002/images/J1/å…³äºå¥ä¸€@2x.png"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
</div>

<p>æ•°æ®è¿”å›æ²¡æœ‰é—®é¢˜äº†, æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä»ç§»åŠ¨ç«¯è®¿é—®æœåŠ¡å™¨å›¾ç‰‡, è¿™é‡Œä½¿ç”¨å–µç¥çš„Kingfisheræ¥è¯·æ±‚å›¾ç‰‡, ä¹‹å‰å·²ç»é€šè¿‡Podså¯¼å…¥åˆ°é¡¹ç›®ä¸­äº†.</p>

<p>ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¡†æ¶çš„æ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦åœ¨å¤–é¢å†å°è£…ä¸€å±‚, æˆ‘ä»¬åˆ›å»ºImage.swift</p>

<p>Image.swift</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import Kingfisher

extension UIImageView {
    
    func loadUrl(imageUrl: String?, placeholder: String = "placeholder") {
        self.kf.setImage(with: URL(string: imageUrl?.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed) ?? ""), placeholder: UIImage(named: placeholder), options: nil, progressBlock: nil, completionHandler: nil)
    }
}

</code></pre>
</div>

<p>æ¥ä¸‹æ¥åœ¨Modelå’ŒViewä¸­æ·»åŠ imageUrlå­—æ®µå¹¶ä¿®æ”¹å¦‚ä¸‹:</p>

<p>Model.swift</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class Model: NSObject {

    var text : String = ""
    var detailText : String = ""
    var imageUrl : String = "" //update

    init(dict : [String : Any]) {
        super.init()
        setValuesForKeys(dict)
    }
    
    override func setValue(_ value: Any?, forUndefinedKey key: String) {}
}

</code></pre>
</div>

<p>View.swift</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class View: UIView {
    
    var viewModel: ViewModel? {
        
        didSet {
            tableView.reloadData()
        }
    }
    
    fileprivate lazy var tableView: UITableView = { [weak self] in
        var tableView = UITableView(frame: self!.bounds, style: .plain)
        tableView.dataSource = self
        tableView.delegate = self //update
        return tableView
    }()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        addSubview(tableView)
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
}

extension View: UITableViewDataSource {
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {
        return viewModel?.models.count ?? 0
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
        
        let identifier = "identifier"
        let model: Model? = viewModel?.models[indexPath.row]
        let cell = tableView.dequeueReusableCell(withIdentifier: identifier) ?? UITableViewCell(style: .subtitle, reuseIdentifier: identifier)
        cell.textLabel?.text = model?.text
        cell.detailTextLabel?.text = model?.detailText
        cell.imageView?.loadUrl(imageUrl: model?.imageUrl) //update
        return cell
    }
}

extension View: UITableViewDelegate { //update
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&gt; CGFloat {
        return 100
    }
    
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
    }
}

</code></pre>
</div>
<p>ä»¥ä¸Šå°±æ˜¯ä¸ªäººç†è§£çš„MVVM, ä¹Ÿè¯´å‡ºä½ å¯¹äºMVVMçš„æƒ³æ³•, æˆ‘ä»¬ä¸€èµ·æ¢è®¨!</p>

<p>About:</p>

<p><img src="http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!" /></p>

<p><a href="https://github.com/coderZsq/coderZsq.target.swift">ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! </a></p>

  </section>
</article>

<section class="read-more">
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">æœ€è¿‘çš„æ–‡ç« </span>
       <h2 class="post-list__post-title post-title"><a href="/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AFVue.js%E5%B9%B6%E5%8D%87%E7%BA%A7%E8%87%B3MVP/" title="link to Hybird æ­å»ºå‰ç«¯Vue.jså¹¶å‡çº§è‡³MVP">Hybird æ­å»ºå‰ç«¯Vue.jså¹¶å‡çº§è‡³MVP</a></h2>
       <p class="excerpt">  ä¸Šå›æˆ‘ä»¬è¯´åˆ°MVVM, è¯´çœŸçš„æˆ‘çœŸæ²¡è§‰å¾—MVVMä¸ºä»€ä¹ˆä¼šé¼“å¹çš„é‚£ä¹ˆç¥, ç”¨å¤§ç¯‡å¹…çš„å™è¿°æˆ‘ç€å®æä¸èµ·åŠ². å›é¡¾ä¸€ä¸‹å†…å®¹, æˆ‘ä»¬é€šè¿‡Node.jsæ­å»ºäº†å›¾ç‰‡æœåŠ¡å™¨, å¹¶é€šè¿‡KingfisheråŠ è½½å‡ºæ¥, è¯´çœŸçš„å‰ä¸¤ç¯‡ä¸»è¦è¿˜æ˜¯å™è¿°ç§»åŠ¨ç«¯å…¥é—¨åç«¯å§.. å™—.. ç¬‘.. è¿™ä¸€èŠ‚æˆ‘ä»¬æ¥è¯´è¯´MVPæ¨¡å¼, ä¹Ÿæ˜¯æˆ‘æ¯”è¾ƒå–œæ¬¢ä»¥åŠæ¨èå¤§å®¶ä½¿ç”¨çš„ä¸€ç§è®¾è®¡æ€æƒ³. ä»£ç è§:githubå‚è€ƒé“¾æ¥:  Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹  Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVMä»¥ä¸‹å†…å®¹åœ¨ä¸Šè¿°æ–‡ç« åŸºç¡€...&hellip;</p>
       <div class="post-list__meta"><time datetime="2017-04-11 15:06:00 +0800" class="post-list__meta--date date">2017-04-11</time> &#8226; <span class="post-list__meta--tags tags">ç§»åŠ¨å¼€å‘</span><a class="btn-border-small" href=/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AFVue.js%E5%B9%B6%E5%8D%87%E7%BA%A7%E8%87%B3MVP/>ç»§ç»­é˜…è¯»</a></div>
   </div>
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">æ›´æ—©çš„æ–‡ç« </span>
       <h2 class="post-list__post-title post-title"><a href="/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E9%9B%B6%E8%80%A6%E5%90%88%E6%9E%B6%E6%9E%84%E4%BB%8EMVC%E5%BC%80%E5%A7%8B/" title="link to Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹">Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹</a></h2>
       <p class="excerpt">  å†™è¿™ä¸ªtargetçš„æƒ³æ³•æ˜¯æºäºæ¥ä¸‹æ¥å¯èƒ½è¦æ¥çš„æ–°é¡¹ç›®, å¼€å‘å°ç»„çš„æˆå‘˜ä»¬éƒ½è¦è¡¨è¾¾å‡ºä¸€äº›å¯¹æ¶æ„è®¾è®¡çš„æƒ³æ³•, è‡ªç„¶å¹³æ—¶æ‡’æ•£çš„æˆ‘ä¹Ÿä¸èƒ½ä¾‹å¤–, æ‰€ä»¥è¿™ä¸ªç³»åˆ—ä¼šåŸºäºæˆ‘æµ…æ˜¾çš„çŸ¥è¯†æ¥è¡¨è¾¾å‡ºæˆ‘å¯¹äºæ¶æ„è®¾è®¡çš„ä¸€äº›æ€è€ƒ, å’Œå¤§å®¶åˆ†äº«, ä»£ç è¯¦è§: githubè¯´åˆ°çƒ­ä¿®å¤, æœ€è¿‘JSPatchè·ªä¸‹æ¥å«çˆ¸çˆ¸çš„ç»å†è¿˜å†å†åœ¨ç›®, é‚£æˆ‘ä»¬çœŸçš„æœ‰çº¿ä¸ŠBugå°±åªèƒ½å‘ç´§æ€¥ç‰ˆæœ¬äº†å—? è™½ç„¶è¯´å®¡æ ¸æ¯”ä»¥å‰å¿«äº†ä½†æ—¶é—´ä¹Ÿä¸çŸ­å•Š, æˆ‘ä»¬çœ‹å¦‚ä½•é€šè¿‡æ¶æ„è®¾è®¡æ¥å®ç°çƒ­ä¿®å¤å§!é¦–å…ˆæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç›®å½•ç»“æ„:.â”œâ”€â”€ appâ”œâ”€â”€ server...&hellip;</p>
       <div class="post-list__meta"><time datetime="2017-04-10 17:17:00 +0800" class="post-list__meta--date date">2017-04-10</time> &#8226; <span class="post-list__meta--tags tags">ç§»åŠ¨å¼€å‘</span><a class="btn-border-small" href=/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E9%9B%B6%E8%80%A6%E5%90%88%E6%9E%B6%E6%9E%84%E4%BB%8EMVC%E5%BC%80%E5%A7%8B/>ç»§ç»­é˜…è¯»</a></div>
   </div>
   
</section>

<section class="post-comments">
  
  
  
  
</section>


            <section class="footer">
    <footer>
    	<span class="footer__copyright">æœ¬ç«™ç‚¹é‡‡ç”¨<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… è®¸å¯åè®®</a></span>
        <span class="footer__copyright">ç”± <a href="https://jekyllrb.com">Jekyll</a> äº 2020-09-16 ç”Ÿæˆï¼Œæ„Ÿè°¢ <a href="https://www.digitalocean.com/?refcode=30ed2d146762">Digital Ocean</a> ä¸ºæœ¬ç«™æä¾›ç¨³å®šçš„ VPS æœåŠ¡</span>
        <span class="footer__copyright">æœ¬ç«™ç”± <a href="https://github.com/coderZsq">@Castie!</a> åˆ›å»ºï¼Œé‡‡ç”¨ <a href="https://github.com/onevcat/vno-jekyll">Vno - Jekyll</a> ä½œä¸ºä¸»é¢˜ï¼Œæ‚¨å¯ä»¥åœ¨ GitHub æ‰¾åˆ°<a href="https://github.com/onevcat/OneV-s-Den">æœ¬ç«™æºç </a> - &copy; 2020</span>
    </footer>
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/main.js"></script>



    
  </body>

</html>
