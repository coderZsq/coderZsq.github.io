<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Castie!</title>
    <description>åŒ—å†¥æœ‰é±¼ï¼Œå…¶åä¸ºé²²ï¼ˆkÅ«nï¼‰ã€‚é²²ä¹‹å¤§ï¼Œä¸çŸ¥å…¶å‡ åƒé‡Œä¹Ÿï¼›åŒ–è€Œä¸ºé¸Ÿï¼Œå…¶åä¸ºé¹ã€‚é¹ä¹‹èƒŒï¼Œä¸çŸ¥å…¶å‡ åƒé‡Œä¹Ÿï¼›æ€’è€Œé£ï¼Œå…¶ç¿¼è‹¥å‚å¤©ä¹‹äº‘ã€‚æ˜¯é¸Ÿä¹Ÿï¼Œæµ·è¿åˆ™å°†å¾™äºå—å†¥ã€‚å—å†¥è€…ï¼Œå¤©æ± ä¹Ÿã€‚</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sat, 16 Dec 2017 17:04:16 +0800</pubDate>
    <lastBuildDate>Sat, 16 Dec 2017 17:04:16 +0800</lastBuildDate>
    <generator>Jekyll v3.4.0</generator>
    
      <item>
        <title>Animations æ ¸å¿ƒåŠ¨ç”»ä»€ä¹ˆçš„è¦ç ”ç©¶é€!</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;çœ‹è¿‡æˆ‘å»å¹´æ–‡ç« çš„åŒå­¦ä»¬ä¸€å®šçŸ¥é“å¯¹äºåŠ¨ç”»æ–¹é¢è¿˜æ˜¯æœ‰ç‚¹å¿ƒå¾—ä½“ä¼šçš„, å¯¹äºæ ¸å¿ƒåŠ¨ç”»çš„å­¦ä¹ , ä¹‹å‰æˆ‘çœ‹çš„æ˜¯&lt;a href=&quot;http://www.amazon.com/iOS-Core-Animation-Advanced-Techniques-ebook/dp/B00EHJCORC/ref=sr_1_1?ie=UTF8&amp;amp;qid=1423192842&amp;amp;sr=8-1&amp;amp;keywords=Core+Animation+Advanced+Techniques&quot;&gt;iOS Core Animation&lt;/a&gt;çš„&lt;a href=&quot;http://wiki.jikexueyuan.com/project/ios-core-animation/&quot;&gt;ç¿»è¯‘ç‰ˆ&lt;/a&gt;, çœ‹å®Œæ„Ÿè§‰çœŸçš„å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿, ä¸è¿‡è¿™æœ¬ä¹¦å·²ç»æœ‰ç‚¹æ—¶æ—¥äº†, æˆ‘ä»¬éœ€è¦ä¸æ—¶ä¿±è¿›å­¦ä¹ æœ€å‰æ²¿çš„æŠ€æœ¯.ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-8f8d322fd1b24ddb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å’Œä¹‹å‰çš„Viewçš„åŠ¨ç”»ä¸€æ ·, è¿™æ¬¡Layerçš„æ ¸å¿ƒåŠ¨ç”», æˆ‘ä»¬ä¹Ÿæ˜¯å…ˆç»†è®²API, å†è¿›è¡Œé¡¹ç›®å®æˆ˜, è¿™æ ·ä¼šæ¯”è¾ƒå®¹æ˜“ç†è§£, æ–°å…¥è¡Œçš„åŒå­¦ä¸ä¼šæœ›è€Œå´æ­¥.å…¶å®åˆšå­¦ä¹ æ ¸å¿ƒåŠ¨ç”»çš„æ—¶å€™è¿˜æœ‰æœ‰ç‚¹éš¾åº¦çš„, å…ˆæä¸¤ä¸ªæ³¨æ„ç‚¹: 1) ç›¸å¯¹äº&lt;code class=&quot;highlighter-rouge&quot;&gt;view&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;center&lt;/code&gt;, å¯¹åº”äº&lt;code class=&quot;highlighter-rouge&quot;&gt;layer&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;anchorPoint&lt;/code&gt;ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;(0.5, 0.5)&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;position&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;layer&lt;/code&gt;ä¸­çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;position&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;anchorPoint&lt;/code&gt;å…¶å®æ˜¯åŒä¸€ä¸ªç‚¹.2) &lt;code class=&quot;highlighter-rouge&quot;&gt;layer&lt;/code&gt;çš„åŠ¨ç”»å…¶å®æ˜¯å‡è±¡è€Œä¸”ä¼šè¢«æ‰“æ–­, &lt;code class=&quot;highlighter-rouge&quot;&gt;view&lt;/code&gt;çš„åŠ¨ç”»æ˜¯ç›´æ¥æ“ä½œèŠ‚ç‚¹çš„. å¥½äº†, æˆ‘ä»¬æ¥çœ‹ä»Šå¤©æ‰€è¦æŒæ¡çš„API:&lt;/p&gt;

&lt;p&gt;åŸºç¡€åŠ¨ç”»:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 2.0, *)
open class CABasicAnimation : CAPropertyAnimation 
    open var fromValue: Any?
    open var toValue: Any?
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;fromValue æ ¹æ®&lt;code class=&quot;highlighter-rouge&quot;&gt;keyPath&lt;/code&gt;è®¾å®šåŸå§‹å€¼&lt;/li&gt;
  &lt;li&gt;toValue æ ¹æ®&lt;code class=&quot;highlighter-rouge&quot;&gt;keyPath&lt;/code&gt;è®¾å®šç›®æ ‡å€¼&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…³é”®å¸§åŠ¨ç”»:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 2.0, *)
open class CAKeyframeAnimation : CAPropertyAnimation 
    open var values: [Any]?
    open var path: CGPath?
    open var keyTimes: [NSNumber]?
    open var timingFunctions: [CAMediaTimingFunction]?
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;values å…³é”®å¸§ çš„å€¼ [x, x, x, â€¦]&lt;/li&gt;
  &lt;li&gt;path å…³é”®å¸§è·¯å¾„, è´å¡å°”æ›²çº¿&lt;/li&gt;
  &lt;li&gt;keyTimes æ¯å¸§çš„è€—æ—¶, ä»¥ç§’ä½œä¸ºè®¡é‡å•ä½&lt;/li&gt;
  &lt;li&gt;timingFunctions ç¼“å†²å‡½æ•°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åŠ¨ç”»ç»„:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 2.0, *)
open class CAAnimationGroup : CAAnimation
    open var animations: [CAAnimation]?
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;animations åŠ¨ç”»ç»„æ•°ç»„, å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;CAAnimation&lt;/code&gt;å¡«å…¥æ•°ç»„ è¿›è¡Œç»„åŠ¨ç”»&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¼¹ç°§åŠ¨ç”»:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 9.0, *)
open class CASpringAnimation : CABasicAnimation
    open var mass: CGFloat 
    open var stiffness: CGFloat
    open var damping: CGFloat
    open var initialVelocity: CGFloat
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;mass ç‰©ä½“çš„è´¨é‡&lt;/li&gt;
  &lt;li&gt;stiffness å¼¹ç°§çš„åˆšåº¦&lt;/li&gt;
  &lt;li&gt;damping ç¼“å†²ç‡ ä¹Ÿç§°é˜»å°¼å€¼&lt;/li&gt;
  &lt;li&gt;initialVelocity åˆå§‹é€Ÿåº¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åŠ¨ç”»ä»£ç†, è¿›è¡Œæ“ä½œç›‘å¬&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;public protocol CAAnimationDelegate : NSObjectProtocol
    @available(iOS 2.0, *)
    optional public func animationDidStart(_ anim: CAAnimation)
    @available(iOS 2.0, *)
    optional public func animationDidStop(_ anim: CAAnimation, finished flag: Bool)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;animationDidStart åŠ¨ç”»å¼€å§‹å‰è°ƒç”¨&lt;/li&gt;
  &lt;li&gt;animationDidStop åŠ¨ç”»ç»“æŸåè°ƒç”¨&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;CAMediaTiming åè®®&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;public protocol CAMediaTiming 
    public var beginTime: CFTimeInterval { get set }
    public var duration: CFTimeInterval { get set }
    public var speed: Float { get set }
    public var repeatCount: Float { get set }
    public var autoreverses: Bool { get set }
    public var fillMode: String { get set }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;beginTime åŠ¨ç”»å¼€å§‹æ—¶é—´, å¯¹æ¯”viewåŠ¨ç”»çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;delay&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;duration åŠ¨ç”»æŒç»­æ—¶é—´&lt;/li&gt;
  &lt;li&gt;speed åŠ¨ç”»é€Ÿåº¦ ä»¥å€ç‡è®¡ç®—, çˆ¶å±‚è®¾ç½®å­å±‚å åŠ &lt;/li&gt;
  &lt;li&gt;repeatCount é‡å¤æ•°é‡&lt;/li&gt;
  &lt;li&gt;autoreverses è‡ªåŠ¨ç¿»è½¬&lt;/li&gt;
  &lt;li&gt;fillMode å¡«å……æ–¹å¼, æ˜¯å¦æ˜¾ç¤ºç¬¬ä¸€å¸§å’Œæœ€åä¸€å¸§&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è®²å®ŒAPI, æˆ‘ä»¬å°±æ¥ä½¿ç”¨è¿™äº›APIè¿›è¡Œå®æˆ˜, å’Œä¹‹å‰ä¸€æ ·, æˆ‘ä»¬å°±é€šè¿‡Stroyboardæ­å»ºç•Œé¢:
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-e3c718347ac66709.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡ @IBOutlet è¿›è¡Œå…³è”&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    @IBOutlet var loginButton: UIButton! //ç™»å½•æŒ‰é’®
    @IBOutlet var heading: UILabel! //é¡¶éƒ¨æ ‡ç­¾
    @IBOutlet var username: UITextField! //ç”¨æˆ·åè¾“å…¥æ¡†
    @IBOutlet var password: UITextField! //å¯†ç è¾“å…¥æ¡†
    
    @IBOutlet var cloud1: UIImageView! // å››ç‰‡äº‘
    @IBOutlet var cloud2: UIImageView!
    @IBOutlet var cloud3: UIImageView!
    @IBOutlet var cloud4: UIImageView!
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨æ§åˆ¶å™¨çš„viewå°†è¦æ˜¾ç¤ºçš„æ—¶å€™è¿›è¡ŒåŠ¨ç”»è®¾ç½®:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)
        
        let formGroup = CAAnimationGroup() //åˆ›å»ºåŠ¨ç”»ç»„
        formGroup.duration = 0.5 //è®¾ç½®ç»„åŠ¨ç”»æ—¶é•¿ä¸º0.5ç§’
        formGroup.fillMode = kCAFillModeBackwards //å°†å¡«å……æ¨¡å¼è®¾ç½®ä¸ºæ˜¾ç¤ºæœ€åä¸€å¸§
        
        let flyRight = CABasicAnimation(keyPath: &quot;position.x&quot;) //åˆ›å»ºåŸºç¡€åŠ¨ç”», keyPathè®¾ç½®ä¸ºæ¨ªå‘ä½ç§»
        flyRight.fromValue = -view.bounds.size.width/2 //è®¾ç½®keyPath: &quot;position.x&quot;çš„èµ·å§‹ä½ç½®
        flyRight.toValue = view.bounds.size.width/2 //è®¾ç½®keyPath: &quot;position.x&quot;çš„ç›®æ ‡ä½ç½®
        
        let fadeFieldIn = CABasicAnimation(keyPath: &quot;opacity&quot;) //åˆ›å»ºåŸºç¡€åŠ¨ç”», keyPathè®¾ç½®ä¸ºé€æ˜ç‡
        fadeFieldIn.fromValue = 0.25 è®¾ç½®keyPath: &quot;opacity&quot;çš„èµ·å§‹å€¼
        fadeFieldIn.toValue = 1.0 è®¾ç½®keyPath: &quot;opacity&quot;çš„ç›®æ ‡å€¼
        
        formGroup.animations = [flyRight, fadeFieldIn] //å°†æ¨ªå‘ä½ç§»å’Œé€æ˜ç‡åŠ¨ç”»åŠ å…¥åŠ¨ç”»ç»„
        heading.layer.add(formGroup, forKey: nil) //å°†åŠ¨ç”»æ·»åŠ åˆ°layerå±‚ä¸Š
        
        formGroup.delegate = self //è®¾ç½®ä»£ç†, ç›‘å¬åŠ¨ç”»è¿›ç¨‹
        formGroup.setValue(&quot;form&quot;, forKey: &quot;name&quot;) //KVCè®¾ç½®å±æ€§
        formGroup.setValue(username.layer, forKey: &quot;layer&quot;) //KVCè®¾ç½®å±æ€§
        
        formGroup.beginTime = CACurrentMediaTime() + 0.3 //åŠ¨ç”»å¼€å§‹æ—¶é—´, ä»ç°åœ¨+0.3ç§’
        username.layer.add(formGroup, forKey: nil) //å°†åŠ¨ç”»æ·»åŠ åˆ°layerå±‚ä¸Š
        
        formGroup.setValue(password.layer, forKey: &quot;layer&quot;) //KVCè®¾ç½®å±æ€§
        formGroup.beginTime = CACurrentMediaTime() + 0.4 //åŠ¨ç”»å¼€å§‹æ—¶é—´, ä»ç°åœ¨+0.4ç§’
        password.layer.add(formGroup, forKey: nil) //å°†åŠ¨ç”»æ·»åŠ åˆ°layerå±‚ä¸Š
        
        let fadeIn = CABasicAnimation(keyPath: &quot;opacity&quot;) 
        fadeIn.fromValue = 0.0
        fadeIn.toValue = 1.0
        fadeIn.duration = 0.5
        fadeIn.fillMode = kCAFillModeBackwards
        fadeIn.beginTime = CACurrentMediaTime() + 0.5
        cloud1.layer.add(fadeIn, forKey: nil)
        
        fadeIn.beginTime = CACurrentMediaTime() + 0.7
        cloud2.layer.add(fadeIn, forKey: nil)
        
        fadeIn.beginTime = CACurrentMediaTime() + 0.9
        cloud3.layer.add(fadeIn, forKey: nil)
        
        fadeIn.beginTime = CACurrentMediaTime() + 1.1
        cloud4.layer.add(fadeIn, forKey: nil)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;åœ¨æ§åˆ¶å™¨çš„viewå·²ç»æ˜¾ç¤ºçš„æ—¶å€™è¿›è¡ŒåŠ¨ç”»è®¾ç½®:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    override func viewDidAppear(_ animated: Bool) {
        super.viewDidAppear(animated)
        
        let groupAnimation = CAAnimationGroup()
        groupAnimation.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseIn) //æ·»åŠ ç¼“å†²å‡½æ•°
        groupAnimation.beginTime = CACurrentMediaTime() + 0.5
        groupAnimation.duration = 0.5
        groupAnimation.fillMode = kCAFillModeBackwards
        
        let scaleDown = CABasicAnimation(keyPath: &quot;transform.scale&quot;)
        scaleDown.fromValue = 3.5
        scaleDown.toValue = 1.0
        
        let rotate = CABasicAnimation(keyPath: &quot;transform.rotation&quot;)
        rotate.fromValue = CGFloat(M_PI_4)
        rotate.toValue = 0.0
        
        let fade = CABasicAnimation(keyPath: &quot;opacity&quot;)
        fade.fromValue = 0.0
        fade.toValue = 1.0
        
        groupAnimation.animations = [scaleDown, rotate, fade]
        loginButton.layer.add(groupAnimation, forKey: nil)
        
        animateCloud(layer: cloud1.layer)
        animateCloud(layer: cloud2.layer)
        animateCloud(layer: cloud3.layer)
        animateCloud(layer: cloud4.layer)
        
        let flyLeft = CABasicAnimation(keyPath: &quot;position.x&quot;)
        flyLeft.fromValue = info.layer.position.x + view.frame.size.width
        flyLeft.toValue = info.layer.position.x
        flyLeft.duration = 5.0
        flyLeft.repeatCount = 2.5
        flyLeft.autoreverses = true
        info.layer.add(flyLeft, forKey: &quot;infoappear&quot;)
        
        let fadeLabelIn = CABasicAnimation(keyPath: &quot;opacity&quot;)
        fadeLabelIn.fromValue = 0.2
        fadeLabelIn.toValue = 1.0
        fadeLabelIn.duration = 4.5
        info.layer.add(fadeLabelIn, forKey: &quot;fadein&quot;)
        
        username.delegate = self
        password.delegate = self
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å½“ç™»å½•æŒ‰é’®ç‚¹å‡»çš„æ—¶å€™è®¾ç½®åŠ¨ç”»&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    @IBAction func login() {
        view.endEditing(true)
        
        ...

        let balloon = CALayer()
        balloon.contents = UIImage(named: &quot;balloon&quot;)!.cgImage //layerå¯„å®¿å›¾è®¾ç½®
        balloon.frame = CGRect(x: -50.0, y: 0.0, width:
            50.0, height: 65.0)
        view.layer.insertSublayer(balloon, below: username.layer)
        
        let flight = CAKeyframeAnimation(keyPath: &quot;position&quot;) //æ·»åŠ å…³é”®å¸§åŠ¨ç”»
        flight.duration = 12.0
        flight.values = [ //NSValueç»“æ„å€¼
            CGPoint(x: -50, y: 0.0),
            CGPoint(x: view.frame.width + 50.0, y: 160.0),
            CGPoint(x: -50.0, y: loginButton.center.y)
            ].map { NSValue(cgPoint: $0)} //è¿›è¡Œmapæ˜ å°„
        flight.keyTimes = [0.0, 0.5, 1.0]
        balloon.add(flight, forKey: nil)
        balloon.position = CGPoint(x: -50.0, y: loginButton.center.y)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;CAAnimationDelegate&lt;/code&gt;ä»£ç†æ–¹æ³•è¿›è¡Œç›‘å¬:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;extension ViewController: CAAnimationDelegate {
    func animationDidStop(_ anim: CAAnimation, finished flag: Bool) { //å½“åŠ¨ç”»ç»“æŸåè°ƒç”¨
        print(&quot;animation did finish&quot;)
        
        if let name = anim.value(forKey: &quot;name&quot;) as? String {
            if name == &quot;form&quot; { //æ‹¿åˆ°KVCçš„å€¼
                //form field found
                let layer = anim.value(forKey: &quot;layer&quot;) as? CALayer
                anim.setValue(nil, forKey: &quot;layer&quot;) //æ¸…ç©ºKVCè®¾å€¼
                
                let pulse = CASpringAnimation(keyPath: &quot;transform.scale&quot;) //æ·»åŠ å¼¹ç°§åŠ¨ç”»
                pulse.damping = 7.5 //é˜»å°¼ç‡ä¸º7.5
                pulse.fromValue = 1.25
                pulse.toValue = 1.0
                pulse.duration = pulse.settlingDuration
                layer?.add(pulse, forKey: nil)
            }
            
            if name == &quot;cloud&quot; {
                guard let layer = anim.value(forKey: &quot;layer&quot;) as? CALayer else {
                    return
                }
                
                anim.setValue(nil, forKey: &quot;layer&quot;)
                
                layer.position.x = -layer.bounds.width/2
                delay(seconds: 0.5) {
                    self.animateCloud(layer: layer)
                }
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;UITextFieldDelegate&lt;/code&gt;ä»£ç†æ–¹æ³•è¿›è¡Œç›‘å¬:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;extension ViewController: UITextFieldDelegate {
    func textFieldDidBeginEditing(_ textField: UITextField) {
        print(info.layer.animationKeys())
        info.layer.removeAnimation(forKey: &quot;infoappear&quot;) //å½“ç”¨æˆ·è¾“å…¥çš„æ—¶å€™ç§»é™¤åŠ¨ç”»
    }
    
    func textFieldDidEndEditing(_ textField: UITextField) {
        guard let text = textField.text else { return }
        if text.characters.count &amp;lt; 5 {
            // add animations here
            
            let jump = CASpringAnimation(keyPath: &quot;position.y&quot;) //å½“ç”¨æˆ·è¾“å…¥å®Œæˆåæ·»åŠ å¼¹ç°§åŠ¨ç”»
            jump.initialVelocity = 100.0 //åˆå§‹é€Ÿåº¦ä¸º100
            jump.mass = 10.0 //layerçš„è´¨é‡ä¸º10
            jump.stiffness = 1500.0 //å¼¹ç°§åˆšåº¦ä¸º1500
            jump.damping = 50.0 //é˜»å°¼ç‡ä¸º50
            jump.fromValue = textField.layer.position.y + 1.0
            jump.toValue = textField.layer.position.y
            jump.duration = jump.settlingDuration //æŒç»­æ—¶é—´è®¾ç½®ä¸ºç³»ç»Ÿè®¤ä¸ºåˆç†çš„æ—¶é—´
            textField.layer.add(jump, forKey: nil)
            
            textField.layer.borderWidth = 3.0
            textField.layer.borderColor = UIColor.clear.cgColor
            
            let flash = CASpringAnimation(keyPath: &quot;borderColor&quot;)
            flash.damping = 7.0
            flash.stiffness = 200.0
            flash.fromValue = UIColor(red: 1.0, green: 0.27, blue: 0.0, alpha: 1.0).cgColor
            flash.toValue = UIColor.white.cgColor
            flash.duration = flash.settlingDuration
            textField.layer.add(flash, forKey: nil)
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-d737971df1e1fdd9.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 27 Apr 2017 10:44:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/Animations-%E6%A0%B8%E5%BF%83%E5%8A%A8%E7%94%BB%E4%BB%80%E4%B9%88%E7%9A%84%E8%A6%81%E7%A0%94%E7%A9%B6%E9%80%8F!/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/Animations-%E6%A0%B8%E5%BF%83%E5%8A%A8%E7%94%BB%E4%BB%80%E4%B9%88%E7%9A%84%E8%A6%81%E7%A0%94%E7%A9%B6%E9%80%8F!/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>Animations ä½ çœŸçš„ä¼šç”¨Viewçš„åŠ¨ç”»å—?</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;RxSwiftçš„å­¦ä¹ æˆ‘ä»¬å…ˆå‘Šä¸€æ®µè½, å®åœ¨æ˜¯å¤ªçƒ§è„‘äº†, ä»Šå¤©æˆ‘ä»¬æ¢æ¢è„‘å­, ç©ç‚¹è½»æ¾çš„åŠ¨ç”», å»å¹´æˆ‘è¿è½½äº†ä¸€ç³»åˆ—åŸºäºæœ¬äººå°è£…çš„Objective-Cæ¡†æ¶&lt;a href=&quot;https://github.com/coderZsq/coderZsq.project.oc&quot;&gt;SQExtension&lt;/a&gt;å±•å¼€çš„é¡¹ç›®å®æˆ˜, é‡Œé¢å…³äºåŠ¨ç”»æ–¹é¢çš„æ¶‰åŠè¿˜æ˜¯è›®å¤šçš„ä»¥è‡³äºå—åˆ°äº†è…¾è®¯çš„å…³æ³¨. è¿™ä¸ªç³»åˆ—æˆ‘ä»¬å°±æ¥ç»†è®²åŠ¨ç”», ä¸€èµ·èµ°ä¸Šè¿›é˜¶ä¹‹è·¯. ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-8f8d322fd1b24ddb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¯¹äºåŠ¨ç”»æ–¹é¢é™¤äº†æœ€åŸºæœ¬çš„ViewåŠ¨ç”»ä¹‹å¤–, å…³äºLayerçš„æ ¸å¿ƒåŠ¨ç”»æˆ‘éƒ½æ˜¯çœ‹è¿™ç¯‡&lt;a href=&quot;http://wiki.jikexueyuan.com/project/ios-core-animation/&quot;&gt;wiki&lt;/a&gt;å­¦çš„, åƒå»å¹´è¿è½½çš„ä¸€äº›è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»æ˜¯ä»&lt;a href=&quot;https://www.objccn.io/&quot;&gt;Objc&lt;/a&gt;ä¸­å­¦çš„. è¿™æ¬¡ä¹°äº†Rayå®¶çš„ä¸€ç³»åˆ—æ•™ç¨‹, å°±æ‰“ç®—å°†åŠ¨ç”»å­¦é€, ä¸å†åªæ˜¯ç¢ç‰‡åŒ–çš„çŸ¥è¯†.å’Œè¿è½½RxSwiftä¸åŒ, è¿™æ¬¡æˆ‘ä»¬å…ˆå¸¦å¤§å®¶ç†Ÿæ‚‰APIä»¥ä¾¿æ›´å¥½çš„ç†è§£.&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªåº”è¯¥æ˜¯æ‰€æœ‰åšåŠ¨ç”»æœ€å¸¸ç”¨çš„æ–¹æ³•äº†, å¤§å¤šåŸºæœ¬éƒ½æ˜¯è¿™ä¸ªæ–¹æ³•çš„å˜ä½“.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 4.0, *)
    open class func animate(withDuration duration: TimeInterval, delay: TimeInterval, options: UIViewAnimationOptions = [], animations: @escaping () -&amp;gt; Swift.Void, completion: (@escaping (Bool) -&amp;gt; Swift.Void)? = nil)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;duration æŒç»­æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;delay å»¶è¿Ÿè°ƒç”¨æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;options åŠ¨ç”»é€‰é¡¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;[], .x, [.x, .x, ...]&lt;/code&gt;ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;animations åŠ¨ç”»ä»£ç å—, æ‰§è¡Œå¯åŠ¨ç”»å±æ€§çš„æ”¹å˜&lt;/li&gt;
  &lt;li&gt;completion åŠ¨ç”»å®Œæˆåè°ƒç”¨çš„å°¾éšé—­åŒ…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™ä¸ªæ˜¯7.0å¼€å§‹ä½¿ç”¨çš„åŠ¨ç”», å¼¹ç°§æ•ˆæœ&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 7.0, *)
    open class func animate(withDuration duration: TimeInterval, delay: TimeInterval, usingSpringWithDamping dampingRatio: CGFloat, initialSpringVelocity velocity: CGFloat, options: UIViewAnimationOptions = [], animations: @escaping () -&amp;gt; Swift.Void, completion: (@escaping (Bool) -&amp;gt; Swift.Void)? = nil)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;duration æŒç»­æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;delay å»¶è¿Ÿè°ƒç”¨æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;usingSpringWithDamping å‡éœ‡æ¯”ç‡&lt;/li&gt;
  &lt;li&gt;initialSpringVelocity åˆå§‹é€Ÿåº¦&lt;/li&gt;
  &lt;li&gt;options åŠ¨ç”»é€‰é¡¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;[], .x, [.x, .x, ...]&lt;/code&gt;ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;animations åŠ¨ç”»ä»£ç å—, æ‰§è¡Œå¯åŠ¨ç”»å±æ€§çš„æ”¹å˜&lt;/li&gt;
  &lt;li&gt;completion åŠ¨ç”»å®Œæˆåè°ƒç”¨çš„å°¾éšé—­åŒ…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™ä¸ªæ˜¯å…³äºUIViewçš„è½¬åœºåŠ¨ç”», å¯ä»¥å¯¹ä¸å¯åŠ¨ç”»å±æ€§è¿›è¡Œè½¬åœºåŠ¨ç”»&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 4.0, *)
    open class func transition(with view: UIView, duration: TimeInterval, options: UIViewAnimationOptions = [], animations: (@escaping () -&amp;gt; Swift.Void)?, completion: (@escaping (Bool) -&amp;gt; Swift.Void)? = nil)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;view è¿›è¡Œè½¬åœºçš„View&lt;/li&gt;
  &lt;li&gt;duration æŒç»­æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;options åŠ¨ç”»é€‰é¡¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;[], .x, [.x, .x, ...]&lt;/code&gt;ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;animations åŠ¨ç”»ä»£ç å—, æ‰§è¡Œå¯åŠ¨ç”»å±æ€§çš„æ”¹å˜&lt;/li&gt;
  &lt;li&gt;completion åŠ¨ç”»å®Œæˆåè°ƒç”¨çš„å°¾éšé—­åŒ…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿™ä¸ªæ˜¯ä»ä¸€ä¸ªViewè½¬åœºè‡³å¦ä¸€ä¸ªViewçš„åŠ¨ç”»&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 4.0, *)
    open class func transition(from fromView: UIView, to toView: UIView, duration: TimeInterval, options: UIViewAnimationOptions = [], completion: (@escaping (Bool) -&amp;gt; Swift.Void)? = nil) // toView added to fromView.superview, fromView removed from its superview
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;from è¿›è¡Œè½¬åœºçš„View&lt;/li&gt;
  &lt;li&gt;to è½¬åœºåçš„View&lt;/li&gt;
  &lt;li&gt;duration æŒç»­æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;options åŠ¨ç”»é€‰é¡¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;[], .x, [.x, .x, ...]&lt;/code&gt;ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;completion åŠ¨ç”»å®Œæˆåè°ƒç”¨çš„å°¾éšé—­åŒ…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…³é”®å¸§åŠ¨ç”»:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 7.0, *)
    open class func animateKeyframes(withDuration duration: TimeInterval, delay: TimeInterval, options: UIViewKeyframeAnimationOptions = [], animations: @escaping () -&amp;gt; Swift.Void, completion: (@escaping (Bool) -&amp;gt; Swift.Void)? = nil)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;duration æŒç»­æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;delay å»¶è¿Ÿè°ƒç”¨æ—¶é—´ ä»¥ç§’ä½œä¸ºå•ä½&lt;/li&gt;
  &lt;li&gt;options åŠ¨ç”»é€‰é¡¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;[], .x, [.x, .x, ...]&lt;/code&gt;ç­‰æ ¼å¼&lt;/li&gt;
  &lt;li&gt;animations åŠ¨ç”»ä»£ç å—, æ‰§è¡Œå¯åŠ¨ç”»å±æ€§çš„æ”¹å˜&lt;/li&gt;
  &lt;li&gt;completion åŠ¨ç”»å®Œæˆåè°ƒç”¨çš„å°¾éšé—­åŒ…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ·»åŠ å…³é”®å¸§:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@available(iOS 7.0, *)
    open class func addKeyframe(withRelativeStartTime frameStartTime: Double, relativeDuration frameDuration: Double, animations: @escaping () -&amp;gt; Swift.Void) // start time and duration are values between 0.0 and 1.0 specifying time and duration relative to the overall time of the keyframe animation
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;withRelativeStartTime ç›¸å¯¹å¼€å§‹æ—¶é—´, å–å€¼èŒƒå›´0~1, æŒ‰ç™¾åˆ†æ¯”å–å€¼&lt;/li&gt;
  &lt;li&gt;relativeDuration ç›¸å¯¹æŒç»­æ—¶é—´ å–å€¼èŒƒå›´0~1, æŒ‰ç™¾åˆ†æ¯”å–å€¼&lt;/li&gt;
  &lt;li&gt;animations åŠ¨ç”»ä»£ç å—, æ‰§è¡Œå¯åŠ¨ç”»å±æ€§çš„æ”¹å˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;APIä¸­æ¶‰åŠåˆ°çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;options&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;UIViewAnimationOptions&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;UIViewKeyframeAnimationOptions&lt;/code&gt;ä¸­çš„æšä¸¾æ•ˆæœè¿˜æ˜¯ä¸€ä¸ªä¸€ä¸ªè¯•ä¼šæœ‰æ›´æ·±çš„ä½“ä¼š.&lt;/p&gt;

&lt;p&gt;è®²å®ŒAPI, æˆ‘ä»¬å°±æ¥ä½¿ç”¨è¿™äº›APIè¿›è¡Œå®æˆ˜, å’Œä¹‹å‰ä¸€æ ·, æˆ‘ä»¬å°±é€šè¿‡Stroyboardæ­å»ºç•Œé¢:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-5da65a4d4bfafb70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡IBOutlet è¿›è¡Œå…³è”&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  @IBOutlet var bgImageView: UIImageView! //èƒŒæ™¯å›¾ç‰‡
  
  @IBOutlet var summaryIcon: UIImageView! //é¡¶éƒ¨å›¾æ ‡
  @IBOutlet var summary: UILabel! //é¡¶éƒ¨æ–‡å­—
  
  @IBOutlet var flightNr: UILabel! //Flightæ–‡å­—
  @IBOutlet var gateNr: UILabel! //Gateæ–‡å­—
  @IBOutlet var departingFrom: UILabel! //å‡ºå‘åœ°æ–‡å­—
  @IBOutlet var arrivingTo: UILabel! //ç›®çš„åœ°æ–‡å­—
  @IBOutlet var planeImage: UIImageView! //é£æœºå›¾ç‰‡
  
  @IBOutlet var flightStatus: UILabel! //çŠ¶æ€æ–‡å­—
  @IBOutlet var statusBanner: UIImageView! //çŠ¶æ€å›¾ç‰‡
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;é¦–å…ˆæˆ‘ä»¬è¿›è¡Œå›¾ç‰‡çš„è½¬åœºåˆ‡æ¢&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  func fadeImageView(imageView: UIImageView, toImage: UIImage, showEffects: Bool) {

    UIView.transition(with: imageView, duration: 1.0, options: .transitionCrossDissolve,
      animations: {
        imageView.image = toImage
      },
      completion: nil
    )

    UIView.animate(withDuration: 1.0, delay: 0.0, options: .curveEaseOut,
      animations: {
        self.snowView.alpha = showEffects ? 1.0 : 0.0
      },
      completion: nil
    )
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;transitionCrossDissolve optionsæšä¸¾ä¸­çš„ä¸€ä¸ª äº¤å‰è¿‡åº¦æº¶è§£&lt;/li&gt;
  &lt;li&gt;curveEaseOut optionsæšä¸¾ä¸­çš„ä¸€ä¸ª å¿«è¿›æ…¢å‡º ç±»ä¼¼åˆ¹è½¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¥ç€æˆ‘ä»¬æ¥åšç«‹ä½“è½¬åœºçš„æ•ˆæœ, ä½†è¿™ä¸ªå¹¶ä¸æ˜¯çœŸæ­£çš„ç«‹ä½“æ•ˆæœ, è€Œæ˜¯é€šè¿‡ä¸¤ä¸ªViewçš„åŠ¨ç”»è¿›è¡Œæ¨¡æ‹Ÿ&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  func cubeTransition(label: UILabel, text: String, direction: AnimationDirection) {

    let auxLabel = UILabel(frame: label.frame) //æ–°å»ºä¸€ä¸ªä¸´æ—¶Label
    auxLabel.text = text
    auxLabel.font = label.font
    auxLabel.textAlignment = label.textAlignment
    auxLabel.textColor = label.textColor
    auxLabel.backgroundColor = label.backgroundColor

    let auxLabelOffset = CGFloat(direction.rawValue) * //è®¾ç½®åç§»
      label.frame.size.height/2.0

    auxLabel.transform = CGAffineTransform(scaleX: 1.0, y: 0.1).concatenating( //è¿™é‡Œçš„concatenating ç±»ä¼¼äºRxSwiftçš„concat, å‘åå åŠ .
      CGAffineTransform(translationX: 0.0, y: auxLabelOffset))

    label.superview!.addSubview(auxLabel) //æ·»åŠ Viewä¿æŒå’ŒLabelå¹³çº§

    UIView.animate(withDuration: 0.5, delay: 0.0, options: .curveEaseOut,
      animations: {
        auxLabel.transform = .identity //è¿˜åŸä»¿å°„
        label.transform =
          CGAffineTransform(scaleX: 1.0, y: 0.1).concatenating( //è¿›è¡Œä»¿å°„ç¼©æ”¾åŠ¨ç”»
          CGAffineTransform(translationX: 0.0, y: -auxLabelOffset)) //è¿›è¡Œä½ç§»ç¼©æ”¾åŠ¨ç”»
      },
      completion: {_ in
        label.text = auxLabel.text
        label.transform = .identity //è¿˜åŸä»¿å°„

        auxLabel.removeFromSuperview() //å®Œæˆååˆ é™¤ä¸´æ—¶Label
      }
    )
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;è¿›è¡Œç§»åŠ¨åŠ¨ç”»:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  func moveLabel(label: UILabel, text: String, offset: CGPoint) {
    let auxLabel = UILabel(frame: label.frame) //åŒæ ·æ–°å»ºä¸€ä¸ªä¸´æ—¶Label
    auxLabel.text = text
    auxLabel.font = label.font
    auxLabel.textAlignment = label.textAlignment
    auxLabel.textColor = label.textColor
    auxLabel.backgroundColor = UIColor.clear

    auxLabel.transform = CGAffineTransform(translationX: offset.x, y: offset.y) //ä¸´æ—¶Labelè¿›è¡Œä½ç§»
    auxLabel.alpha = 0
    view.addSubview(auxLabel)

    UIView.animate(withDuration: 0.5, delay: 0.0, options: .curveEaseIn,
      animations: {
        label.transform = CGAffineTransform(translationX: offset.x, y: offset.y)
        label.alpha = 0.0
      },
      completion: nil
    )

    UIView.animate(withDuration: 0.25, delay: 0.1, options: .curveEaseIn,
      animations: {
        auxLabel.transform = .identity
        auxLabel.alpha = 1.0
      },
      completion: {_ in
        //clean up
        auxLabel.removeFromSuperview()
        label.text = text
        label.alpha = 1.0
        label.transform = .identity
      }
    )
  }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;curveEaseIn optionsæšä¸¾ä¸­çš„ä¸€ä¸ª æ…¢è¿›å¿«å‡º ç±»ä¼¼åŠ é€Ÿåº¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç»™é£æœºæ·»åŠ ä¸Šå…³é”®å¸§åŠ¨ç”»&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;func planeDepart() {
    let originalCenter = planeImage.center //ä¿å­˜é£æœºä½ç½®

    UIView.animateKeyframes(withDuration: 1.5, delay: 0.0, //è¿›è¡Œå…³é”®å¸§åŠ¨ç”»
      animations: {
        //add keyframes
        UIView.addKeyframe(withRelativeStartTime: 0.0, relativeDuration: 0.25, //æ·»åŠ å…³é”®å¸§
          animations: {
            self.planeImage.center.x += 80.0 //è¿›è¡Œä½ç§»
            self.planeImage.center.y -= 10.0
          }
        )

        UIView.addKeyframe(withRelativeStartTime: 0.1, relativeDuration: 0.4) {
          self.planeImage.transform = CGAffineTransform(rotationAngle: -.pi / 8) //è¿›è¡Œæ—‹è½¬
        }

        UIView.addKeyframe(withRelativeStartTime: 0.25, relativeDuration: 0.25) {
          self.planeImage.center.x += 100.0
          self.planeImage.center.y -= 50.0
          self.planeImage.alpha = 0.0 //æ·¡å‡ºåŠ¨ç”»
        }

        UIView.addKeyframe(withRelativeStartTime: 0.51, relativeDuration: 0.01) {
          self.planeImage.transform = .identity //é‡ç½®ä»¿å°„åŠ¨ç”»
          self.planeImage.center = CGPoint(x: 0.0, y: originalCenter.y) //é‡ç½®ä½ç½®
        }

        UIView.addKeyframe(withRelativeStartTime: 0.55, relativeDuration: 0.45) {
          self.planeImage.alpha = 1.0 //æ·¡å…¥åŠ¨ç”»
          self.planeImage.center = originalCenter //å›åˆ°åŸç‚¹
        }

      },
      completion: nil
    )
  }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æœ€åæˆ‘ä»¬å°†æ‰€æœ‰åŠ¨ç”»æ”¾åœ¨ä¸€èµ·&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  func changeFlight(to data: FlightData, animated: Bool = false) {
    
    // populate the UI with the next flight's data
    if animated {
      planeDepart()
      summarySwitch(to: data.summary)

      fadeImageView(imageView: bgImageView,
                    toImage: UIImage(named: data.weatherImageName)!,
                    showEffects: data.showWeatherEffects)

      let direction: AnimationDirection = data.isTakingOff ?
        .positive : .negative

      cubeTransition(label: flightNr, text: data.flightNr,  direction: direction)
      cubeTransition(label: gateNr, text: data.gateNr,  direction: direction)

      let offsetDeparting = CGPoint( //è®¾å®šåç§»é‡
        x: CGFloat(direction.rawValue * 80),
        y: 0.0
      )

      moveLabel(label: departingFrom, text: data.departingFrom,
                offset: offsetDeparting)

      let offsetArriving = CGPoint( /è®¾å®šåç§»é‡
        x: 0.0,
        y: CGFloat(direction.rawValue * 50)
      )

      moveLabel(label: arrivingTo, text: data.arrivingTo,
                offset: offsetArriving)

      cubeTransition(label: flightStatus, text: data.flightStatus,  direction: direction)

    } else {
      bgImageView.image = UIImage(named: data.weatherImageName)
      snowView.isHidden = !data.showWeatherEffects
      flightNr.text = data.flightNr
      gateNr.text = data.gateNr
      departingFrom.text = data.departingFrom
      arrivingTo.text = data.arrivingTo

      flightStatus.text = data.flightStatus
      summary.text = data.summary
    }
    
    // schedule next flight
    delay(seconds: 3.0) { //3ç§’åè¿›è¡Œé€’å½’è°ƒç”¨.
      self.changeFlight(to: data.isTakingOff ? parisToRome : londonToParis, animated: true)
    }
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-6c5bcf96d89c86d8.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 26 Apr 2017 11:58:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/Animations-%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E7%94%A8View%E7%9A%84%E5%8A%A8%E7%94%BB%E5%90%97/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/Animations-%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BC%9A%E7%94%A8View%E7%9A%84%E5%8A%A8%E7%94%BB%E5%90%97/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>RxSwift å‡½æ•°å¼ç»„åˆè¿ç®—ç¬¦å®æ“</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;ä¸Šå‘¨æˆ‘ä»¬å¼€å¯äº†RxSwiftçš„å­¦ä¹ ä¹‹æ—…, ä»å¯è§‚å¯Ÿåºåˆ—â€“&amp;gt;è¿‡æ»¤è¿ç®—ç¬¦â€“&amp;gt;æ˜ å°„è¿ç®—ç¬¦, æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è¯´è¯´ç»„åˆè¿ç®—ç¬¦. è¯´å®è¯, å¯¹äºä¹‹å‰çš„å†…å®¹çš„å­¦ä¹ , æˆ‘è§‰å¾—è¿˜æ˜¯æ¯”è¾ƒé€šä¿—æ˜“æ‡‚çš„, ä½†æ˜¯è¿™æ¬¡çš„ç»„åˆè¿ç®—ç¬¦ç›¸æ¯”ä¹‹å‰åœ¨ç†è§£éš¾æ˜“ç¨‹åº¦ä¸Šåˆä¸Šäº†ä¸ªæ¡£æ¬¡, æœ¬èŠ‚æˆ‘ä»¬å°±æ¥æ”»å…‹è¿™ä¸€æŒ‘æˆ˜å§! ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-a67b7f2ab21d4b23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ¬èŠ‚æ‰€éœ€çš„ä¸€äº›å…³äºç»„åˆçš„åŸºæœ¬çŸ¥è¯†å·²ç»æ›´æ–°åˆ°&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;ä»£ç ä¸­çš„playgroundæ–‡ä»¶ä¸­, æ²¡æœ‰æ¥è§¦è¿‡å“åº”å¼ç¼–ç¨‹çš„åŒå­¦è¯·å’Œä¹‹å‰ä¸€æ ·å…ˆè¡Œåœ¨&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift/blob/master/Our%20Planet/Our%20Planet.playground/Contents.swift&quot;&gt;playground&lt;/a&gt;ä¸­äº†è§£æ¦‚è¦ä»¥ä¾¿æ›´å¥½çš„ç†è§£æœ¬æ–‡. æœ¬èŠ‚æˆ‘ä»¬å°±é€šè¿‡æ¡ˆä¾‹é€æ­¥ç²¾è®²ç»„åˆæ“ä½œç¬¦åœ¨å®é™…å¼€å‘æ—¶çš„ä½œç”¨.&lt;/p&gt;

&lt;p&gt;è¿™æ¬¡çš„UIå±‚é¢ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤æ‚, ä¸€ä¸ªTableViewçš„åˆ—è¡¨é¡µå’Œä¸€ä¸ªæœ‰Slideræ§åˆ¶çš„TableViewåˆ—è¡¨é¡µ: 
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-821df01cb8ecc097.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ¬ç« æ˜¯å¯¹äº&lt;a href=&quot;http://www.jianshu.com/p/6b80a0db56bd&quot;&gt;RxSwift å“åº”å¼ç¼–ç¨‹å®æˆ˜ æ˜ å°„è¿ç®—ç¬¦&lt;/a&gt;è¿›è¡Œå‡çº§çš„ä¸€èŠ‚, æ‰€ä»¥æˆ‘ä»¬æ¥ç€ç½‘ç»œè¯·æ±‚è¿™å—è®²èµ·, æˆ‘ä»¬å…ˆå°†æ¨¡å‹ç±»(&lt;code class=&quot;highlighter-rouge&quot;&gt;EOCategory&lt;/code&gt; ` EOError&lt;code class=&quot;highlighter-rouge&quot;&gt; &lt;/code&gt; EOLocation&lt;code class=&quot;highlighter-rouge&quot;&gt; &lt;/code&gt; EOEvent`)æ·»åŠ åˆ°å·¥ç¨‹ä¸­.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    fileprivate static let API = &quot;https://eonet.sci.gsfc.nasa.gov/api/v2.1&quot;
    static let categoriesEndpoint = &quot;/categories&quot;
    fileprivate static let eventsEndpoint = &quot;/events&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   fileprivate static func request(endpoint: String, query: [String : Any] = [:]) -&amp;gt; Observable&amp;lt;[String : Any]&amp;gt; {
    
        do {
            guard let url = URL(string: API)?.appendingPathComponent(endpoint), var components = URLComponents(url: url, resolvingAgainstBaseURL: true) else {
                throw EOError.invalidURL(endpoint)
            }
            
            components.queryItems = try query.flatMap { (key, value) in
                guard let v = value as? CustomStringConvertible else {
                    throw EOError.invalidParameter(key, value)
                }
                return URLQueryItem(name: key , value: v.description)
            }
            
            guard let finalURL = components.url else {
                throw EOError.invalidURL(endpoint)
            }
            
            let request = URLRequest(url: finalURL)
            return URLSession.shared.rx.response(request: request).map { _, data -&amp;gt; [String : Any] in
                guard let jsonObject = try? JSONSerialization.jsonObject(with: data, options: []), let result = jsonObject as? [String : Any] else {
                    throw EOError.invalidJSON(finalURL.absoluteString)
                }
                return result
            }
        } catch {
            return Observable.empty()
        }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬ä»è¯·æ±‚çš„å‡½æ•°å¼€å§‹è®²èµ·, å’Œä¹‹å‰ä¸åŒçš„æ˜¯, è¿™æ¬¡æˆ‘ä»¬å°†è¯·æ±‚ç›´æ¥å°è£…åœ¨æ¨¡å‹é‡Œ, ä¼ ç»Ÿçš„MVCæ¨¡å¼.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;é€šè¿‡å¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;API&lt;/code&gt;æ¥å£è¿›è¡Œæ ¡éªŒå¾—åˆ°å¯ç”¨çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;URLComponents&lt;/code&gt;, å¦‚æœurlä¸å¯ç”¨æŠ›å‡ºå¼‚å¸¸.&lt;/li&gt;
  &lt;li&gt;å°†å‚æ•°èµ‹å€¼ç»™&lt;code class=&quot;highlighter-rouge&quot;&gt;URLQueryItem&lt;/code&gt;, å¦‚æœ&lt;code class=&quot;highlighter-rouge&quot;&gt;value&lt;/code&gt;ä¸ç¬¦åˆè§„åˆ™æŠ›å‡ºå¼‚å¸¸.&lt;/li&gt;
  &lt;li&gt;æ‹¿åˆ°æœ€ç»ˆçš„&lt;code class=&quot;highlighter-rouge&quot;&gt;URL&lt;/code&gt;, å¦‚æœæ‹¿ä¸åˆ°æŠ›å‡ºå¼‚å¸¸.&lt;/li&gt;
  &lt;li&gt;å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;URL&lt;/code&gt;è½¬æ¢æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;URLRequest&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;è¿›è¡ŒJSONåºåˆ—åŒ–, è¿”å›&lt;code class=&quot;highlighter-rouge&quot;&gt;(HTTPURLResponse, Data)&lt;/code&gt;ä¸­çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;Data&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;å¦‚æœæŠ›å‡ºå¼‚å¸¸åˆ™è¿”å›ç©ºçš„å¯è§‚å¯Ÿåºåˆ—.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    static var categories: Observable&amp;lt;[EOCategory]&amp;gt; = {
        return EONET.request(endpoint: categoriesEndpoint)
            .map { data in
                let categories = data[&quot;categories&quot;] as? [[String: Any]] ?? []
                return categories
                    .flatMap(EOCategory.init)
                    .sorted { $0.name &amp;lt; $1.name }
            }
            .shareReplay(1)
    }()

    ...

    fileprivate static func events(forLast days: Int, closed: Bool, endpoint: String) -&amp;gt; Observable&amp;lt;[EOEvent]&amp;gt; {
        
        return request(endpoint: eventsEndpoint, query: [
            &quot;days&quot;: NSNumber(value: days),
            &quot;status&quot;: (closed ? &quot;closed&quot; : &quot;open&quot;)
        ]).map { json in
            guard let raw = json[&quot;events&quot;] as? [[String : Any]] else {
                throw EOError.invalidJSON(endpoint)
            }
            return raw.flatMap(EOEvent.init)
        }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¥ç€æˆ‘ä»¬å¯¹categoriesçš„å¤–éƒ¨å˜é‡è¿›è¡Œè®¡ç®—å±æ€§çš„getæ–¹æ³•.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;è¿›è¡Œè¯·æ±‚è°ƒç”¨ä¸Šé¢çš„è¯·æ±‚å¹¶ä¼ å…¥å°¾éƒ¨èŠ‚ç‚¹.&lt;/li&gt;
  &lt;li&gt;è¿›è¡Œæ’åºå¹¶&lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;æ˜ å°„åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;EOCategory &lt;/code&gt;æ¨¡å‹ä¸Š.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;shareReplay(1)&lt;/code&gt;å°†è¯·æ±‚è¿›è¡Œä¸€æ¬¡ç¼“å­˜, ä¸‹æ¬¡è°ƒç”¨è®¢é˜…ä¸å†è¿›è¡Œè¯·æ±‚.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;events&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;categories&lt;/code&gt;ç›¸åŒ, è¿›è¡Œè¯·æ±‚æ˜ å°„.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;static func events(forLast days: Int = 360) -&amp;gt; Observable&amp;lt;[EOEvent]&amp;gt; {
  let openEvents = events(forLast: days, closed: false)
  let closedEvents = events(forLast: days, closed: true)
  return openEvents.concat(closedEvents)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;closedEvents &lt;/code&gt;è¿›è¡Œè¯·æ±‚æ˜ å°„åçš„æ¨¡å‹æ•°ç»„æ·»åŠ åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;openEvents&lt;/code&gt;ä¹‹å.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    static func events(forLast days: Int = 360, category: EOCategory) -&amp;gt; Observable&amp;lt;[EOEvent]&amp;gt; {

        let openEvents = events(forLast: days, closed: false, endpoint: category.endpoint)
        let closedEvents = events(forLast: days, closed: true, endpoint: category.endpoint)
        
        return Observable.of(openEvents, closedEvents).merge().reduce([]) { running, new in
            running + new
        }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;è¿›è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;marge&lt;/code&gt;, ç”¨å·¥&lt;code class=&quot;highlighter-rouge&quot;&gt;git&lt;/code&gt;çš„åŒå­¦ä¸€å®šçŸ¥é“, å…¶æ•ˆæœå’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;concat&lt;/code&gt;ç±»ä¼¼.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;func startDownload() {
        
        download.progress.progress = 0.0
        download.label.text = &quot;Download: 0%&quot;
        
        let eoCategories = EONET.categories
        let downloadedEvents = eoCategories.flatMap { categories in
            return Observable.from(categories.map { category in
                EONET.events(forLast: 360, category: category)
            })
            }.merge(maxConcurrent: 2)
        let updatedCategories = eoCategories.flatMap { categories in
            downloadedEvents.scan(categories) { updated, events in
                return updated.map { category in
                    let eventsForCategory = EONET.filteredEvents(events: events, forCategory: category)
                    if !eventsForCategory.isEmpty {
                        var cat = category
                        cat.events = cat.events + eventsForCategory
                        return cat
                    }
                    return category
                }
            }
        }
        eoCategories.concat(updatedCategories).bind(to: categories).addDisposableTo(disposeBag)
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;è¿™æ®µæ˜¯æˆ‘ä»¬æœ¬èŠ‚çš„é‡å¤´æˆ, æˆ‘ä»¬é€ä¸€æ¥è®²è§£ä¸‹:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;eoCategories &lt;/code&gt;é¦–å…ˆæˆ‘ä»¬æ‹¿åˆ°è¯·æ±‚åˆ°çš„æ•°æ®&lt;code class=&quot;highlighter-rouge&quot;&gt;EONET.categories&lt;/code&gt; å±æ€§è§‚å¯Ÿgetè¿›è¡Œè¯·æ±‚, è¿™ä¸ªä¹‹å‰è¯´è¿‡äº†.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;downloadedEvents &lt;/code&gt;é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;flatMap &lt;/code&gt;æ˜ å°„è½¬æ¢æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;merge&lt;/code&gt;åˆå¹¶åçš„æ¯ä¸ªç›¸å¯¹åº”çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;EOEvent&lt;/code&gt;æ¨¡å‹æ•°ç»„, å¹¶å‘æ•°è®¾ä¸º2.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;updatedCategories&lt;/code&gt;é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;flatMap&lt;/code&gt;æ˜ å°„è¿›è¡Œå¯¹åˆå¹¶å®Œçš„&lt;code class=&quot;highlighter-rouge&quot;&gt;downloadedEvents&lt;/code&gt;æ¨¡å‹æ•°ç»„è¿›è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;scan&lt;/code&gt;æ‰«æ, å¹¶é‡æ–°ç»„åˆæ–°çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;category&lt;/code&gt;å†…çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;events&lt;/code&gt;æ¨¡å‹æ•°ç»„.&lt;/li&gt;
  &lt;li&gt;æœ€åå°†æ›´æ–°åçš„æ•°æ®&lt;code class=&quot;highlighter-rouge&quot;&gt;concat&lt;/code&gt;æ·»åŠ å¹¶&lt;code class=&quot;highlighter-rouge&quot;&gt;bind&lt;/code&gt;ç»‘å®šåœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;categories&lt;/code&gt;å˜é‡ä¸Šå°±å¤§åŠŸå‘Šæˆäº†.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&amp;gt; UITableViewCell {
        
        let cell = tableView.dequeueReusableCell(withIdentifier: &quot;categoryCell&quot;)!

        let category = categories.value[indexPath.row]
        cell.textLabel?.text = &quot;\(category.name) (\(category.events.count))&quot;
        cell.accessoryType = (category.events.count &amp;gt; 0) ? .disclosureIndicator : .none
        return cell
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;categorieså³ä¸ºä¸Šé¢è¯·æ±‚æ˜ å°„è¿‡æ»¤ç»„åˆåç»‘å®šçš„å˜é‡, é€šè¿‡å¯¹Cellçš„è‡ªå®šä¹‰ å°±èƒ½å¤Ÿå¾—åˆ°ä¸‹é¢è¯·æ±‚çš„åˆ—è¡¨äº†.
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-de67226ed07f5b2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å®Œæˆäº†ç¬¬ä¸€ä¸ªé¡µé¢, æˆ‘ä»¬å¼€å§‹ç€ä¸‹ä¸€ä¸ªé¡µé¢: EventsViewController&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        tableView.rowHeight = UITableViewAutomaticDimension
        tableView.estimatedRowHeight = 60
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;è¿›è¡ŒAutolayoutçº¦æŸå, æˆ‘ä»¬å¯ä»¥åœ¨æ·»åŠ ä»¥ä¸‹ä»£ç æ¥ä»£æ›¿ä¹‹å‰å¤æ‚çš„cellé«˜åº¦çš„è¿ç®—.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        events.asObservable().subscribe(onNext: { [weak self] _ in
            self?.tableView.reloadData()
        }).addDisposableTo(disposeBag)
        
        Observable.combineLatest(days.asObservable(), events.asObservable()) { (days, events) -&amp;gt; [EOEvent] in
            let maxInterval = TimeInterval(days * 24 * 3600)
            return events.filter { event in
                if let date = event.closeDate {
                    return abs(date.timeIntervalSinceNow) &amp;lt; maxInterval
                }
                return true
            }
        }.bind(to: filteredEvent).addDisposableTo(disposeBag)
    
        filteredEvent.asObservable().subscribe(onNext: { [weak self] _ in
            self?.tableView.reloadData()
        }).addDisposableTo(disposeBag)

        days.asObservable().subscribe(onNext: { [weak self] days in
            self?.daysLabel.text = &quot;Last \(days) days&quot;
        }).addDisposableTo(disposeBag)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;events&lt;/code&gt;æ˜¯ä»ä¸Šä¸ªé¡µé¢ä¼ é€’è¿‡æ¥çš„å˜é‡, ç±»å‹ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;let events = Variable&amp;lt;[EOEvent]&amp;gt;([])&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;é€šè¿‡å¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;events&lt;/code&gt;çš„ä½œä¸ºå¯è§‚å¯Ÿåºåˆ—å¹¶è¿›è¡Œè®¢é˜…, å½“å¯è§‚å¯Ÿè€…è¢«æ·»åŠ è¿›è®¢é˜…å°±è¿›è¡Œåˆ—è¡¨çš„åˆ·æ–°.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Observable.combineLatest()&lt;/code&gt;å¯¹æ—¥æœŸå’Œæ—¶é—´åšæœ€åçš„ç»‘å®š, åªä¿ç•™å¯è§‚å¯Ÿåºåˆ—çš„æœ€åçš„å€¼çš„ç»„åˆ,å¹¶è¿›è¡Œè¿‡æ»¤ç»‘å®šåœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;filteredEvent&lt;/code&gt;å˜é‡ä¸Š, ç±»å‹æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;let filteredEvent = Variable&amp;lt;[EOEvent]&amp;gt;([])&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;æ¥ä¸‹æ¥ä¸¤è¡Œå¯¹äºå…³æ³¨æœ¬ç³»åˆ—çš„åŒå­¦åº”è¯¥ä¸ç”¨è§£é‡Š, å°±æ˜¯è¿›è¡Œè®¢é˜…å¹¶åˆ·æ–°UI.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    @IBAction func sliderAction(_ sender: AnyObject) {
        days.value = Int(slider.value)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æœ€åå¯¹slideræ·»åŠ äº‹ä»¶, å¹¶æ”¹å˜daysçš„å€¼.æ¥ä¸‹æ¥ä¼šè§¦å‘ä¸€ç³»åˆ—çš„è®¢é˜….&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        days.asObservable().subscribe(onNext: { [weak self] days in
            self?.daysLabel.text = &quot;Last \(days) days&quot;
        }).addDisposableTo(disposeBag)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;è§¦å‘ä¸Šé¢çš„è®¢é˜…å¹¶è¿›è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;UILabel&lt;/code&gt;çš„UIåˆ·æ–°&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        Observable.combineLatest(days.asObservable(), events.asObservable()) { (days, events) -&amp;gt; [EOEvent] in
            let maxInterval = TimeInterval(days * 24 * 3600)
            return events.filter { event in
                if let date = event.closeDate {
                    return abs(date.timeIntervalSinceNow) &amp;lt; maxInterval
                }
                return true
            }
        }.bind(to: filteredEvent).addDisposableTo(disposeBag)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;è§¦å‘&lt;code class=&quot;highlighter-rouge&quot;&gt;combineLatest&lt;/code&gt;æœ€æ–°ç»„åˆè¿ç®—ç¬¦, å¹¶é‡æ–°è¿›è¡Œè¿‡æ»¤ç»‘å®š.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        events.asObservable().subscribe(onNext: { [weak self] _ in
            self?.tableView.reloadData()
        }).addDisposableTo(disposeBag)

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;åœ¨å¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt;è¿‡æ»¤çš„è¿‡ç¨‹ä¸­è§¦å‘è®¢é˜…è¿›è¡Œåˆ—è¡¨åˆ·æ–°.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        filteredEvent.asObservable().subscribe(onNext: { [weak self] _ in
            self?.tableView.reloadData()
        }).addDisposableTo(disposeBag)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;åœ¨è¿‡æ»¤å®Œæˆé‡æ–°ç»‘å®šå, è§¦å‘è®¢é˜…è¿›è¡Œæœ€åçš„åˆ·æ–°.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ¬æ–‡å› ä¸ºç¯‡å¹…æ‰€é™, ä»…ä¿ç•™ä¸€äº›æ ¸å¿ƒçš„ä»£ç , å¹¶å¯¹æ ¸å¿ƒä»£ç è¿›è¡Œé€æ¡è®²è§£, éœ€è¦è¯¦ç»†äº†è§£, è¯·å»githubä¸‹è½½æºç åå¯¹ç…§é˜…è¯». é€šè¿‡å¯¹äºå¯è§‚å¯Ÿåºåˆ—, è¿‡æ»¤, æ˜ å°„, ç»„åˆçš„ç†è§£å’Œå®æˆ˜, é€šè¿‡ä¸€ä¸ªäº‹ä»¶çš„æ”¹å˜å¼‚æ­¥è§¦å‘è®¢é˜…çš„å“åº”å¼ç¼–ç¨‹çš„æ€æƒ³, æˆ‘ä»¬åº”è¯¥å·²ç»èƒ½ç®—å…¥é—¨äº†.&lt;/p&gt;

&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-c95ba5ed107bd458.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 24 Apr 2017 14:51:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/RxSwift-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BB%84%E5%90%88%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E6%93%8D/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/RxSwift-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BB%84%E5%90%88%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E6%93%8D/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>RxSwift å‡½æ•°å¼æ˜ å°„è¿ç®—ç¬¦å®æ“</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;ä¸€è·¯èµ°æ¥, æ„Ÿè§‰RxSwiftä¹Ÿä¸åƒä¹‹å‰ä¸€æ ·æ™¦æ¶©éš¾æ‡‚äº†, ç”šè‡³æ¸æ¸çš„å–œæ¬¢ä¸Šäº†è¿™ç§å“åº”å¼ç¼–ç¨‹çš„æ€æƒ³, å°†å¯¹è±¡ä½œä¸ºå¯è§‚å¯Ÿå¯¹è±¡å¹¶è¿›è¡Œè®¢é˜…, åŠ ä¸Šè¿‡æ»¤æ“ä½œç¬¦çš„åä½œ, ä¸€åˆ‡çš„é€»è¾‘è¿ç®—éƒ½åœ¨åå°çº¿ç¨‹æ‰§è¡Œ, æœ¬èŠ‚æ‰€è¦è®²çš„æ˜¯Rxä¸­æœ€ä¸ºå¼ºå¤§çš„åŠŸèƒ½ â€” æ˜ å°„, ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-a67b7f2ab21d4b23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ¬èŠ‚æ‰€éœ€çš„ä¸€äº›å…³äºæ˜ å°„çš„åŸºæœ¬çŸ¥è¯†å·²ç»æ›´æ–°åˆ°&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;ä»£ç ä¸­çš„playgroundæ–‡ä»¶ä¸­, æ²¡æœ‰æ¥è§¦è¿‡å“åº”å¼ç¼–ç¨‹çš„åŒå­¦è¯·å’Œä¹‹å‰ä¸€æ ·å…ˆè¡Œåœ¨&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift/blob/master/GitHubRepo/GitHubRepository/GitHubRepository.playground/Contents.swift&quot;&gt;playground&lt;/a&gt;ä¸­äº†è§£æ¦‚è¦ä»¥ä¾¿æ›´å¥½çš„ç†è§£æœ¬æ–‡. æœ¬èŠ‚æˆ‘ä»¬å°±é€šè¿‡æ¡ˆä¾‹é€æ­¥ç²¾è®²æ˜ å°„æ“ä½œç¬¦åœ¨ç½‘ç»œè¯·æ±‚æ—¶çš„å¦™ç”¨.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-81e919722e1627dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ¬¡çš„UIç•Œé¢éå¸¸çš„ç®€å•,  å°±æ˜¯ä¸€ä¸ªç®€å•çš„TableViewController, æˆ‘ä»¬é€šè¿‡ç½‘ç»œè¯·æ±‚å°†è·å–çš„JSONæ•°æ®æ˜ å°„åˆ°Modelä¸Šå¹¶å±•ç¤ºåœ¨Cellä¸Š, API: https://api.github.com/repos/coderZsq/coderZsq.target.swift/events&lt;/p&gt;

&lt;p&gt;æƒ³äº†è§£å¦‚ä½•è¿›è¡Œåå°æ­å»ºå¹¶æ¨¡æ‹Ÿæ•°æ®è¿”å›çš„åŒå­¦ è¯·ç‚¹å‡» â€“&amp;gt; &lt;a href=&quot;http://www.jianshu.com/p/5a03995a6ce1&quot;&gt;Hybird å®ç°çƒ­ä¿®å¤æ¶æ„ ä»MVCè¯´èµ·&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;5715074941&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PushEvent&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;actor&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;19483268&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;login&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;coderZsq&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;display_login&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;coderZsq&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;gravatar_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;url&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://api.github.com/users/coderZsq&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;avatar_url&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://avatars.githubusercontent.com/u/19483268?&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;repo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;87806175&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;coderZsq/coderZsq.target.swift&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;url&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://api.github.com/repos/coderZsq/coderZsq.target.swift&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;payload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;push_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1688506435&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;size&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;distinct_size&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ref&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;refs/heads/master&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;head&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;90306f546ee0e17d94891415a2f8938d28736dc7&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;before&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;778ac2b60b85a3e97e0a1e85e16cdb1061445181&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;commits&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;sha&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;90306f546ee0e17d94891415a2f8938d28736dc7&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;email&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;a13701777868@yahoo.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Castie!&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Update README.md&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;distinct&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;url&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://api.github.com/repos/coderZsq/coderZsq.target.swift/commits/90306f546ee0e17d94891415a2f8938d28736dc7&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;public&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;created_at&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2017-04-19T12:12:49Z&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä»æµè§ˆå™¨çœ‹ä¸‹æ¥å£æ‰€è¿”å›çš„å­—æ®µ, å¹¶æå–æˆ‘ä»¬éœ€è¦çš„å­—æ®µç”Ÿæˆæ¨¡å‹Model, ä»¥å¤‡ä¹‹åçš„æ˜ å°„.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;typealias AnyDict = [String: Any]

class Event {

    let repo: String
    let name: String
    let imageUrl: URL
    let action: String
    
    init?(dictionary: AnyDict) {
        guard let repoDict = dictionary[&quot;repo&quot;] as? AnyDict,
            let actor = dictionary[&quot;actor&quot;] as? AnyDict,
            let repoName = repoDict[&quot;name&quot;] as? String,
            let actorName = actor[&quot;display_login&quot;] as? String,
            let actorUrlString = actor[&quot;avatar_url&quot;] as? String,
            let actorUrl  = URL(string: actorUrlString),
            let actionType = dictionary[&quot;type&quot;] as? String
            else {  return nil  }
        
        repo = repoName
        name = actorName
        imageUrl = actorUrl
        action = actionType
    }
    
    var dictionary: AnyDict {
        return [
            &quot;repo&quot; : [&quot;name&quot;: repo],
            &quot;actor&quot;: [&quot;display_login&quot;: name, &quot;avatar_url&quot;: imageUrl.absoluteString],
            &quot;type&quot; : action
        ]
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬å°†æ¨¡å‹å‘½åä¸ºEvent, æ·»åŠ äº†ä¸€ä¸ªdictionaryå˜é‡ä¾›è¿”å›åºåˆ—åŒ–å®Œæˆåçš„å­—å…¸.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    func fetchEvents(repo: String) {
        
        let response = Observable.from([repo]).map { urlString -&amp;gt; URL in
                return URL(string: &quot;https://api.github.com/repos/\(urlString)/events&quot;)!
            }.map { [weak self] url -&amp;gt; URLRequest in
                var request = URLRequest(url: url)
                if let modifiedHeader = self?.lastModified.value {
                    request.addValue(modifiedHeader as String,forHTTPHeaderField: &quot;Last-Modified&quot;)
                }
                return request
            }.flatMap { request -&amp;gt; Observable&amp;lt;(HTTPURLResponse, Data)&amp;gt; in
                return URLSession.shared.rx.response(request: request)
            }.shareReplay(1)
        
        response.filter { response, _ in
                return 200..&amp;lt;300 ~= response.statusCode
            }.map { _, data -&amp;gt; [[String: Any]] in
                guard let jsonObject = try? JSONSerialization.jsonObject(with: data, options: []),
                    let result = jsonObject as? [[String: Any]] else { return [] }
                return result
            }.filter { objects in
                return objects.count &amp;gt; 0
            }.map { objects in
                return objects.flatMap(Event.init)
            }.subscribe(onNext: { [weak self] newEvents in
                self?.processEvents(newEvents)
            }).addDisposableTo(bag)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;ä¸€åˆ‡å‡†å¤‡å°±ç»ª, æˆ‘ä»¬å°±æ¥è¯´è¯´æœ¬èŠ‚æœ€é‡è¦çš„éƒ¨åˆ†äº†, æˆ‘ä»¬é€è¡Œæ¥è¿›è¡Œè®²è§£.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;Observable.from()&lt;/code&gt;çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡, ä¼ å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;repo&lt;/code&gt;å­—æ®µ, é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;æ˜ å°„æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;URL&lt;/code&gt;è¿”å›.&lt;/li&gt;
  &lt;li&gt;é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;æ˜ å°„å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;URL&lt;/code&gt;æ˜ å°„æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;URLRequest&lt;/code&gt;, å¦‚æœæœ‰è¿›è¡Œä¿®æ”¹åˆ™å†™å…¥è¯·æ±‚å¤´.&lt;/li&gt;
  &lt;li&gt;é€šè¿‡â€™flatmapâ€™æ˜ å°„å°†å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;URLRequest&lt;/code&gt;æ˜ å°„æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;HTTPURLResponse &lt;/code&gt;, ç½‘ç»œè¯·æ±‚å°è£…åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;RxCocoa&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;URLSession.shared.rx.response(request:)&lt;/code&gt;æ–¹æ³•ä¸­, æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸‹æºç , å½“ç„¶è¿™äº›éƒ½æ˜¯åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œçš„.&lt;/li&gt;
  &lt;li&gt;æœ€åé€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;shareReplay(1)&lt;/code&gt;è¿›è¡Œè®¢é˜…å…±äº«. &lt;code class=&quot;highlighter-rouge&quot;&gt;shareReplay&lt;/code&gt;å¯ä»¥å°†ä¹‹å‰å“åº”ç»“æœåŠ å…¥ç¼“å†²åŒº. è¿™ä¹Ÿæ˜¯ä¸ä½¿ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;share()&lt;/code&gt;çš„åŸå› , é¿å…å¤šæ¬¡è¯·æ±‚.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯¹äºflatmap å’Œ map ä¹‹å‰çš„åŒºåˆ«ä¸äº†è§£çš„åŒå­¦å¯ä»¥çœ‹ä¸‹&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift/blob/master/GitHubRepo/GitHubRepository/GitHubRepository.playground/Contents.swift&quot;&gt;playground&lt;/a&gt;ä¸­çš„ä¾‹å­, æˆ–è€…ç›´æ¥æŸ¥çœ‹Swiftä¸­çš„Arrayæ–‡æ¡£.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    /// Returns an array containing the non-`nil` results of calling the given
    /// transformation with each element of this sequence.
    ///
    /// Use this method to receive an array of nonoptional values when your
    /// transformation produces an optional value.
    ///
    /// In this example, note the difference in the result of using `map` and
    /// `flatMap` with a transformation that returns an optional `Int` value.
    ///
    ///     let possibleNumbers = [&quot;1&quot;, &quot;2&quot;, &quot;three&quot;, &quot;///4///&quot;, &quot;5&quot;]
    /// 
    ///     let mapped: [Int?] = numbers.map { str in Int(str) }
    ///     // [1, 2, nil, nil, 5]
    /// 
    ///     let flatMapped: [Int] = numbers.flatMap { str in Int(str) }
    ///     // [1, 2, 5]
    ///
    /// - Parameter transform: A closure that accepts an element of this
    ///   sequence as its argument and returns an optional value.
    /// - Returns: An array of the non-`nil` results of calling `transform`
    ///   with each element of the sequence.
    ///
    /// - Complexity: O(*m* + *n*), where *m* is the length of this sequence
    ///   and *n* is the length of the result.
    public func flatMap&amp;lt;ElementOfResult&amp;gt;(_ transform: (Element) throws -&amp;gt; ElementOfResult?) rethrows -&amp;gt; [ElementOfResult]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ‹¿åˆ°äº†å“åº”ç»“æœ, æˆ‘ä»¬å¯¹ç›¸åº”ç»“æœè¿›è¡Œè¿‡æ»¤, å¦‚æœå¯¹è¿‡æ»¤ä¸äº†è§£çš„åŒå­¦, è¯·ç¿»çœ‹ä¹‹å‰çš„æ–‡ç«  â€“&amp;gt; &lt;a href=&quot;http://www.jianshu.com/p/04349d324a6f&quot;&gt;RxSwift å“åº”å¼ç¼–ç¨‹å®æˆ˜ è¿‡æ»¤è¿ç®—ç¬¦&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;filter &lt;/code&gt;è¿‡æ»¤æ‰é”™è¯¯çš„statusCode, å¯¹äºstatusCodeä¸äº†è§£çš„åŒå­¦å¯ä»¥æŸ¥é˜…HTTPçŠ¶æ€ç çš„èµ„æ–™, &lt;code class=&quot;highlighter-rouge&quot;&gt;~=&lt;/code&gt;æ“ä½œç¬¦æ˜¯æŒ‡æ“ä½œç¬¦å³è¾¹çš„å€¼æ˜¯å¦åœ¨æ“ä½œç¬¦å·¦è¾¹çš„èŒƒå›´ä¹‹å†…, è¿”å›Boolç±»å‹,&lt;/li&gt;
  &lt;li&gt;å¾—åˆ°æ­£ç¡®çš„æ•°æ®å, é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;è¿›è¡Œæ˜ å°„å°†æ•°æ®æ˜ å°„æˆå­—å…¸æ•°ç»„ç±»å‹, ä½¿ç”¨çš„æ˜¯ç³»ç»Ÿçš„JSONåºåˆ—åŒ–.&lt;/li&gt;
  &lt;li&gt;å†æ¬¡è¿›è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;filter&lt;/code&gt;è¿‡æ»¤, è¿‡æ»¤æ‰æ²¡æœ‰è¿”å›çš„æ•°æ®.&lt;/li&gt;
  &lt;li&gt;å†æ¬¡è¿›è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;æ˜ å°„, å°†æ•°æ®ç»“æ„æ˜ å°„åˆ°Eventæ¨¡å‹ä¸­.&lt;/li&gt;
  &lt;li&gt;æœ€åè¿›è¡Œè®¢é˜…æ‰§è¡Œæ“ä½œå¹¶æ·»åŠ åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;DisposeBag&lt;/code&gt;ä¸­.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¥ç€æˆ‘ä»¬æ¥çœ‹ä¸‹æ‹¿åˆ°äº†æ˜ å°„å®Œæˆåçš„[Event]æ¨¡å‹æ•°ç»„åçš„æ‰§è¡Œæ“ä½œ.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    func processEvents(_ newEvents: [Event]) {
        
        var updatedEvents = newEvents + events.value
        if updatedEvents.count &amp;gt; 50 {
            updatedEvents = Array&amp;lt;Event&amp;gt;(updatedEvents.prefix(upTo: 50))
        }
        
        events.value = updatedEvents
        tableView.reloadData()
        refreshControl?.endRefreshing()
        
        let eventsArray = updatedEvents.map{ $0.dictionary } as NSArray
        eventsArray.write(to: eventsFileURL, atomically: true)
        
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;æ‹¿åˆ°æ¨¡å‹æ•°ç»„çš„ä¸ªæ•°åå–å¦‚æœè¶…è¿‡50ä¸ª, å–å‰é¢50ä¸ªæ•°æ®.&lt;/li&gt;
  &lt;li&gt;åˆ·æ–°tableView, refreshControlç»“æŸåˆ·æ–°, å¹¶å°†æ˜ å°„æ¨¡å‹ç¼“å­˜åˆ°æ²™ç›’.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;func cachedFileURL(_ fileName: String) -&amp;gt; URL {
    return FileManager.default.urls(for: .cachesDirectory, in: .allDomainsMask).first!.appendingPathComponent(fileName)
}

class ViewController: UITableViewController {

    fileprivate let repo = &quot;coderZsq/coderZsq.target.swift&quot;
    fileprivate let events = Variable&amp;lt;[Event]&amp;gt;([])
    fileprivate let bag = DisposeBag()
    
    fileprivate let eventsFileURL = cachedFileURL(&quot;events.plist&quot;)
    fileprivate let modifiedFileURL = cachedFileURL(&quot;modified.txt&quot;)
    fileprivate let lastModified = Variable&amp;lt;NSString?&amp;gt;(nil)
    
    override func viewDidLoad() {
        super.viewDidLoad()
        title = repo
        
        let eventsArray = (NSArray(contentsOf: eventsFileURL)
            as? [[String: Any]]) ?? []
        events.value = eventsArray.flatMap(Event.init)
        lastModified.value = try? NSString(contentsOf: modifiedFileURL, usedEncoding: nil)
        
        setupRefreshControl()
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cachedFileURL&lt;/code&gt;ç¼“å­˜è·¯å¾„åœ°å€&lt;/li&gt;
  &lt;li&gt;æ¯æ¬¡å…ˆæ‰§è¡Œç¼“å­˜æœ¬åœ°çš„æ˜ å°„æ•°æ®å†è¿›è¡Œç½‘ç»œè¯·æ±‚.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ˜ å°„å’Œè¿‡æ»¤çš„å¥½å¤„åœ¨äºä¸€åˆ‡éƒ½åœ¨åå°çº¿ç¨‹è¿›è¡Œ, å¹¶åœ¨æ˜ å°„å’Œè¿‡æ»¤çš„è¿‡ç¨‹ä¸­å¦‚æœå‘ç”Ÿä¸åŒ¹é…çš„æƒ…å†µ, ä¹‹åçš„æ“ä½œå°±ä¼šè¢«æ‰“æ–­, ä¸å†æ‰§è¡Œ.&lt;/p&gt;

&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-86d2e2011251ccd6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 20 Apr 2017 10:45:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/RxSwift-%E5%87%BD%E6%95%B0%E5%BC%8F%E6%98%A0%E5%B0%84%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E6%93%8D/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/RxSwift-%E5%87%BD%E6%95%B0%E5%BC%8F%E6%98%A0%E5%B0%84%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E6%93%8D/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>RxSwift å‡½æ•°å¼è¿‡æ»¤è¿ç®—ç¬¦å®æ“</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;æ¥ç€ä¸Šä¸€éƒ¨åˆ†, æˆ‘ä»¬å·²ç»å®Œæˆäº†å‡½æ•°å¼ç¼–ç¨‹çš„ç®€å•å®è·µ, ä¹ŸåŒæ—¶æ¥è§¦äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;Photos&lt;/code&gt;æ¡†æ¶å¸¦æ¥çš„è‡ªå®šä¹‰çš„ä¾¿åˆ©, ä¸»è¦ç†Ÿæ‚‰äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;Variable&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Subject&lt;/code&gt; ä½œä¸º &lt;code class=&quot;highlighter-rouge&quot;&gt;Observable&lt;/code&gt; è¿›è¡Œè®¢é˜… &lt;code class=&quot;highlighter-rouge&quot;&gt;subscribe&lt;/code&gt; å¹¶é€šè¿‡å¤„ç½®åŒ…&lt;code class=&quot;highlighter-rouge&quot;&gt;DisposeBag&lt;/code&gt; å¤„ç†çš„å…·ä½“æ¡ˆä¾‹, è¿™ä¸€èŠ‚æˆ‘ä»¬æ¥è¿›ä¸€æ­¥å®Œå–„ç›¸ç‰‡æ‹¼å›¾. ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-a67b7f2ab21d4b23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ¬èŠ‚æ‰€éœ€çš„ä¸€äº›å…³äºè®¢é˜…ä¿¡æ¯è¿‡æ»¤çš„åŸºæœ¬çŸ¥è¯†å·²ç»æ›´æ–°åˆ°&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;ä»£ç ä¸­çš„playgroundæ–‡ä»¶ä¸­, æ²¡æœ‰æ¥è§¦è¿‡å“åº”å¼ç¼–ç¨‹çš„åŒå­¦è¯·å’Œä¹‹å‰ä¸€æ ·å…ˆè¡Œåœ¨&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift/blob/master/AlbumPuzzle/AlbumPuzzle.playground/Contents.swift&quot;&gt;playground&lt;/a&gt;ä¸­äº†è§£æ¦‚è¦ä»¥ä¾¿æ›´å¥½çš„ç†è§£æœ¬æ–‡. åœ¨è¿›è¡Œå¯¹é¡¹ç›®çš„å®Œå–„ä¹‹å‰æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªé—®é¢˜:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;example(of: &quot;Sharing subscription&quot;) {
    
    var start = 0
    func getStartNumber() -&amp;gt; Int {
        start += 1
        return start
    }
    
    let numbers = Observable&amp;lt;Int&amp;gt;.create { observer in
        
        let start = getStartNumber()
        observer.onNext(start)
        observer.onNext(start+1)
        observer.onNext(start+2)
        observer.onCompleted()
        return Disposables.create()
    }
    
    numbers.subscribe(
        onNext: { el in
            print(&quot;element [\(el)]&quot;)
        },
        onCompleted: {
            print(&quot;---------------&quot;)
        }
    )
    
    numbers.subscribe(
        onNext: { el in
            print(&quot;element [\(el)]&quot;)
        },
        onCompleted: {
            print(&quot;---------------&quot;)
        }
    )
}

---Example of: Sharing subscription ---
element [1]
element [2]
element [3]
---------------
element [2]
element [3]
element [4]
---------------

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;åŒæ ·æ˜¯å¯¹äºå¯è§‚å¯Ÿå¯¹è±¡è¿›è¡Œè®¢é˜…ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸¤ç§ä¸åŒçš„ç»“æœ? é—®é¢˜æ˜¯ï¼Œæ¯æ¬¡è°ƒç”¨subscribeï¼ˆâ€¦ï¼‰æ—¶ï¼Œéƒ½ä¼šä¸ºè¯¥è®¢é˜…åˆ›å»ºä¸€ä¸ªæ–°çš„Observableï¼Œå¹¶ä¸”æ¯ä¸ªå‰¯æœ¬ä¸èƒ½ä¿è¯ä¸ä¹‹å‰çš„ç›¸åŒã€‚ å³ä½¿Observableç¡®å®äº§ç”Ÿäº†ç›¸åŒçš„å…ƒç´ åºåˆ—ï¼Œä¸ºæ¯ä¸ªè®¢é˜…ç”Ÿæˆç›¸åŒçš„é‡å¤å…ƒç´ ä¹Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;example(of: &quot;Sharing subscription Fix&quot;) {
        
    var start = 0
    func getStartNumber() -&amp;gt; Int {
        start += 1
        return start
    }
    
    let numbers = Observable&amp;lt;Int&amp;gt;.create { observer in
        
        let start = getStartNumber()
        observer.onNext(start)
        observer.onNext(start+1)
        observer.onNext(start+2)
        observer.onCompleted()
        return Disposables.create()
    }
    
    let shareNumbers = numbers.share()
    
    shareNumbers.subscribe(
        onNext: { el in
            print(&quot;element [\(el)]&quot;)
        },
        onCompleted: {
            print(&quot;---------------&quot;)
        }
    )
    
    shareNumbers.subscribe(
        onNext: { el in
            print(&quot;element [\(el)]&quot;)
        },
        onCompleted: {
            print(&quot;---------------&quot;)
        }
    )
}

---Example of: Sharing subscription Fix ---
element [1]
element [2]
element [3]
---------------
---------------
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å¦‚æœéœ€è¦è¿›è¡Œå…±äº«è®¢é˜…ï¼Œå¯ä»¥ä½¿ç”¨shareï¼ˆï¼‰è¿ç®—ç¬¦ã€‚ Rxä»£ç ä¸­çš„å¸¸è§æ¨¡å¼æ˜¯é€šè¿‡è¿‡æ»¤æ¯ä¸ªç»“æœä¸­çš„ä¸åŒå…ƒç´ æ¥ä»åŒä¸€ä¸ªæºä¸­åˆ›å»ºå‡ ä¸ªåºåˆ—ã€‚&lt;/p&gt;

&lt;p&gt;å›åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­æ¥çœ‹å¦‚ä½•å°†share()è¿ç®—ç¬¦è¿ç”¨çš„å®é™…, å°†ViewControllerä¸­çš„ä»£ç ä¿®æ”¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class ViewController: UIViewController {
    ...
    fileprivate var imageCache = [Int]() //update
    ...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    //update
    fileprivate func updateNavigationIcon() {
        let icon = imagePreview.image?.scaled(CGSize(width: 22, height: 22)).withRenderingMode(.alwaysOriginal)
        navigationItem.leftBarButtonItem = UIBarButtonItem(image: icon, style: .done, target: nil, action: nil)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    @IBAction func actionAdd() {
//        images.value.append(UIImage(named: &quot;Castie!&quot;)!)
        
        let albumViewController = storyboard?.instantiateViewController(withIdentifier: &quot;AlbumViewController&quot;) as! AlbumViewController
        
        //update
        let newImages = albumViewController.selectedImages.share()

        newImages.takeWhile { [weak self] image in
                return (self?.images.value.count ?? 0) &amp;lt; 6
            }.filter { newImage in
                return newImage.size.width &amp;gt; newImage.size.height
            }.filter { [weak self] newImage in
                let len = UIImagePNGRepresentation(newImage)?.count ?? 0
                guard self?.imageCache.contains(len) == false else { return false }
                self?.imageCache.append(len)
                return true
            }.subscribe(
                
            onNext: { [weak self] newImage in
                guard let images = self?.images else { return }
                images.value.append(newImage)
            },
            onDisposed: {
                print(&quot;completed photo selection&quot;)
            }
                
        ).addDisposableTo(albumViewController.bag)
        
        newImages.ignoreElements().subscribe(
            onCompleted: { [weak self] in
            self?.updateNavigationIcon()
        }).addDisposableTo(albumViewController.bag)
        
        navigationController?.pushViewController(albumViewController, animated: true)
    }
    
    @IBAction func actionClear() {
        images.value = []
        //update
        imageCache = []
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬æ¥å…·ä½“åˆ†æ&lt;code class=&quot;highlighter-rouge&quot;&gt;actionAdd()&lt;/code&gt; è¿™æ®µä»£ç , é¦–å…ˆ, æˆ‘ä»¬é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;share()&lt;/code&gt;æ“ä½œç¬¦å¯¹å¯è§‚å¯Ÿå¯¹è±¡è¿›è¡Œè®¢é˜…å…±äº«&lt;code class=&quot;highlighter-rouge&quot;&gt;takeWhile()&lt;/code&gt;æ“ä½œç¬¦å°†å¾—åˆ°çš„è®¢é˜…ä¿¡æ¯è¿›è¡Œè¿‡æ»¤, è¿”å›æœ€å¤§å…­å¼ å›¾ç‰‡å’Œä¹‹å‰å¯¹ç‚¹å‡»æŒ‰é’®çš„å±è”½é€»è¾‘è¿›è¡Œäº†å¯¹åº”, &lt;code class=&quot;highlighter-rouge&quot;&gt;filter()&lt;/code&gt;æ“ä½œç¬¦å°±æ˜¯ä¼ ç»Ÿçš„å‡½æ•°å¼è¿‡æ»¤, è¿”å›å›¾ç‰‡å®½åº¦å¤§äºé«˜åº¦çš„å›¾ç‰‡åŠé€šè¿‡å›¾ç‰‡å­—èŠ‚æ•°å’Œç¼“å­˜æ± ä¸­çš„å­—èŠ‚æ•°åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€å¼ å›¾ç‰‡. è¿™é‡Œæˆ‘ä»¬æ–°åŠ äº†ä¸€ä¸ªè®¢é˜… &lt;code class=&quot;highlighter-rouge&quot;&gt;ignoreElements()&lt;/code&gt; æ“ä½œç¬¦æ˜¯å¿½ç•¥æ‰€æœ‰çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;onNext()&lt;/code&gt;äº‹ä»¶, åªæ¥æ”¶&lt;code class=&quot;highlighter-rouge&quot;&gt;onCompleted ()&lt;/code&gt;äº‹ä»¶. UIå±‚é¢æˆ‘ä»¬åœ¨å·¦ä¸Šè§’æ·»åŠ äº†ä¸€ä¸ªå¯¹åº”å›¾ç‰‡çš„ç¼©ç•¥å›¾.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    //update
    override func viewWillDisappear(_ animated: Bool) {
        super.viewWillDisappear(animated)
        selectedImagesSubject.onCompleted()
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦å¯¹AlbumViewControllerç”Ÿå‘½å‘¨æœŸç»“æŸçš„æ—¶å€™å¯¹å¯è§‚å¯Ÿå¯¹è±¡è¿›è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;onCompleted()&lt;/code&gt;è°ƒç”¨, æ‰§è¡Œä¹‹å‰çš„è®¢é˜…ä»£ç ä¿®æ”¹UI.
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-718f23f9c824c8bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿è¡ŒæˆåŠŸå, æˆ‘ä»¬é¡ºåˆ©çš„çœ‹åˆ°å·¦ä¸Šè§’çš„ç¼©ç•¥å›¾æ˜¾ç¤ºäº†, å¹¶ä¸”ä¸èƒ½é‡å¤æ·»åŠ å¤§äºå…­å¼ å›¾ç‰‡åŠåªå…è®¸å®½åº¦å¤§äºé•¿åº¦çš„å›¾ç‰‡. ä½†æˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ªå°é—®é¢˜, å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è®¿é—®ç›¸å†Œçš„æ—¶å€™, ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†å¯¹ç”¨æˆ·è¡Œä¸ºè¿›è¡Œæˆæƒ, ä½†æˆæƒå®Œæˆå, å›¾ç‰‡å¹¶æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥, è¿™æ˜¯å› ä¸ºæ‡’åŠ è½½çš„æ—¶å€™åœ¨æˆæƒéªŒè¯å‰å¹¶æ²¡æœ‰æ‹¿åˆ°ä»»ä½•çš„æ•°æ®. æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è§£å†³. æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶, å¹¶å¯¹PHPhotoLibraryè¿›è¡Œç±»æ‰©å±•.&lt;/p&gt;

&lt;p&gt;PHPhotoLibraryå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªç”¨æˆ·å›¾åº“ï¼ŒåŒ…å«äº†ä¸€äº›çš„å›¾ç‰‡å’Œç›¸å†Œï¼ŒåŒæ—¶åŒ…å«æœ¬åœ°çš„å’ŒiCloudä¸­çš„èµ„æºã€‚å½“Photos appå‘ç”Ÿå›¾ç‰‡çš„ä¿®æ”¹ã€å¢åŠ ã€åˆ é™¤ç­‰æ”¹å˜æ—¶ï¼Œä½¿ç”¨PHPhotoLibraryæ¥åšä¸€äº›åˆ·æ–°UIï¼Œä¿å­˜æ•°æ®ç­‰å“åº”åŠ¨ä½œï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ³¨å†Œè§‚å¯Ÿè€…ï¼ˆä½¿ç”¨registerChangeObserveræ–¹æ³•ï¼‰ï¼Œå½“Photos appå†…å®¹å‘ç”Ÿæ”¹å˜çš„æ—¶ï¼Œä¼šè§¦å‘ä»£ç†æ–¹æ³•photoLibraryDidChangeã€‚&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;extension PHPhotoLibrary {

    static var authorized: Observable&amp;lt;Bool&amp;gt; {
        return Observable.create { observer in

            DispatchQueue.main.async {
                if authorizationStatus() == .authorized {
                    observer.onNext(true)
                    observer.onCompleted()
                } else {
                    observer.onNext(false)
                    requestAuthorization { newStatus in
                        observer.onNext(newStatus == .authorized)
                        observer.onCompleted()
                    }
                }
            }
            
            return Disposables.create()
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;è¿™é‡Œå¯¹äºåˆšå­¦ä¹ Swiftçš„åŒå­¦å¯èƒ½å¹¶ä¸æ˜¯å¾ˆå¥½ç†è§£, è¿™é‡Œæˆ‘ä»¬å¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;PHPhotoLibrary&lt;/code&gt;æ‰©å±•äº†ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;authorized&lt;/code&gt;å±æ€§, å¹¶é€šè¿‡è®¡ç®—å±æ€§è¿”å›äº†ä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡, å¯¹è§‚å¯Ÿå¯¹è±¡è¿›è¡Œæˆæƒæ ¡éªŒ, å¦‚æœæ ¡éªŒè¿‡å°±æ‰§è¡Œæ“ä½œ, æ²¡æœ‰æ ¡éªŒè¿‡å°±è¯·æ±‚æˆæƒæ ¡éªŒ, è¿™é‡Œå¼€äº†ä¸€ä¸ªGCDçš„ä¸»çº¿ç¨‹, ä½†ä¸€èˆ¬æ¥è¯´åœ¨è®¢é˜…ä¸­æ˜¯è§‚å¯Ÿå™¨ä¸åº”è¯¥é˜»æ­¢å½“å‰çº¿ç¨‹. æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨AlbumViewControllerä¸­è¿›è¡Œä½¿ç”¨.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    override func viewDidLoad() {
        super.viewDidLoad()
        self.collectionView!.register(UICollectionViewCell.self, forCellWithReuseIdentifier: reuseIdentifier)
        //update
        let authorized = PHPhotoLibrary.authorized.share()
        
        authorized.skipWhile { $0 == false }.take(1).subscribe(onNext: { [weak self] _ in
            self?.images = AlbumViewController.loadImages()
            DispatchQueue.main.async {
                self?.collectionView?.reloadData()
            }
        }).addDisposableTo(bag)
        
        authorized.skip(1).takeLast(1).filter { $0 == false }.subscribe(onNext: { [weak self] _ in
            guard let errorMessage = self?.errorMessage else { return }
                DispatchQueue.main.async(execute: errorMessage)
        }).addDisposableTo(bag)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡è®¢é˜…å…±äº«çš„å½¢å¼è¿›è¡Œ, ç¬¬ä¸€ä¸ªè®¢é˜…æˆæƒéªŒè¯å½“éªŒè¯æˆåŠŸåè¿›è¡Œè·å–ç³»ç»Ÿç›¸å†Œå›¾ç‰‡, å¹¶åœ¨ä¸»çº¿ç¨‹åˆ·æ–°UI, ç¬¬äºŒä¸ªæ˜¯å‘èµ·è¯·æ±‚éªŒè¯åä»æ²¡æœ‰éªŒè¯å, ä¸»çº¿ç¨‹æ‰§è¡Œé”™è¯¯æç¤ºå¼¹çª—. ä»£ç ä¸­çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;skipWhile()&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;take()&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;skip()&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;takeLast()&lt;/code&gt;æ“ä½œç¬¦, ä¸ç†è§£çš„åŒå­¦å¯ä»¥åˆ°é¡¹ç›®ä¸­çš„playgroundä¸­å…ˆè¡Œäº†è§£.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    fileprivate func errorMessage() {
        alert(title: &quot;No access to Camera Roll&quot;,
              text: &quot;You can grant access to Combinestagram from the Settings app&quot;)
            .take(5.0, scheduler: MainScheduler.instance)
            .subscribe(onDisposed: { [weak self] in
                self?.dismiss(animated: true, completion: nil)
                _ = self?.navigationController?.popViewController(animated: true)
        }).addDisposableTo(bag)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;errorMessage()&lt;/code&gt; ä¸­éœ€è¦è®²ä¸€ä¸‹çš„æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;.take(5.0, scheduler: MainScheduler.instance)&lt;/code&gt; ä»ç»™å®šæ—¶é—´æ®µçš„æºåºåˆ—ä¸­è·å–å…ƒç´ ã€‚ ä¸€æ—¦æ—¶é—´é—´éš”è¿‡å»ï¼Œå®Œæˆç»“æœåºåˆ—ã€‚æˆ‘ä»¬åœ¨ViewControllerä¸­ä¹Ÿæ›´æ”¹å¦‚ä¸‹:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    fileprivate func setupObservable() {
        //update
        images.asObservable().throttle(0.5, scheduler: MainScheduler.instance).subscribe(onNext: { [weak self] images in
            guard let preview = self?.imagePreview else { return }
            preview.image = UIImage.collage(images: images, size: preview.frame.size)
            }).addDisposableTo(bag)
        
        images.asObservable().subscribe(onNext: { [weak self] images in
            self?.updateUI(images: images)
        }).addDisposableTo(bag)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.throttle(0.5, scheduler: MainScheduler.instance)&lt;/code&gt;å’Œåˆšæ‰çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;take(_:scheduler:)&lt;/code&gt;éå¸¸ç›¸ä¼¼, æ˜¯åœ¨ä¸€å®šæ—¶é—´é—´éš”å†…è¿‡æ»¤æ‰ä¹‹å‰çš„å…ƒç´ åªç•™ä¸‹æœ€æ–°çš„å…ƒç´ ,&lt;/p&gt;

&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:
&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-c9e974553e6ba09b.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 19 Apr 2017 11:50:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/RxSwift-%E5%87%BD%E6%95%B0%E5%BC%8F%E8%BF%87%E6%BB%A4%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E6%93%8D/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/RxSwift-%E5%87%BD%E6%95%B0%E5%BC%8F%E8%BF%87%E6%BB%A4%E8%BF%90%E7%AE%97%E7%AC%A6%E5%AE%9E%E6%93%8D/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>RxSwift å¤§ç¥ä»¬éƒ½åœ¨çœ‹çš„å“åº”å¼</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;ä¸Šä¸ªç³»åˆ—çš„æ¶æ„è®¾è®¡, ä»MVC -&amp;gt; MVVM -&amp;gt; MVP -&amp;gt; Router -&amp;gt; Downgradable, æˆ‘ä»¬å®ç°äº†é€šè¿‡åˆ†å±‚å°†å„ä¸ªç»„ä»¶è¿›è¡Œè§£è€¦å¹¶åŠ¨æ€çš„å‡é™çº§é¡µé¢, è¿™ä¸€ç³»åˆ—å‡†å¤‡è¯´è¯´å¦‚ä½•é€šè¿‡RxSwiftè¿›è¡Œå“åº”å¼ç¼–ç¨‹æ›´å¥½çš„å’Œæ¶æ„è®¾è®¡è¿›è¡ŒååŒ. ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-a67b7f2ab21d4b23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™ç³»åˆ—æ‰€è¿°æ¡ˆä¾‹æ˜¯é€šè¿‡Rayå®¶çš„RxSwiftä¸€ä¹¦è¿›è¡Œç¬”è®°, åœ¨å­¦ä¹ æœ¬ç¯‡ä¹‹å‰, è¯·ç¡®ä¿ç†Ÿç»ƒæŒæ¡Swift3åŸºç¡€è¯­æ³•å¹¶å…·å¤‡ä¸­çº§iOSå¼€å‘èƒ½åŠ›. å¯¹äºRxSwiftçš„æ¦‚å¿µä¸æ˜¯å¾ˆæ¸…æ™°çš„åŒå­¦å¯ä»¥å‚ç…§æœ¬æ–‡ä»£ç ä¸­çš„&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift/blob/master/AlbumPuzzle/AlbumPuzzle.playground/Contents.swift&quot;&gt;playground&lt;/a&gt;äº‹å…ˆç†Ÿæ‚‰, ä¸ç†è§£çš„è¯·å…ˆæŸ¥é˜…æ¦‚è¦, ä»¥ä¾¿æ›´å¥½çš„äº†è§£æœ¬æ–‡.&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæˆ‘ä»¬éœ€è¦é€šè¿‡cocapodsè¿›è¡Œå¼•å…¥RxSwift:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Uncomment the next line to define a global platform for your project
platform :ios, '10.0'

target 'AlbumPuzzle' do
    # Comment the next line if you're not using Swift and don't want to use dynamic frameworks
    use_frameworks!
    
    # Pods for AlbumPuzzle
    pod 'RxSwift',    '~&amp;gt; 3.2'
    pod 'RxCocoa',    '~&amp;gt; 3.2'
    
end
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-46cac43c61b71c6e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›å¿…è¦çš„æ§ä»¶, é¿å…ä»£ç è¿‡å¤š, æˆ‘ä»¬å°±é€šè¿‡StoryBoardæ¥è¿›è¡ŒViewå±‚çš„å¸ƒå±€, ç¬¬ä¸€ä¸ªé¡µé¢ä¸­æˆ‘ä»¬éœ€è¦å››ä¸ªæ§ä»¶: å±•ç¤ºå›¾ç‰‡, æ·»åŠ æŒ‰é’®, æ¸…é™¤æŒ‰é’®, ä¿å­˜æŒ‰é’®. ç¬¬äºŒä¸ªé¡µé¢å°±æ˜¯ä¸ªç®€å•çš„CollectoinViewController.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class ViewController: UIViewController {
    
    @IBOutlet weak var imagePreview: UIImageView!
    @IBOutlet weak var buttonClear: UIButton!
    @IBOutlet weak var buttonSave: UIButton!
    @IBOutlet weak var itemAdd: UIBarButtonItem!
    
    fileprivate let bag = DisposeBag()
    fileprivate let images = Variable&amp;lt;[UIImage]&amp;gt;([])
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupObservable()
    }
}

extension ViewController {
    
    fileprivate func setupObservable() {
        
        images.asObservable().subscribe(onNext: { [weak self] images in
            guard let preview = self?.imagePreview else { return }
            preview.image = UIImage.collage(images: images, size: preview.frame.size)
        }).addDisposableTo(bag)
        
        images.asObservable().subscribe(onNext: { [weak self] images in
            self?.updateUI(images: images)
        }).addDisposableTo(bag)
    }
    
    fileprivate func updateUI(images: [UIImage]) {
        buttonSave.isEnabled = images.count &amp;gt; 0 &amp;amp;&amp;amp; images.count % 2 == 0
        buttonClear.isEnabled = images.count &amp;gt; 0
        itemAdd.isEnabled = images.count &amp;lt; 6
        title = images.count &amp;gt; 0 ? &quot;\(images.count) photos&quot; : &quot;Collage&quot;
    }
}


extension ViewController {
    
    @IBAction func actionAdd() {
        images.value.append(UIImage(named: &quot;Castie!&quot;)!)
    }
    
    @IBAction func actionClear() {
        images.value = []
    }
    
    @IBAction func actionSave() {
        
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬è¿›å…¥ViewController, åˆ›å»ºä¸¤ä¸ªç§æœ‰å˜é‡, bag, æ˜¯ä¸€ä¸ªDisposeBagå®ä¾‹, imagesæ˜¯ä¸€ä¸ªVariableçš„æ³›å‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;å¯¹äºDisposeBagå’ŒVariableä¸äº†è§£çš„åŒå­¦è¯·äº‹å…ˆæŸ¥é˜…playgroundä¸­çš„å†…å®¹&lt;/code&gt; , é€šè¿‡extensionçš„è¯­æ³•&lt;code class=&quot;highlighter-rouge&quot;&gt; Swiftçš„è£…é¥°æ¨¡å¼ &lt;/code&gt;è¿›è¡Œä»£ç åˆ†åŒº,  é€šè¿‡å¯¹imagesæ·»åŠ è®¢é˜…ç›‘å¬imagesæ•°ç»„å‘ç”Ÿçš„å˜åŒ–, å¹¶å¯¹æŒ‰é’®ç‚¹å‡»è¿›è¡Œæ“ä½œ. ä¸ºäº†å®ç°æ›´å¥½çš„æ•ˆæœ, éœ€è¦å¼•å…¥UIImage+Collageåˆ†ç±».&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-6a3d4c76e8003a66.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±ç®€å•çš„å®ç°äº†å“åº”å¼ç¼–ç¨‹, å½“è®¢é˜…è€…çš„å€¼è¢«æ”¹å˜çš„æ—¶å€™, å°±ä¼šæ›´æ–°æ“ä½œ. å°±å’ŒKVOçš„ç›‘å¬æ•ˆæœç›¸ä¼¼. ç”±äºiOS10å¼€å§‹å¯¹äºè®¿é—®ç”¨æˆ·ä¿¡æ¯çš„æœºåˆ¶æœ‰æ‰€æ›´æ–°, æœ¬ä¾‹ä¸­éœ€è¦è®¿é—®ç”¨æˆ·ç›¸å†Œ, æ‰€ä»¥åœ¨info.plistè¿›è¡Œå¦‚ä¸‹é…ç½®:
Privacy - Photo Library Usage Description, We need access to your deviceâ€™s photo library to allow you to select photos for your collage.&lt;/p&gt;

&lt;p&gt;è¿›è¡Œé…ç½®å®Œæˆ, æˆ‘ä»¬å°±é€šè¿‡Photosç³»ç»Ÿæ¡†æ¶æ¥è¿›è¡Œå¯¹ç³»ç»Ÿç›¸å†Œä¸­çš„å›¾ç‰‡è¿›è¡Œè·å–, å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨UIImagePickerController, é¢„çŸ¥å¦‚ä½•ä½¿ç”¨è¯·&lt;a href=&quot;http://www.jianshu.com/p/555786f35357&quot;&gt;ç‚¹å‡»&lt;/a&gt;!&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import UIKit
import Photos
import RxSwift

private let reuseIdentifier = &quot;Cell&quot;

class AlbumViewController: UICollectionViewController {
    
    let bag = DisposeBag()
    var selectedImages: Observable&amp;lt;UIImage&amp;gt; {
        return selectedImagesSubject.asObservable()
    }
    
    fileprivate let selectedImagesSubject = PublishSubject&amp;lt;UIImage&amp;gt;()
    fileprivate lazy var images = AlbumViewController.loadImages()
    fileprivate lazy var imageManager = PHCachingImageManager()
    fileprivate lazy var thumbnailSize: CGSize = {
        let cellSize = (self.collectionViewLayout as! UICollectionViewFlowLayout).itemSize
        return CGSize(width: cellSize.width * UIScreen.main.scale,
                      height: cellSize.height * UIScreen.main.scale)
    }()
    
    override func viewDidLoad() {
        super.viewDidLoad()
        self.collectionView!.register(UICollectionViewCell.self, forCellWithReuseIdentifier: reuseIdentifier)
    }
}

extension AlbumViewController {
    
    static func loadImages() -&amp;gt; PHFetchResult&amp;lt;PHAsset&amp;gt; {
        let allImagesOptions = PHFetchOptions()
        allImagesOptions.sortDescriptors = [NSSortDescriptor(key: &quot;creationDate&quot;, ascending: true)]
        return PHAsset.fetchAssets(with: allImagesOptions)
    }
}

extension AlbumViewController {
    
    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&amp;gt; Int {
        return images.count
    }
    
    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&amp;gt; UICollectionViewCell {
        
        let asset = images.object(at: indexPath.item)
        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: reuseIdentifier, for: indexPath)
        imageManager.requestImage(for: asset, targetSize: thumbnailSize, contentMode: .aspectFill, options: nil, resultHandler: { image, _ in
            cell.layer.contents = image?.cgImage
        })
        return cell
    }
    
    override func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {
        
        let asset = images.object(at: indexPath.item)

        if let cell = collectionView.cellForItem(at: indexPath) {
            cell.alpha = 0
            UIView.animate(withDuration: 0.5, animations: {
                cell.alpha = 1
            })
        }

        imageManager.requestImage(for: asset, targetSize: view.frame.size, contentMode: .aspectFill, options: nil, resultHandler: { [weak self] image, info in
            guard let image = image, let info = info else { return }
            
            if let isThumbnail = info[PHImageResultIsDegradedKey as NSString] as? Bool, !isThumbnail {
                self?.selectedImagesSubject.onNext(image)
            }
        })
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;è¿™é‡Œç®€è¦çš„è¯´ä¸‹Photosè¿™ä¸ªç³»ç»Ÿæ¡†æ¶, Photos frameworkæ˜¯iOS8è‹¹æœæä¾›çš„æ–°çš„å›¾ç‰‡æ¡†æ¶ï¼Œèƒ½ç›´æ¥è·å–å›¾ç‰‡å’Œè§†é¢‘ï¼ŒåŒ…æ‹¬iCloudä¸Šé¢çš„å›¾åº“ã€‚ä½¿ç”¨è¿™ä¸ªæ¡†æ¶å¯ä»¥è·å–assetsæ¥å±•ç¤ºå’Œå›æ”¾ï¼Œç¼–è¾‘å›¾ç‰‡æˆ–è€…è§†é¢‘å†…å®¹ï¼Œæˆ–è€…ä½¿ç”¨ç³»ç»Ÿç›¸å†Œã€æ—¶åˆ»ã€å’Œåˆ†äº«åˆ°iCloudçš„ç›¸å†Œæ¥è¿›è¡Œç›¸å…³æ“ä½œ.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬è¿™é‡Œç”¨åˆ°çš„æœ‰&lt;code class=&quot;highlighter-rouge&quot;&gt;PHCachingImageManager&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;PHFetchResult&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;PHFetchOptions&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;PHAsset&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;PHCachingImageManageræ˜¯PHImageManagerçš„å­ç±»ï¼Œå¦‚æœç›¸å†Œä¸­æœ‰å¤§é‡çš„å›¾ç‰‡ï¼Œè€Œä½ çš„éœ€æ±‚æ˜¯è¦å¿«é€Ÿçš„è·å–è¿™äº›å›¾ç‰‡çš„ç¼©ç•¥å›¾å’Œå¤§å›¾æ•°æ®ç”¨äºå±•ç¤ºï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨PHCachingImageManageræ¥å®ç°ï¼Œå®ƒå…·æœ‰ç¼“å­˜æœºåˆ¶å¯ä»¥å¿«é€Ÿè·å–ä¸€ä¸ªå›¾å†Œçš„ç¼©ç•¥å›¾ï¼Œæˆ–è€…åœ¨åå°è¯·æ±‚å…¨å°ºå¯¸å›¾ç‰‡ä»¥ä¾¿äºå¿«é€Ÿå±•ç¤ºã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/**
 *  ä¼šå¤šæ¬¡è°ƒç”¨'resultHandler'ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œè¿”å›çš„å›¾ç‰‡æ¸…æ™°åº¦è¾ƒä½ï¼Œ
 *  å½“é«˜æ¸…æ™°åº¦å›¾ç‰‡å¯ä»¥è·å–æ—¶,ä¼šå†æ¬¡è°ƒç”¨ï¼Œå¦‚æœé«˜è´¨é‡çš„å›¾ç‰‡åœ¨ç¼“å­˜æ±‡ä¸­ï¼Œåªè°ƒç”¨ä¸€æ¬¡'resultHandler'ã€‚
 *  è¿™ä¸ªæ–¹æ³•é»˜è®¤æ˜¯å¼‚æ­¥çš„ï¼Œå½“ä»åå°çº¿ç¨‹è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œéœ€è¦å°†optionsçš„'synchronous'è®¾ä¸ºYES.
 *
 *  @param asset         ä¿å­˜å›¾ç‰‡ä¿¡æ¯çš„asset
 *  @param targetSize    è¿”å›çš„å›¾ç‰‡å°ºå¯¸
 *  @param contentMode   è¿”å›çš„å›¾ç‰‡æ˜¾ç¤ºæ¨¡å¼
 *  @param options       image request option
 *  @param resultHandler è¿”å›çš„å†…å®¹
 *
 *  @return è¯·æ±‚æ ‡ç¤ºï¼Œç”¨äºå–æ¶ˆè¯·æ±‚*/
    open func requestImage(for asset: PHAsset, targetSize: CGSize, contentMode: PHImageContentMode, options: PHImageRequestOptions?, resultHandler: @escaping (UIImage?, [AnyHashable : Any]?) -&amp;gt; Swift.Void) -&amp;gt; PHImageRequestID
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;PHFetchResultæ˜¯æœ‰åºçš„photoå®ä½“å¯¹è±¡çš„å®¹å™¨ï¼ŒåŒ…å«é€šè¿‡ç»™å®šçš„æ£€ç´¢æ¡ä»¶è¿”å›çš„assetï¼Œç›¸å†Œï¼Œä¸€ä¸ªç›¸å†Œç±»å‹ä¸­çš„æ‰€æœ‰ç›¸å†Œåˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼Œsmart albumç±»å‹ä¸‹çš„æ‰€æœ‰ç›¸å†Œï¼Œå®ƒæ˜¯æœ‰åºçš„ï¼‰ï¼Œåœ¨PHAsset,PHCollection,PHAssetcollection,PHCollectionListè¿™å‡ ä¸ªç±»ä¸­éƒ½åŒ…å«æœ‰ç›¸åº”çš„ç±»æ–¹æ³•åŒ…å«å¯¹åº”ä¿¡æ¯çš„PHFetchRequestå¯¹è±¡,ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    open class func fetchAssets(with options: PHFetchOptions?) -&amp;gt; PHFetchResult&amp;lt;PHAsset&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;PHFetchOptions: å½“ä½ ä½¿ç”¨æ²¡æ–¹æ³•è·å–PHAssetï¼ˆå›¾ç‰‡å’Œè§†é¢‘ï¼‰,PHCollectionï¼ˆç›¸å†Œç±»å‹ï¼‰,PHAssetCollectionï¼ˆç›¸å†Œï¼‰çš„å®ä½“ï¼ˆç›¸å½“äºåŒ…å«å¤šä¸ªæ•°æ®çš„æ¨¡å‹ï¼‰ä½¿ç”¨PHFetchOptionså¯¹è±¡æŒ‡å®šæ“ä½œï¼Œä¾‹å¦‚è·å–çš„å®ä½“çš„æ’åˆ—å±æ€§ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œçš„æ“ä½œå¾ˆç®€å•, å°±æ˜¯é€šè¿‡è®¿é—®ç‰¹å®šé€‰é¡¹çš„PHFetchOptionså¾—åˆ°PHFetchResultä¸­çš„PHAssetå¹¶ä½¿ç”¨PHCachingImageManagerè¯·æ±‚ç³»ç»Ÿç›¸å†Œå¾—åˆ°ç›¸åº”çš„å›¾ç‰‡å¹¶é€šè¿‡å¯„å®¿å›¾çš„æ–¹å¼å±•ç¤ºåˆ°Cellä¸Š.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-425a3b6c535f638d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å“åº”å¼ç¼–ç¨‹çš„å…³é”®æˆ‘ä»¬åœ¨Cellç‚¹å‡»çš„å‡½æ•°ä¸­çš„ä»¥ä¸‹ä»£ç :&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; if let isThumbnail = info[PHImageResultIsDegradedKey as NSString] as? Bool, !isThumbnail {
       self?.selectedImagesSubject.onNext(image)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;é€šè¿‡å‘å¸ƒå¯¹è±¡PublishSubjectçš„onNextæ–¹æ³•å°†æ•°æ®å‘é€ç»™è®¢é˜…è€…, å›åˆ°ViewController, æˆ‘ä»¬å¯¹éƒ¨åˆ†ä»£ç è¿›è¡Œæ›´æ–°:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    @IBAction func actionAdd() {
//        images.value.append(UIImage(named: &quot;Castie!&quot;)!)
        
        let albumViewController = storyboard?.instantiateViewController(withIdentifier: &quot;AlbumViewController&quot;) as! AlbumViewController
        
        albumViewController.selectedImages.subscribe(
            onNext: { [weak self] newImage in
                guard let images = self?.images else { return }
                images.value.append(newImage)
            },
            onDisposed: {
                print(&quot;completed photo selection&quot;)
            }
        ).addDisposableTo(albumViewController.bag)
        
        navigationController?.pushViewController(albumViewController, animated: true)
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±é€šè¿‡RxSwiftå®ç°äº†é¡µé¢ä¹‹é—´çš„å“åº”å¼äº¤äº’, æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°å›¾ç‰‡çš„ä¿å­˜æ“ä½œ:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class AlbumWriter: NSObject {
    
    typealias Callback = (NSError?)-&amp;gt;Void
    
    private var callback: Callback
    private init(callback: @escaping Callback) {
        self.callback = callback
    }
    
    func image(_ image: UIImage, didFinishSavingWithError error: NSError?, contextInfo: UnsafeRawPointer) {
        callback(error)
    }
    
    static func save(_ image: UIImage) -&amp;gt; Observable&amp;lt;Void&amp;gt; {
        return Observable.create({ observer in
            let writer = AlbumWriter(callback: { error in
                if let error = error {
                    observer.onError(error)
                } else {
                    observer.onCompleted()
                }
            })
            UIImageWriteToSavedPhotosAlbum(image, writer, #selector(AlbumWriter.image(_:didFinishSavingWithError:contextInfo:)), nil)
            return Disposables.create()
        })
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å°è£…ä¸€ä¸ªå›¾ç‰‡å‚¨å­˜çš„AlbumWriterç±», é€šè¿‡Createæ–¹æ³•æ¥åˆ›å»ºè§‚å¯Ÿè€….&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;@IBAction func actionSave() {
        
        guard let image = imagePreview.image else { return }
        
        AlbumWriter.save(image).subscribe(
            
            onError: { [weak self] error in
            self?.showMessage(&quot;Error&quot;, description: error.localizedDescription)
            
            }, onCompleted: { [weak self] in
                self?.showMessage(&quot;Saved&quot;)
                self?.actionClear()
            }
            
        ).addDisposableTo(bag)
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æœ€ååœ¨Saveæ“ä½œçš„æ—¶å€™è¿›è¡Œè®¢é˜…å°±å¤§åŠŸå‘Šæˆäº†!!&lt;/p&gt;

&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-9b240f1eb5dac87a.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 18 Apr 2017 12:13:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/RxSwift-%E5%A4%A7%E7%A5%9E%E4%BB%AC%E9%83%BD%E5%9C%A8%E7%9C%8B%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/RxSwift-%E5%A4%A7%E7%A5%9E%E4%BB%AC%E9%83%BD%E5%9C%A8%E7%9C%8B%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>Hybird æ­å»ºå®¢æˆ·ç«¯å®æ—¶é™çº§æ¶æ„</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;RouterçœŸæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä¸€ç§è®¾è®¡æ¨¡å¼, èƒ½å¤Ÿåšåˆ°è¶…ä½çš„è€¦åˆ, ä½œä¸ºç³»åˆ—çš„æœ€åä¸€èŠ‚, æˆ‘ä»¬æ¥ç»Ÿç­¹ä¸‰ç«¯, å®ç°çƒ­ä¿®å¤æ¶æ„, å†æ¥è¯´ä¸‹è¿™ä¸ªæ¶æ„çš„å®šä¹‰, å°±æ˜¯å½“Nativeé¡µé¢ä¸šåŠ¡é€»è¾‘å‡ºç°Bugæ—¶, åˆä¸èƒ½é©¬ä¸Šæ‰“åŒ…ä¸Šçº¿é€šè¿‡å®¡æ ¸çš„æƒ…å†µä¸‹, é€šè¿‡åå°é…ç½®å°†é¡µé¢é™çº§ä¸ºH5çš„é¡µé¢, ç­‰å¾…ä¿®å¤å®Œæˆä¸Šçº¿åå†å›åˆ°Nativeçš„è®¾è®¡æ€æƒ³.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3866097366648136.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h6 id=&quot;å‚è€ƒé“¾æ¥&quot;&gt;å‚è€ƒé“¾æ¥:&lt;/h6&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/5a03995a6ce1&quot;&gt;Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/846b9f181cb7&quot;&gt;Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/8d4a84e3ddaa&quot;&gt;Hybird æ­å»ºå‰ç«¯Vue.jså¹¶å‡çº§è‡³MVP&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/36314d0c0032&quot;&gt;Hybird æ­å»ºè·¯ç”±Routerå®ç°ç»„ä»¶åŒ–&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹å†…å®¹åœ¨ä¸Šè¿°æ–‡ç« åŸºç¡€ä¸Šè¿›è¡Œ, è¯·äº‹å…ˆæŸ¥é˜….&lt;/p&gt;

&lt;p&gt;ä¸è¿‡å†™åˆ°è¿™é‡Œ, ä¸ç¦æ„Ÿè§‰è‡ªå·±å†™çš„è¿™ä¸ªæ¶æ„ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„çƒ­æ›´æ–°, è€Œæ˜¯å˜ç›¸çš„æ›¿ä»£, å°±åƒAT&amp;amp;Tçš„èœ‚çªæ•°æ®ä»LTEé™åˆ°3Gä¸€æ ·, å°±æ˜¯åŠ è½½çš„é€Ÿåº¦ä¸Šçš„å·®å¼‚, ä½†æƒ³å¿…ä¹Ÿæ¯”æœ‰Bugæ¥çš„å¥½å§.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥å®Œæˆå‰ç«¯çš„é¡µé¢å§, ä½œä¸ºMç«™, å¯¼èˆªæ åœ¨æµè§ˆå™¨çš„è®¿é—®ä¸‹éœ€è¦æ˜¾ç¤ºè€Œåœ¨ç§»åŠ¨ç«¯çš„é™çº§æ—¶ä¸éœ€è¦, æ‰€ä»¥æˆ‘ä»¬å…ˆæ¥å®Œæˆè¿™é¡¹å·¥ä½œ, é¦–å…ˆæˆ‘ä»¬éœ€è¦é€šè¿‡getå‚æ•°æ¥åˆ¤æ–­è·³è½¬æƒ…å†µ.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;src
â”œâ”€â”€ javascripts
â”‚Â Â  â”œâ”€â”€ http.js
â”‚Â Â  â””â”€â”€ regex.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;regex.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;export function URLQuery(key) {

  let reg = new RegExp(&quot;(^|&amp;amp;)&quot; + key + &quot;=([^&amp;amp;]*)(&amp;amp;|$)&quot;);
  let r = window.location.search.substr(1).match(reg);
  if (r != null) {
    return unescape(r[2]);
  }
  return null;
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¥ç€æˆ‘ä»¬åˆ›å»ºå¯¼èˆªç»„ä»¶:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;src
â”œâ”€â”€ components
â”‚Â Â  â”œâ”€â”€ J1.vue
â”‚Â Â  â””â”€â”€ navigation.vue
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;navigation.vue&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;template lang=&quot;html&quot;&amp;gt;
  &amp;lt;div v-show=&quot;show&quot;&amp;gt;
    &amp;lt;div class=&quot;nav&quot;&amp;gt;
        &amp;lt;span class=&quot;title&quot;&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;div class=&quot;nav-offset&quot;&amp;gt;&amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;

&amp;lt;script&amp;gt;

import {
  URLQuery
} from '../javascripts/regex'

export default {
  data () {
    return {
      show: true
    }
  },
  props: {
    documentTitle: String
  },
  mounted:function () {
    if (URLQuery('client') === 'app') {
      this.show = false;
    }
  }
}
&amp;lt;/script&amp;gt;

&amp;lt;style scoped&amp;gt;

.nav {
    width: 100%;
    height: 44px;
    position: relative;
    background: rgba(248,248,248,1.0);
    border-bottom: 1px solid lightgray;
    position: fixed;
    top: 0px;
    left: 0px;
    z-index: 1;
}

.nav-offset {
    height: 44px;
}

.title {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

&amp;lt;/style&amp;gt;


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨J1.vueä¸­æŒ‚è½½å­ç»„ä»¶&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&amp;lt;template lang=&quot;html&quot;&amp;gt;
  &amp;lt;div&amp;gt;
    &amp;lt;navigation :documentTitle=&quot;title&quot;&amp;gt;&amp;lt;/navigation&amp;gt; //update
    &amp;lt;div class=&quot;cell&quot; v-for=&quot;model in models&quot;&amp;gt;
        ![](model.imageUrl)
        &amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;
        &amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;

&amp;lt;script&amp;gt;

import navigation from './navigation' //update
import { GET,URL } from '../javascripts/http'
import { URLQuery } from '../javascripts/regex' //update

export default {
  data () {
    return {
      title: '',
      models: []
    }
  },
  components: { //update
    navigation
  },
  methods: {
    request: function() {
      GET(URL.getJ1List).then((data) =&amp;gt; {
          this.models = data.models;
      }).catch((error) =&amp;gt; {

      })
    }
  },
  mounted:function () {
    this.title = document.title = &quot;J1&quot;;
    this.request();
    // alert(window.location.href);
  }
}
&amp;lt;/script&amp;gt;

&amp;lt;style scoped&amp;gt;

.cell {
    height: 100px;
    position: relative;
    border-bottom: 1px solid lightgray;
}

.cell img {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    padding-left: 10px;
}

.cell span:first-of-type {
    position: absolute;
    top: 35%;
    transform: translateY(-35%);
    padding-left: 84px;
    font-size: 15px;
}

.cell span:last-of-type {
    position: absolute;
    top: 65%;
    transform: translateY(-65%);
    padding-left: 84px;
    font-size: 12px;
}

&amp;lt;/style&amp;gt;


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨ç§»åŠ¨ç«¯å¯¹webViewé¡µé¢è¿›è¡Œä¼ å‚:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;extension Router {
    
    func addParam(key: String, value: Any) {
        params?[key] = value
    }
    
    func clearParams() {
        params?.removeAll()
    }
    
    func push(_ path: String) {
        
        guardRouters {
            guard let state = self.routers?[path] as? String else { return }
            
            if state == &quot;app&quot; {
                guard let nativeController = NSClassFromString(&quot;RouterPatterm.\(self.map[path]!)&quot;) as? UIViewController.Type else { return }
                currentController?.navigationController?.pushViewController(nativeController.init(), animated: true)
            }
            
            if state == &quot;web&quot; { //update
                
                let host = &quot;http://localhost:3000/&quot;
                var query = &quot;&quot;
                let ref = &quot;client=app&quot;
                
                guard let params = self.params else { return }
                for (key, value) in params {
                    query += &quot;\(key)=\(value)&amp;amp;&quot;
                }
                
                self.clearParams()
                
                let webViewController = WebViewController(&quot;\(host)\(path)?\(query)\(ref)&quot;)
                currentController?.navigationController?.pushViewController(webViewController, animated: true)
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;é€šè¿‡clientæ˜¯ä¸æ˜¯appæ¥åˆ¤æ–­å¯¼èˆªæ çš„æ˜¾ç¤ºå’Œéšè—, æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡WKWebViewæ¥è¿›è¡Œå¯¹JSçš„é€šè®¯:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
class WebViewController: ViewController {
    
    fileprivate lazy var configuretion: WKWebViewConfiguration = { [weak self] in
        let configuretion = WKWebViewConfiguration()
        configuretion.userContentController.add(self!, name: &quot;push&quot;) //update
        configuretion.userContentController.add(self!, name: &quot;params&quot;) //update
        return configuretion
    }()
    
	...    
}

extension WebViewController: WKScriptMessageHandler {
    
    func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { //update
        
        let methods = &quot;\(message.name):&quot;
        let selector = NSSelectorFromString(methods)
        if self.responds(to: selector) {
            self.perform(selector, with: message.body)
        }
    }
}

extension WebViewController {
    
    @objc fileprivate func push(_ path: String) { //update
        Router.shareRouter.push(path)
    }
    
    @objc fileprivate func params(_ params: [String : Any]) { //update
        Router.shareRouter.params = params
    }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨JSä¸­æ·»åŠ è·³è½¬å’Œæ·»åŠ å‚æ•°çš„æ–¹æ³•å¹¶é€šè¿‡runtimeçš„æ–¹æ³•åŒ¹é…SELåŸç”Ÿæ–¹æ³•, æ¥ä¸‹æ¥, æˆ‘ä»¬åœ¨å‰ç«¯ä¸­ä¹ŸåŠ å…¥äº¤äº’çš„ä»£ç :&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”œâ”€â”€ javascripts
â”‚Â Â  â”œâ”€â”€ http.js
â”‚Â Â  â”œâ”€â”€ native.js
â”‚Â Â  â””â”€â”€ regex.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;native.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
export function NativePush(path) {
  window.webkit.messageHandlers.push.postMessage(path);
}

export function NativeParams(params) {
  window.webkit.messageHandlers.params.postMessage(params);
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å¹¶åœ¨J1.vueä¸­æ·»åŠ ä¸Šäº¤äº’é€»è¾‘&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;template lang=&quot;html&quot;&amp;gt;
  &amp;lt;div&amp;gt;
    &amp;lt;navigation :documentTitle=&quot;title&quot;&amp;gt;&amp;lt;/navigation&amp;gt;
    &amp;lt;div class=&quot;cell&quot; v-for=&quot;model in models&quot; @click=&quot;push('J1')&quot;&amp;gt; //update
        ![](model.imageUrl)
        &amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;
        &amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;

&amp;lt;script&amp;gt;

import navigation from './navigation'
import { GET,URL } from '../javascripts/http'
import { URLQuery } from '../javascripts/regex'
import { NativePush, NativeParams } from '../javascripts/native' //update

export default {
  data () {
    return {
      title: '',
      models: []
    }
  },
  components: {
    navigation
  },
  methods: {
    request: function() {
      GET(URL.getJ1List).then((data) =&amp;gt; {
          this.models = data.models;
      }).catch((error) =&amp;gt; {

      })
    },
    push : function(path) { //update
      if (URLQuery('client') === 'app') {
          let params = {
            text : &quot;webç«¯ ä¼ å…¥æ•°æ®&quot;,
            code : 1002
          }
          NativeParams(params);
          NativePush(path);
      } else {
          this.$router.push({
                path: '/' + path
          });
      }
    }
  },
  mounted:function () {
    this.title = document.title = &quot;J1&quot;;
    this.request();
    // alert(window.location.href);
  }
}
&amp;lt;/script&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬çš„æ¶æ„è®¾è®¡å°±ç®—åŸºæœ¬å®Œæˆäº†.&lt;/p&gt;

&lt;p&gt;å½©è›‹:
ä¸ºæˆ‘ä»¬çš„åç«¯è¿ä¸Šæ•°æ®åº“å§, é€šè¿‡æ¥å£æ”¹å˜æ•°æ®åº“çš„å€¼ä¸ç”¨é‡å¯æœåŠ¡å°±èƒ½å¤Ÿæ“æ§é¡µé¢.
æ•°æ®åº“æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨&lt;a href=&quot;https://www.mongodb.com/&quot;&gt;mongodb&lt;/a&gt;, å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§ä¼—æƒ…äººmysql, éšä¾¿â€¦&lt;/p&gt;

&lt;p&gt;å®‰è£…å®Œæˆåæˆ‘ä»¬æ‰§è¡Œ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;$ mongod â€“config /usr/local/etc/mongod.conf å¼€å¯æœåŠ¡.&lt;/li&gt;
  &lt;li&gt;$ use J1 //åˆ›å»ºæ•°æ®åº“&lt;/li&gt;
  &lt;li&gt;$ switched to db J1 //åˆ‡æ¢åˆ°æ•°æ®åº“&lt;/li&gt;
  &lt;li&gt;$ db.createCollection(â€˜routersâ€™) //åˆ›å»ºroutersé›†åˆ&lt;/li&gt;
  &lt;li&gt;$ db.routers.insert({â€˜J1â€™ : â€˜appâ€™}) //æ’å…¥æ•°æ®åˆ°é›†åˆ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬æ•°æ®åº“çš„å‡†å¤‡å·¥ä½œå°±å®Œæˆäº†, å¯¹äºNodeæˆ‘ä»¬åœ¨package.jsonä¸­å¯¼å…¥mongoose, ç„¶ååœ¨åç«¯çš„ç›®å½•ç»“æ„ä¸Šæ·»åŠ dbè·¯å¾„:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;db
â”œâ”€â”€ J1
â”‚Â Â  â””â”€â”€ routers.js
â”œâ”€â”€ base.js
â””â”€â”€ config.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;config.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const mongoose = require('mongoose');

var db = mongoose.connect('mongodb://localhost/J1');

db.connection.on(&quot;error&quot;, function(error) {
    console.log(&quot;database connect failï¼š&quot; + error);
});

db.connection.on(&quot;open&quot;, function() {
    console.log(&quot;database connect success&quot;);
})

db.connection.on('disconnected', function() {
    console.log('database disconnected');
})

exports.mongoose = mongoose;


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;base.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;let mongodb = require('./config');
let mongoose = mongodb.mongoose;
let Schema = mongoose.Schema;
let ObjectId = Schema.Types.ObjectId;

exports.mongodb = mongodb;
exports.mongoose = mongoose;
exports.Schema = Schema;
exports.ObjectId = ObjectId;
exports.Mixed = Schema.Types.Mixed;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;routers.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;let base = require('../base');
let ObjectId = base.ObjectId;
let Scheme = new base.Schema({
    J1: String
});

module.exports = base.mongoose.model('routers', Scheme);
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨æ¥å£ä¸­è°ƒç”¨æ•°æ®åº“:&lt;/p&gt;

&lt;p&gt;J1.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;exports.getRouters = async(ctx, next) =&amp;gt; {

    var routers = await Routers.find({});
    ctx.body = {
        routers: routers[0]
    }
}

exports.updateRouters = async(ctx, next) =&amp;gt; {

    const controller = ctx.params.controller;
    const client = ctx.params.client;

    if (controller === 'J1') {
        Routers.update({
            J1: client
        }, (err, doc) =&amp;gt; {
            console.log(doc);
        })
    } else {
        console.log('controller is not exist');
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ·»åŠ è·¯ç”±:&lt;/p&gt;

&lt;p&gt;J1_router.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
var router = require('koa-router')();
var J1 = require('../../app/controllers/J1');

router.get('/getRouters', J1.getRouters);
router.get('/updateRouters/:controller/:client', J1.updateRouters); //update
router.get('/getJ1List', J1.getJ1List);

module.exports = router;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬åœ¨æœåŠ¡å…¨éƒ¨å¼€å¯çš„æƒ…å†µä¸‹è°ƒç”¨updateRoutersæ¥å£,&lt;/p&gt;

&lt;p&gt;æµè§ˆå™¨è¾“å…¥:
http://localhost:3001/api/J1/updateRouters/J1/web
http://localhost:3001/api/J1/updateRouters/J1/app&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å°±èƒ½å¤Ÿç›´æ¥æ›´æ”¹æ•°æ®åº“åŠ¨æ€çš„é™çº§æˆ–å‡çº§é¡µé¢äº†.&lt;/p&gt;

&lt;p&gt;æœ€åæ¥æ€»ç»“ä¸€ä¸‹, æˆ‘ä»¬é€šè¿‡äº†Swift3 + Vue2 + Koa2, å®ç°äº†å¯é™çº§çš„ç§»åŠ¨ç«¯æ¶æ„:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;cd /RouterPattern/server/RouterPattern $ npm start å¼€å¯æ¥å£æœåŠ¡å™¨&lt;/li&gt;
  &lt;li&gt;cd /RouterPattern/server/RouterPattern/public/javascripts $ node image.js å¼€å¯å›¾ç‰‡æœåŠ¡å™¨&lt;/li&gt;
  &lt;li&gt;cd /RouterPattern/web/RouterPattern $ npm run dev æ‰“å¼€å‰ç«¯é¡µé¢&lt;/li&gt;
  &lt;li&gt;cd /RouterPattern/app/RouterPattern $ open RouterPatterm.xcworkspace æ‰“å¼€Xcode&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä»¥ä¸Šå°±æ˜¯æˆ‘æƒ³ä¸å¤§å®¶åˆ†äº«çš„è®¾è®¡æ€æƒ³, å¸Œæœ›å¤§å®¶æå‡ºå®è´µæ„è§.&lt;/p&gt;

&lt;p&gt;æ¼”ç¤ºæ•ˆæœ:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-32c9c5e7c147b54a.gif?imageMogr2/auto-orient/strip&quot; alt=&quot;RouterPattern.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 12 Apr 2017 16:37:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%9E%E6%97%B6%E9%99%8D%E7%BA%A7%E6%9E%B6%E6%9E%84/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%9E%E6%97%B6%E9%99%8D%E7%BA%A7%E6%9E%B6%E6%9E%84/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>Hybird æ­å»ºè·¯ç”±Routerå®ç°ç»„ä»¶åŒ–</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;MVPæ˜¯ä¸ªéå¸¸å¥½çš„è®¾è®¡æ¨¡å¼, èƒ½å¤Ÿè¿›è¡Œä»£ç è§£è€¦, ä¸šåŠ¡åˆ†å±‚, ç»„ä»¶åŒ–å¿…å¤‡è‰¯å“, ä½†æ˜¯è¿˜èƒ½ä¸èƒ½å†æå‡ä¸€æ­¥å‘¢? ç°åœ¨é¡¹ç›®ä¸­çš„è€¦åˆæ˜¯å¾ˆå°‘äº†, ä½†æ˜¯æ§åˆ¶å™¨ä¹‹å‰çš„åˆ‡æ¢è¿˜æ˜¯æœ‰è€¦åˆå­˜åœ¨, æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿå®ç°æ§åˆ¶å™¨é›¶è€¦åˆå‘¢?? é‚£å°±è¦ç¥­å‡ºæœ¬ç³»åˆ—çš„æ ¸å¿ƒRouteræ¨¡å¼äº†.ä»£ç è§: &lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3866097366648136.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h6 id=&quot;å‚è€ƒé“¾æ¥&quot;&gt;å‚è€ƒé“¾æ¥:&lt;/h6&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/5a03995a6ce1&quot;&gt;Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/846b9f181cb7&quot;&gt;Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/8d4a84e3ddaa&quot;&gt;Hybird æ­å»ºå‰ç«¯Vue.jså¹¶å‡çº§è‡³MVP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹å†…å®¹åœ¨ä¸Šè¿°æ–‡ç« åŸºç¡€ä¸Šè¿›è¡Œ, è¯·äº‹å…ˆæŸ¥é˜….&lt;/p&gt;

&lt;p&gt;é›¶è€¦åˆä¸€ç›´éƒ½æ˜¯ç¥è¯èˆ¬çš„å­˜åœ¨, ä½†æ˜¯èº«è¾¹çš„è´Ÿèƒ½é‡æ€»æ˜¯ä¸ç»äºè€³, ä¸è¦ä¸ºäº†ç”¨è®¾è®¡æ¨¡å¼è€Œè®¾è®¡æ¨¡å¼, è¯¶.. æˆ‘ä»¬è¿˜æ˜¯å›åˆ°Routerä¸Šæ¥å§, ç©¶ç«Ÿå¦‚ä½•æ‰èƒ½æ„å»ºRouteræ¶æ„å‘¢? ä¸æ€¥, æˆ‘ä»¬å…ˆæŠŠå‰ç«¯çš„é¡¹ç›®ç»™æ­å»ºå®Œæ¯•å§.&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å°†ç«¯å£å·æ”¹ä¸º3000, å¯¹åº”ç«¯å£ å‰ç«¯: 3000, æ¥å£æœåŠ¡å™¨: 3001, å›¾ç‰‡æœåŠ¡å™¨: 3002&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”œâ”€â”€ config
  â”œâ”€â”€ dev.env.js
  â”œâ”€â”€ index.js
  â””â”€â”€ prod.env.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;index.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  dev: {
    env: require('./dev.env'),
    port: 3000, //update
    autoOpenBrowser: true,
    assetsSubDirectory: 'static',
    assetsPublicPath: '/',
    proxyTable: {},
    // CSS Sourcemaps off by default because relative paths are &quot;buggy&quot;
    // with this option, according to the CSS-Loader README
    // (https://github.com/webpack/css-loader#sourcemaps)
    // In our experience, they generally work as expected,
    // just be aware of this issue when enabling this option.
    cssSourceMap: false
  }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å…ˆåœ¨package.jsonä¸­æ·»åŠ ç½‘ç»œè¯·æ±‚axios, Vue2å¼€å§‹çš„å®˜æ–¹æ¨è,&lt;/p&gt;

&lt;p&gt;package.json&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &quot;dependencies&quot;: {
    &quot;axios&quot;: &quot;^0.15.3&quot;,
    &quot;element-ui&quot;: &quot;^1.1.2&quot;,
    &quot;stylus&quot;: &quot;^0.54.5&quot;,
    &quot;stylus-loader&quot;: &quot;^2.4.0&quot;,
    &quot;vue&quot;: &quot;^2.1.0&quot;,
    &quot;vue-router&quot;: &quot;^2.1.1&quot;
  },
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¹¶åœ¨srcä¸‹åˆ›å»ºjavascripts å’Œ stylesheets ä¸¤ä¸ªç›®å½•:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â”œâ”€â”€ App.vue
â”œâ”€â”€ assets
â”‚Â Â  â””â”€â”€ logo.png
â”œâ”€â”€ components
â”œâ”€â”€ javascripts
â”œâ”€â”€ main.js
â”œâ”€â”€ router
â”‚Â Â  â””â”€â”€ index.js
â””â”€â”€ stylesheets
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¹¶åœ¨javascriptsä¸­æ·»åŠ http.jsæ¥æ‰§è¡Œç½‘è·¯è¯·æ±‚è„šæœ¬:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”œâ”€â”€ javascripts
 Â Â  â”œâ”€â”€ http.js

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;http.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
import axios from 'axios'

export function GET(url) {

  return new Promise((resolve, reject) =&amp;gt; {
    axios.get(url).then((response) =&amp;gt; {
      resolve(response.data.data);
    }).catch((error) =&amp;gt; {
      reject(error);
    })
  });
}

export const URL = {
  getJ1List: 'http://localhost:3001/api/J1/getJ1List'
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ä»£ç ä¹Ÿå¾ˆç®€å•, å’Œä¹‹å‰Swiftçš„Alamofireä¸€æ ·, åœ¨å¤–é¢å°è£…ä¸€å±‚, ä½¿ç”¨ES6è¯­æ³•çš„Promise, å¹¶å®šä¹‰æ¥å£URL.&lt;/p&gt;

&lt;p&gt;æ¥ç€æˆ‘ä»¬å°†Hello.vueä¿®æ”¹ä¸ºJ1.vue&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”œâ”€â”€ src
  â”œâ”€â”€ components
    â””â”€â”€ J1.vue
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;J1.vue&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&amp;lt;template lang=&quot;html&quot;&amp;gt;
  &amp;lt;div&amp;gt;
    &amp;lt;div class=&quot;cell&quot; v-for=&quot;model in models&quot;&amp;gt;
        ![](model.imageUrl)
        &amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;
        &amp;lt;span&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;

&amp;lt;script&amp;gt;

import { GET,URL } from '../javascripts/http'

export default {
  data () {
    return {
      title: '',
      models: []
    }
  },
  methods: {
    request: function() {
      GET(URL.getJ1List).then((data) =&amp;gt; {
          this.models = data.models;
      }).catch((error) =&amp;gt; {

      })
    }
  },
  mounted:function () {
    this.title = document.title = &quot;J1&quot;;
    this.request();
    // alert(window.location.href);
  }
}
&amp;lt;/script&amp;gt;

&amp;lt;style scoped&amp;gt;

.cell {
    height: 100px;
    position: relative;
    border-bottom: 1px solid lightgray;
}

.cell img {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    padding-left: 10px;
}

.cell span:first-of-type {
    position: absolute;
    top: 35%;
    transform: translateY(-35%);
    padding-left: 84px;
    font-size: 15px;
}

.cell span:last-of-type {
    position: absolute;
    top: 65%;
    transform: translateY(-65%);
    padding-left: 84px;
    font-size: 12px;
}

&amp;lt;/style&amp;gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹è·¯ç”±:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â”œâ”€â”€ src
  â”œâ”€â”€ router
    â””â”€â”€ index.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import Vue from 'vue'
import Router from 'vue-router'
import J1 from '../components/J1'

Vue.use(Router)

export default new Router({
  routes: [{
      path: '/',
      component: J1
    },
    {
      path: '/J1',
      component: J1
    },
    {
      path: '*',
      redirect: '/'
    }
  ]
})

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ‰§è¡Œä¸€ä¸‹, æ€ä¹ˆä»€ä¹ˆéƒ½æ²¡æœ‰, è¿™ä¸ªå°±è¦è¯´åˆ°ajaxçš„è·¨åŸŸé—®é¢˜äº†, æˆ‘ä»¬è¿™é‡Œä¸å±•å¼€, å¯¹è·¨åŸŸæœ‰ç–‘é—®çš„åŒå­¦è¯·è‡ªè¡ŒGoogle.&lt;/p&gt;

&lt;p&gt;è¦è§£å†³è·¨åŸŸ, æˆ‘ä»¬é€šè¿‡åœ¨åç«¯åŠ è½½è·¨åŸŸæƒé™çš„æ–¹å¼:&lt;/p&gt;

&lt;p&gt;åœ¨server/app.js ä¸­æ·»åŠ :&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const cors = require('koa-cors');

app.use(cors());

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å½“ç„¶ä½ éœ€è¦ npm installä¸€ä¸‹äº†, è¿™æ ·æˆ‘ä»¬å°±èƒ½çœ‹è§webç«¯çš„æ˜¾ç¤ºäº†.&lt;/p&gt;

&lt;p&gt;å‰ç«¯ä¸å°å™è¿°çš„æœ‰ç‚¹å¤šäº†, ä½†è¿™å¯¹äºçƒ­ä¿®å¤è¿˜æ˜¯å¿…é¡»çš„, æˆ‘ä»¬å›åˆ°ç§»åŠ¨ç«¯çš„é¡¹ç›®ä¸Šæ¥, åœ¨åŠ è½½webViewçš„æ—¶å€™å°†ç«¯å£å·æ”¹ä¸º3000, è¿™æ ·æˆ‘ä»¬åœ¨appç«¯å°±èƒ½å¤ŸåŠ è½½åˆšæ‰åˆ›å»ºç›¸åŒç‰ˆæœ¬çš„webé¡µé¢äº†.&lt;/p&gt;

&lt;p&gt;è¿è½½åˆ°ç°åœ¨, æˆ‘ä»¬å‘ç°äº†Koaä¸­çš„æ¥å£æ˜¯åŸºäºRouterçš„, Vueä¸­çš„é¡µé¢è·³è½¬ä¹Ÿæ˜¯åŸºäºRouterçš„, é‚£æˆ‘ä»¬ç§»åŠ¨ç«¯èƒ½ä¸èƒ½ä¹Ÿæœ‰è‡ªå·±çš„Routerè·³è½¬æœºåˆ¶å‘¢? å…¶å®ä¸€äº›ç´§è·Ÿæ½®æµçš„å¼€å‘è€…éƒ½çŸ¥é“ç°åœ¨æµè¡Œç»„ä»¶åŒ–, è€Œç§»åŠ¨ç«¯ç»„ä»¶åŒ–çš„ä»£è¡¨å°±æ˜¯Router, ä¹Ÿæœ‰ä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶ä¹‹ç±»çš„, å­°ä¼˜å­°åŠ£æˆ‘æ²¡ç”¨è¿‡, ä¹Ÿä¸æ¸…æ¥š, åœ¨è¿™é‡Œæˆ‘åªæ˜¯åŸºäºå¯¹å‰ç«¯è·¯ç”±çš„ç†è§£æ¥æ­å»ºä¸€ä¸ªç§»åŠ¨ç«¯çš„è·¯ç”±, é¦–å…ˆæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªRouter.swift.&lt;/p&gt;

&lt;p&gt;Router.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class Router {
    static let shareRouter = Router()
    var params: [String : Any]?
    fileprivate let map = [&quot;J1&quot; : &quot;Controller&quot;]
}


extension Router {
    
    func addParam(key: String, value: Any) {
        params?[key] = value
    }
    
    func clearParams() {
        params?.removeAll()
    }
    
    func push(_ path: String) {
        guard let nativeController = NSClassFromString(&quot;RouterPatterm.\(self.map[path]!)&quot;) as? UIViewController.Type else { return }
        currentController?.navigationController?.pushViewController(nativeController.init(), animated: true)
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;é¦–å…ˆRouterå¿…é¡»æ˜¯ä¸€ä¸ªå•ä¾‹, Swiftçš„å•ä¾‹æ¯”èµ·Objective-CçœŸæ˜¯ç®€å•å¤ªå¤šäº†, æ¥çœ‹æˆ‘ä»¬çš„Routerç±», mapæ˜¯å¯¹åº”åŒ¹é…è·³è½¬æ§åˆ¶å™¨,å¹¶å¯ä»¥æ·»åŠ å‚æ•°, åˆ é™¤å‚æ•°, å’Œè·³è½¬çš„æ–¹æ³•, å½“ç„¶ä¹Ÿå¯ä»¥åŠ ä¸Špopç­‰å…¶ä»–åŠŸèƒ½, æˆ‘è¿™é‡Œå°±ä¸æ¼”ç¤º, æœ‰å…´è¶£çš„åŒå­¦è‡ªè¡Œç ”ç©¶.&lt;/p&gt;

&lt;p&gt;å®šä¹‰å®Œæˆä¹‹å, æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä½¿ç”¨äº†, æˆ‘ä»¬ä¿®æ”¹ä¸šåŠ¡é€»è¾‘çš„Presenter.swift&lt;/p&gt;

&lt;p&gt;Presenter.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
extension Presenter: ViewOperation {
    
    func pushTo() {
        Router.shareRouter.params = [
            &quot;text&quot; : &quot;appç«¯ ä¼ å…¥æ•°æ®&quot;,
            &quot;code&quot; : 1001
        ]
        Router.shareRouter.push(&quot;J1&quot;) //update
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨æ“ä½œè¿™é‡Œç›´æ¥æ›´æ”¹ä¸ºä½¿ç”¨Routerè·³è½¬, è¿™æ ·æ›´å…·mapå®šä¹‰çš„åŒ¹é…, æˆ‘ä»¬å°±èƒ½å¤Ÿè¿›è¡Œé›¶è€¦åˆçš„é¡µé¢è·³è½¬äº†. å¦‚æœéœ€è¦ä¼ å‚ä¹Ÿå¯ä»¥é€šè¿‡å­—å…¸çš„å½¢å¼å­˜å‚¨åœ¨è·¯ç”±ä¸­, å½“ä½¿ç”¨å®Œæˆåå¯¹å‚æ•°åšæ¸…ç©ºæ“ä½œå°±å¯ä»¥äº†.&lt;/p&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¯¹ç§»åŠ¨ç«¯çš„è·¯ç”±è·³è½¬å·²ç»åˆ°ä½äº†, æ¥ä¸‹å•¦è¯¥è¯´è¯´é‡ç‚¹çš„çƒ­æ›´æ–°çš„æ€æƒ³äº†, æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä»æœåŠ¡å™¨è¯»å–çš„å­—æ®µæ¥åŒ¹é…è¯¥é¡µé¢æ˜¯è·³è½¬åˆ°ç§»åŠ¨ç«¯è¿˜æ˜¯å‰ç«¯, ç®€å•æ¥è¯´å°±æ˜¯å½“ç§»åŠ¨ç«¯ä»£ç é€»è¾‘å‘ç”Ÿé”™è¯¯æ—¶æ€ä¹ˆå°†ç§»åŠ¨ç«¯çš„é¡µé¢é™çº§ä¸ºå‰ç«¯çš„é¡µé¢. è¿™é‡Œæˆ‘ä»¬åœ¨åç«¯å®šä¹‰ä¸‹è·å–è·³è½¬çš„æ¥å£.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;controllers
	â””â”€â”€ J1.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;J1.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;exports.getRouters = async(ctx, next) =&amp;gt; {

    ctx.body = {
        routers: {
            J1: 'web'
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;å¹¶æŒ‚è½½åˆ°è·¯ç”±ä¸Š:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â”œâ”€â”€ api
â”‚Â Â  â”œâ”€â”€ J1_router.js
â”‚Â Â  â””â”€â”€ index.js
â”œâ”€â”€ index.js
â””â”€â”€ users.js
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;J1_router&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
var router = require('koa-router')();
var J1 = require('../../app/controllers/J1');

router.get('/getRouters', J1.getRouters); //update
router.get('/getJ1List', J1.getJ1List);

module.exports = router;

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;é€šè¿‡æ¥å£è®¿é—®, æˆ‘ä»¬å°±èƒ½å¾—åˆ°è¿”å›æ•°æ®:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;routers&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;J1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;web&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å›åˆ°ç§»åŠ¨ç«¯, æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥å£æ¥åˆ¤æ–­è·¯ç”±çš„è·³è½¬äº†.&lt;/p&gt;

&lt;p&gt;Router.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class Router {
    static let shareRouter = Router()
    var params: [String : Any]?
    var routers: [String : Any]? //update
    fileprivate let map = [&quot;J1&quot; : &quot;Controller&quot;]
    
    func guardRouters(finishedCallback : @escaping () -&amp;gt; ()) { //update
        
        Http.requestData(.get, URLString: &quot;http://localhost:3001/api/J1/getRouters&quot;) { (response) in
            guard let result = response as? [String : Any] else { return }
            guard let data:[String : Any] = result[&quot;data&quot;] as? [String : Any] else { return }
            guard let routers:[String : Any] = data[&quot;routers&quot;] as? [String : Any] else { return }
            self.routers = routers
            finishedCallback()
        }
    }
}

extension Router {
    
    func addParam(key: String, value: Any) {
        params?[key] = value
    }
    
    func clearParams() {
        params?.removeAll()
    }
    
    func push(_ path: String) {
        
        guardRouters { //update
            guard let state = self.routers?[path] as? String else { return }
            
            if state == &quot;app&quot; {
                guard let nativeController = NSClassFromString(&quot;RouterPatterm.\(self.map[path]!)&quot;) as? UIViewController.Type else { return }
                currentController?.navigationController?.pushViewController(nativeController.init(), animated: true)
            }
            
            if state == &quot;web&quot; {
                let host = &quot;http://localhost:3000/&quot;
                let webViewController = WebViewController(&quot;\(host)&quot;)
                currentController?.navigationController?.pushViewController(webViewController, animated: true)
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬åœ¨æ¯æ¬¡è·¯ç”±è·³è½¬çš„æ—¶å€™éƒ½è¯·æ±‚åˆ°å¯¹åº”çš„é¡µé¢çŠ¶æ€å°±å¯ä»¥åå°æ“ä½œè·³è½¬Nativeè¿˜æ˜¯H5äº†.&lt;/p&gt;

&lt;p&gt;å›é¡¾ä¹‹å‰çš„ä»£ç , æˆ‘ä»¬ç°åœ¨å·²ç»åšåˆ°äº†Model, View, ViewModel, Presenterå’ŒControllerä¹‹é—´çš„é›¶è€¦åˆ, æƒ³æƒ³æ˜¯ä¸æ˜¯æœ‰ç‚¹å°æ¿€åŠ¨, ä¸‹ä¸€èŠ‚å†…å®¹, æˆ‘ä»¬ä¼šå°†Swift, Vue, Koaä¸‰ç«¯è¿›è¡Œç»Ÿç­¹, å®ç°çœŸæ­£çš„çƒ­ä¿®å¤æ¡†æ¶.&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 12 Apr 2017 13:40:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E8%B7%AF%E7%94%B1Router%E5%AE%9E%E7%8E%B0%E7%BB%84%E4%BB%B6%E5%8C%96/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E8%B7%AF%E7%94%B1Router%E5%AE%9E%E7%8E%B0%E7%BB%84%E4%BB%B6%E5%8C%96/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>Hybird æ­å»ºå‰ç«¯Vue.jså¹¶å‡çº§è‡³MVP</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;ä¸Šå›æˆ‘ä»¬è¯´åˆ°MVVM, è¯´çœŸçš„æˆ‘çœŸæ²¡è§‰å¾—MVVMä¸ºä»€ä¹ˆä¼šé¼“å¹çš„é‚£ä¹ˆç¥, ç”¨å¤§ç¯‡å¹…çš„å™è¿°æˆ‘ç€å®æä¸èµ·åŠ². å›é¡¾ä¸€ä¸‹å†…å®¹, æˆ‘ä»¬é€šè¿‡Node.jsæ­å»ºäº†å›¾ç‰‡æœåŠ¡å™¨, å¹¶é€šè¿‡KingfisheråŠ è½½å‡ºæ¥, è¯´çœŸçš„å‰ä¸¤ç¯‡ä¸»è¦è¿˜æ˜¯å™è¿°ç§»åŠ¨ç«¯å…¥é—¨åç«¯å§.. å™—.. ç¬‘.. è¿™ä¸€èŠ‚æˆ‘ä»¬æ¥è¯´è¯´MVPæ¨¡å¼, ä¹Ÿæ˜¯æˆ‘æ¯”è¾ƒå–œæ¬¢ä»¥åŠæ¨èå¤§å®¶ä½¿ç”¨çš„ä¸€ç§è®¾è®¡æ€æƒ³. ä»£ç è§:&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3866097366648136.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h6 id=&quot;å‚è€ƒé“¾æ¥&quot;&gt;å‚è€ƒé“¾æ¥:&lt;/h6&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/5a03995a6ce1&quot;&gt;Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/846b9f181cb7&quot;&gt;Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹å†…å®¹åœ¨ä¸Šè¿°æ–‡ç« åŸºç¡€ä¸Šè¿›è¡Œ, è¯·äº‹å…ˆæŸ¥é˜….&lt;/p&gt;

&lt;p&gt;çœ‹äº†ç½‘ä¸Šå¥½å¤šç±»å‹çš„æ¶æ„è®¾è®¡, ç”¨é‚£äº›ç„ä¹çš„ç†è®º, è¯¸å¦‚é«˜å†…èšä½è€¦åˆ, DRYç­‰ä¸“æœ‰åè¯ä¹‹ç±»çš„æ³›æ³›è€Œè°ˆ, ä¸€æ¡æ¡æçº²æŒˆé¢†çš„è¯‰è¯´ç€ç¼–å†™ä»£ç çš„è¯¥æœ‰çš„è§„èŒƒ, æˆ‘ä¸å¦è®¤è¿™äº›æ€æƒ³å¾ˆé‡è¦, ä½†ä¸èƒ½è¿ç”¨åˆ°å®é™…ä¸Šä¹Ÿåªèƒ½æ˜¯å¤¸å¤¸å…¶è°ˆç½¢äº†, ä¹Ÿè®¸æ˜¯æˆ‘çš„é“è¡Œç•¥ä½ä¸èƒ½ä¼åŠé‚£æ ·çš„é«˜åº¦, ä½†å…‰æœ‰æ€ç»´æ–¹å¼ä¸ç»™å®æ“æ–¹å¼, ä¸å®—æ•™åˆæœ‰ä½•å¼‚? æ€»ç»“å°±æ˜¯, å¯¹äºæ¶æ„è®¾è®¡, ä¸ä¸Šä»£ç å°±æ˜¯æ‰¯!&lt;/p&gt;

&lt;p&gt;MVP&lt;/p&gt;

&lt;p&gt;MVPå°±æ˜¯ Most Valuable Player, æœ€æœ‰ä»·å€¼çƒå‘˜.. ç¬‘â€ è¯è¯´æˆ‘å¤§å¨å°‘åœºå‡ä¸‰åŒèµ›å­£å°ç¥å•Š, è¨€å½’æ­£ä¼ , MVPåœ¨æ¶æ„è®¾è®¡æ¥è¯´æ˜¯æŒ‡ Model, View, Presenter,  å…¶ä¸­çš„PresenteræŒ‡çš„æ˜¯å±•ç¤ºå±‚, æ“ä½œé¡µé¢é€»è¾‘çš„ä¸€å±‚. MVPä¹Ÿæ˜¯æˆ‘æœ€ä¸ºæ¨èçš„ä¸€ç§è®¾è®¡æ¨¡å¼, åšAndroidçš„åŒå­¦åº”è¯¥æœ‰å¬è¯´è¿‡é€‚é…å™¨æ¨¡å¼, ä¹Ÿå°±æ˜¯Adapter, MVPä¸­çš„Presenterå°±å¥½åƒæ˜¯åŒå‘çš„Adapter, å¯¹ä»£ç è¿›è¡Œå®Œå…¨çš„è§£è€¦å®ç°ç»„ä»¶åŒ–.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åˆ‡æ¢åˆ°MVPæ¨¡å¼:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â”œâ”€â”€ Controller.swift
â”œâ”€â”€ Model.swift
â”œâ”€â”€ Presenter.swift
â”œâ”€â”€ View.swift
â””â”€â”€ ViewModel.swift
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨ç›®å½•ç»“æ„ä¸­æ·»åŠ Presenter.swift&lt;/p&gt;

&lt;p&gt;Presenter.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
protocol ModelInterface {
    var text : String {get set}
    var detailText : String {get set}
    var imageUrl : String {get set}
}

protocol ViewInterface {
    var viewModel: ViewModelInterface? {get set}
}

protocol ViewModelInterface {
    var models: [ModelInterface] {get set}
    mutating func dynamicBinding(finishedCallback : @escaping () -&amp;gt; ())
}

class Presenter {
    var view: ViewInterface?
    var viewModel: ViewModelInterface?
}

extension Presenter {
    
    func adapter&amp;lt;VM: ViewModelInterface,V: ViewInterface&amp;gt;(viewModel: VM,  view: V) {
        
        self.view = view;
        self.viewModel = viewModel
        
        func dynamicBinding() {
            self.viewModel?.dynamicBinding {
                self.view?.viewModel = viewModel
            }
        }; dynamicBinding()
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;MVPæ¨¡å¼è¿˜æ˜¯æœ‰å¿…è¦è¯¦ç»†çš„è¯´æ˜ä¸€ä¸‹çš„, æˆ‘ä»¬å¯¹äºModel, View, ViewModel, ä¹Ÿå°±æ˜¯ä¹‹å‰çš„MVVMå¯¹åº”çš„å®šä¹‰åè®®, åè®®åœ¨Javaä¸­ä¹Ÿå«æ¥å£, å°±æ˜¯åˆ¶å®šä¸€å¥—å¤§å®¶éƒ½è¯¥éµå®ˆçš„è§„èŒƒ. å°†MVVMå…¨éƒ¨æŠ½è±¡åŒ–å°±æ˜¯Presenterå±‚çš„ä¸»è¦èŒè´£.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å¯¹åº”ä¿®æ”¹ä»£ç , ä½¿å…¶éµå®ˆPresenterå®šä¹‰çš„åè®®.&lt;/p&gt;

&lt;p&gt;Model.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class Model: NSObject, ModelInterface { //update
    
    var text : String = &quot;&quot;
    var detailText : String = &quot;&quot;
    var imageUrl : String = &quot;&quot;
    
    init(dict : [String : Any]) {
        super.init()
        setValuesForKeys(dict)
    }
    
    override func setValue(_ value: Any?, forUndefinedKey key: String) {}
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;View.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class View: UIView, ViewInterface { //update
    
    var value: ViewModelInterface? //update
    var viewModel: ViewModelInterface? { //update
        
        get { return value }
        set {
            value = newValue
            tableView.reloadData()
        }
    }
    
    fileprivate lazy var tableView: UITableView = { [weak self] in
        var tableView = UITableView(frame: self!.bounds, style: .plain)
        tableView.dataSource = self
        tableView.delegate = self
        return tableView
    }()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        addSubview(tableView)
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
}

extension View: UITableViewDataSource {
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&amp;gt; Int {
        return viewModel?.models.count ?? 0
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&amp;gt; UITableViewCell {
        
        let identifier = &quot;identifier&quot;
        let model: ModelInterface? = viewModel?.models[indexPath.row] //update
        let cell = tableView.dequeueReusableCell(withIdentifier: identifier) ?? UITableViewCell(style: .subtitle, reuseIdentifier: identifier)
        cell.textLabel?.text = model?.text
        cell.detailTextLabel?.text = model?.detailText
        cell.imageView?.loadUrl(imageUrl: model?.imageUrl)
        return cell
    }
}

extension View: UITableViewDelegate {
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&amp;gt; CGFloat {
        return 100
    }
    
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
    }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ViewModel.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class ViewModel: ViewModelInterface { //update
    lazy var models: [ModelInterface] = [ModelInterface]() //update
}

extension ViewModel {
    
    func dynamicBinding(finishedCallback : @escaping () -&amp;gt; ()) {
        
        Http.requestData(.get, URLString: &quot;http://localhost:3001/api/J1/getJ1List&quot;) { (response) in
            guard let result = response as? [String : Any] else { return }
            guard let data:[String : Any] = result[&quot;data&quot;] as? [String : Any] else { return }
            guard let models:[[String : Any]] = data[&quot;models&quot;] as? [[String : Any]] else { return }
            
            self.models.removeAll()
            for dict in models {
                self.models.append(Model(dict: dict))
            }
            
            finishedCallback()
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Controller.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
class Controller: UIViewController {

    fileprivate lazy var viewModel: ViewModel = ViewModel()
    fileprivate lazy var presenter: Presenter = Presenter() //update
    fileprivate lazy var baseView: View = { [weak self] in
        return View(frame: self!.view.bounds)
    }()
    
    override func loadView() {
        super.loadView()
        title = &quot;J1&quot;
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupView()
        adapterView()
    }
}

extension Controller {
    
    fileprivate func setupView() {
        view.addSubview(baseView)
    }
    

    fileprivate func adapterView() {
        presenter.adapter(viewModel: viewModel, view: baseView) //update
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æœ€åæˆ‘ä»¬åœ¨Controllerä¸­å¼•å…¥Presenter, å¹¶å¯¹Viewå’ŒViewModelè¿›è¡Œé€‚é….&lt;/p&gt;

&lt;p&gt;è¿è¡Œä¸€ä¸‹, å’Œä¹‹å‰ä¸€æ ·æ²¡æœ‰ä»€ä¹ˆå¼‚å¸¸, ä½†ä»£ç ä¹‹é—´å·²ç»å®Œå…¨çš„é›¶è€¦åˆäº†, åªè¦éµå®ˆPresenterå†…æ‰€å®šä¹‰çš„åè®®, æ›¿æ¢æ‰ä»»æ„ä¸€ä¸ªéƒ¨ä»¶, ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜. è¿™ç§ä»£ç è®¾è®¡å°±èƒ½å¤Ÿè½»æ¾çš„å®ç°ç»„ä»¶åŒ–äº†.&lt;/p&gt;

&lt;p&gt;ä½†Presenterä»…ä»…æ˜¯è´Ÿè´£è¿™ç‚¹å·¥ä½œå—? å…¶å®æˆ‘ä»¬å¯ä»¥å°†Viewä¸­çš„é€»è¾‘ä¹Ÿé€šè¿‡åè®®çš„å½¢å¼æ¥å…¥è¿›æ¥, å…·ä½“å¦‚ä½•å®ç°, ä¸æ€¥, æˆ‘ä»¬å…ˆæ„å»ºä¸€ä¸ªå‰ç«¯çš„é¡¹ç›®å§!&lt;/p&gt;

&lt;p&gt;å¯¹äºå‰ç«¯, æˆ‘ä½¿ç”¨çš„æ¡†æ¶æ˜¯å°¤é›¨æºªå¤§ç¥çš„&lt;a href=&quot;https://vuejs.org/&quot;&gt;Vue&lt;/a&gt;, å¯¹äºä¸ºä»€ä¹ˆä½¿ç”¨Vueè€Œä¸ä½¿ç”¨Googleçš„Angluar, æˆ–æ˜¯Facebookçš„React, å“.. å°±æ˜¯ä»»æ€§, éšä¾¿â€¦&lt;/p&gt;

&lt;p&gt;å’Œä¹‹å‰çš„Koaä¸€æ ·, æˆ‘ä»¬ä¹Ÿæ‰¾ä¸€ä¸ªç”Ÿæˆå™¨å§, å¥½åœ¨Vueä¸‰ä»¶å¥—ä¸­å°±æœ‰ç”Ÿæˆå™¨cli, å¥½å§ä¸“ä¸šåè¯è„šæ‰‹æ¶ - - , æˆ‘ä»¬å°±é€šè¿‡å®ƒæ¥å¿«é€Ÿæ„å»ºå‰ç«¯å·¥ç¨‹å§!&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;$ npm install webpack -g&lt;/li&gt;
  &lt;li&gt;$ npm install vue-cli -g&lt;/li&gt;
  &lt;li&gt;cd ç›®å½• $ vue init webpack RouterPattern&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;? Project name routerpattern
? Project description A Vue.js project
? Author zhushuangquan &amp;lt;zhushuangquan@j1.com&amp;gt;
? Vue build standalone
? Install vue-router? Yes
? Use ESLint to lint your code? Yes
? Pick an ESLint preset Standard
? Setup unit tests with Karma + Mocha? Yes
? Setup e2e tests with Nightwatch? Yes

   vue-cli Â· Generated &quot;RouterPattern&quot;.

   To get started:
   
     cd RouterPattern
     npm install
     npm run dev
   
   Documentation can be found at https://vuejs-templates.github.io/webpack

// webpackçš„é¡¹ç›®ä¸èƒ½ç”¨å¤§å†™å­—æ¯, æ‰€ä»¥æˆ‘ä»¬éƒ½æ”¹ä¸ºå°å†™.

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â”œâ”€â”€ README.md
â”œâ”€â”€ build
â”‚Â Â  â”œâ”€â”€ build.js
â”‚Â Â  â”œâ”€â”€ check-versions.js
â”‚Â Â  â”œâ”€â”€ dev-client.js
â”‚Â Â  â”œâ”€â”€ dev-server.js
â”‚Â Â  â”œâ”€â”€ utils.js
â”‚Â Â  â”œâ”€â”€ vue-loader.conf.js
â”‚Â Â  â”œâ”€â”€ webpack.base.conf.js
â”‚Â Â  â”œâ”€â”€ webpack.dev.conf.js
â”‚Â Â  â””â”€â”€ webpack.prod.conf.js
â”œâ”€â”€ config
â”‚Â Â  â”œâ”€â”€ dev.env.js
â”‚Â Â  â”œâ”€â”€ index.js
â”‚Â Â  â””â”€â”€ prod.env.js
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ src
â”‚Â Â  â”œâ”€â”€ App.vue
â”‚Â Â  â”œâ”€â”€ assets
â”‚Â Â  â”‚Â Â  â””â”€â”€ logo.png
â”‚Â Â  â”œâ”€â”€ components
â”‚Â Â  â”‚Â Â  â””â”€â”€ Hello.vue
â”‚Â Â  â”œâ”€â”€ main.js
â”‚Â Â  â””â”€â”€ router
â”‚Â Â      â””â”€â”€ index.js
â””â”€â”€ static

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ç»ˆç«¯æ‰§è¡Œ $ npm install  $ npm run dev ååœ¨localhost:8080 ä¸Šå°±èƒ½çœ‹åˆ°æ¬¢è¿é¡µé¢äº†.&lt;/p&gt;

&lt;p&gt;å‰ç«¯çš„éƒ¨åˆ†æˆ‘ä»¬å°±å…ˆåˆ°è¿™é‡Œ, æˆ‘ä»¬å›åˆ°ç§»åŠ¨ç«¯æ¥, æœ‰äº†Webé¡µé¢, å¯¹åº”çš„æˆ‘ä»¬å°±éœ€è¦åˆ›å»ºWebViewäº†.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import WebKit

class WebViewController: UIViewController {
    
    fileprivate lazy var configuretion: WKWebViewConfiguration = { [weak self] in
        let configuretion = WKWebViewConfiguration()
        return configuretion
    }()
    
    fileprivate lazy var webView: WKWebView = { [weak self] in
        let webView = WKWebView(frame: self!.view.bounds)
        webView.navigationDelegate = self
        webView.uiDelegate = self
        return webView
    }()
    
    fileprivate lazy var progressView: UIProgressView = {
        let progressView = UIProgressView(frame: CGRect(x: 0, y: 65, width: self.view.bounds.size.width, height: 2))
        progressView.trackTintColor = .clear
        return progressView
    }()
    
    fileprivate var absoluteUrl = &quot;&quot;
    
    init (_ url: String) {
        super.init(nibName: nil, bundle: nil)
        absoluteUrl = url.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed) ?? &quot;&quot;
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        view.addSubview(webView)
        view.addSubview(progressView)
        
        func loadRequest() {
            var request = URLRequest(url: URL(string: absoluteUrl)!)
            request.addValue(&quot;skey=skeyValue&quot;, forHTTPHeaderField: &quot;Cookie&quot;)
            webView.addObserver(self, forKeyPath: &quot;estimatedProgress&quot;, options: [.new, .old], context: nil)
            webView.load(request)
        }; loadRequest()
    }
    
    override func observeValue(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey : Any]?, context: UnsafeMutableRawPointer?) {
        
        if keyPath == &quot;estimatedProgress&quot; {
            progressView.alpha = 1.0
            progressView.setProgress(Float(webView.estimatedProgress), animated: true)
            if webView.estimatedProgress &amp;gt;= 1.0 {
                UIView.animate(withDuration: 0.25, delay: 0.25, options: [.curveEaseOut], animations: {
                    self.progressView.alpha = 0.0
                    }, completion: { (finished) in
                        self.progressView.setProgress(0.0, animated: true)
                })
            }
        }
    }
    
    deinit {
        webView.removeObserver(self, forKeyPath: &quot;estimatedProgress&quot;)
    }
}

extension WebViewController: WKNavigationDelegate {
    
    func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) {
        title = webView.title
    }
}

extension WebViewController: WKUIDelegate {
    
    func webView(_ webView: WKWebView, runJavaScriptAlertPanelWithMessage message: String, initiatedByFrame frame: WKFrameInfo, completionHandler: @escaping () -&amp;gt; Void) {
        
        let alertViewController = UIAlertController(title: nil, message: message, preferredStyle: .alert)
        alertViewController.addAction(UIAlertAction(title: &quot;ç¡®å®š&quot;, style: .default, handler: { (action) in
            completionHandler()
        }))
        
        present(alertViewController, animated: false, completion: nil)
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ä¹‹å‰çš„UIWebViewçš„ç®€å•äº¤äº’å·²ç»æœ‰è®²è§£, è¿™æ¬¡å°±ä½¿ç”¨æœ€æ–°çš„WKWebViewå§. ä»£ç æ²¡ä»€ä¹ˆè¯´çš„, åªä¸è¿‡WKçš„å†…æ ¸ç›¸åŒ, ä¸JSäº¤äº’æ›´åŠ æ–¹ä¾¿äº†, è¿™ä¸ªæˆ‘ä»¬ä¸‹æ¬¡å†è°ˆ.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ç‚¹å‡»cellè®©å®ƒpushåˆ°åˆšæ‰vueçš„å±•ç¤ºé¡µ, åœ¨Viewä¸­æ‹¿åˆ°å½“å‰æ§åˆ¶å™¨ä¸æ–¹ä¾¿, æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡æ¥ä¿å­˜å½“å‰æ§åˆ¶å™¨.&lt;/p&gt;

&lt;p&gt;ViewController.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;var currentController: ViewController?

class ViewController: UIViewController {
    
    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)
        currentController = self
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å†è®©Controllerå’ŒWebViewControllerç»§æ‰¿ä¸ViewController, è¿™æ ·åœ¨å“ªé‡Œéƒ½èƒ½æ‹¿åˆ°å½“å‰æ§åˆ¶å™¨äº†.&lt;/p&gt;

&lt;p&gt;View.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
        currentController?.navigationController?.pushViewController(WebViewController(&quot;http://localhost:8080/&quot;), animated: true)
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿè·³è½¬åˆ°åˆšæ‰Vueç”Ÿæˆçš„é¡µé¢äº†, ä½†æ˜¯è¿™ç§è·³è½¬é€»è¾‘å†™åœ¨Viewä¸­, ä¸æ˜¯å¾ˆå¥½ç»´æŠ¤, è¿™æ—¶Presenter, å°±èƒ½å¤Ÿå®è¡Œå®ƒçš„ç¬¬äºŒä¸ªç”¨é€”äº† â€“ ç»Ÿç­¹ä¸šåŠ¡é€»è¾‘.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨Viewä¸­å®šä¹‰æ“ä½œåè®®: ViewOperation&lt;/p&gt;

&lt;p&gt;View.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
protocol ViewOperation { //update
    mutating func pushTo() -&amp;gt; Void
}

class View: UIView, ViewInterface {
    
    var operation: ViewOperation? //update
    var value: ViewModelInterface?
    var viewModel: ViewModelInterface? {
        
        get { return value }
        set {
            value = newValue
            tableView.reloadData()
        }
    }
    
    fileprivate lazy var tableView: UITableView = { [weak self] in
        var tableView = UITableView(frame: self!.bounds, style: .plain)
        tableView.dataSource = self
        tableView.delegate = self
        return tableView
        }()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        addSubview(tableView)
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
}

extension View: UITableViewDataSource {
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&amp;gt; Int {
        return viewModel?.models.count ?? 0
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&amp;gt; UITableViewCell {
        
        let identifier = &quot;identifier&quot;
        let model: ModelInterface? = viewModel?.models[indexPath.row]
        let cell = tableView.dequeueReusableCell(withIdentifier: identifier) ?? UITableViewCell(style: .subtitle, reuseIdentifier: identifier)
        cell.textLabel?.text = model?.text
        cell.detailTextLabel?.text = model?.detailText
        cell.imageView?.loadUrl(imageUrl: model?.imageUrl)
        return cell
    }
}

extension View: UITableViewDelegate {
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&amp;gt; CGFloat {
        return 100
    }
    
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
        operation?.pushTo() //update
    }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨Presenterä¸­è¿›è¡Œå®ç°&lt;/p&gt;

&lt;p&gt;Presenter.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
extension Presenter: ViewOperation {
    
    func pushTo() {
        currentController?.navigationController?.pushViewController(WebViewController(&quot;http://localhost:8080/&quot;), animated: true)
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬æŠŠä¸šåŠ¡é€»è¾‘éƒ½æŠ½è±¡å‡ºæ¥äº†, Presenterä¸­æ—¢èƒ½æ‹¿åˆ°æ•°æ®åˆèƒ½æ‹¿åˆ°è§†å›¾è¿˜èƒ½è¿›è¡Œä¸šåŠ¡æ“ä½œ, ç®€ç›´å¤ªæ£’äº†, è¿™å°±æ˜¯æˆ‘å‘ä½ æ¨èçš„MVPæ¨¡å¼!&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 11 Apr 2017 15:06:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AFVue.js%E5%B9%B6%E5%8D%87%E7%BA%A7%E8%87%B3MVP/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AFVue.js%E5%B9%B6%E5%8D%87%E7%BA%A7%E8%87%B3MVP/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
      <item>
        <title>Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;å›é¡¾ä¸ŠæœŸçš„å†…å®¹, æˆ‘ä»¬é€šè¿‡Koaæ­å»ºæœåŠ¡å™¨å®ç°äº†ç§»åŠ¨ç«¯ä¸åç«¯çš„äº¤äº’, ä½¿å¾—appä¸å†åªæ˜¯ä¸ªå£³å­,  é€šè¿‡CocoaPodsé›†æˆäº†AlamofireæˆåŠŸè°ƒç”¨åç«¯çš„API, å®ç°äº†æœ€ç²¾ç®€ä¹Ÿæ˜¯æœ€ç»å…¸çš„MVCæ¶æ„, ä»Šå¤©æˆ‘ä»¬æ¥è¯´è¯´ä¹‹å‰å¤§çƒ­çš„MVVMæ¶æ„.ä»£ç è¯¦è§:&lt;a href=&quot;coderZsq.target.swift&quot;&gt;github&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3866097366648136.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h6 id=&quot;å‚è€ƒé“¾æ¥&quot;&gt;å‚è€ƒé“¾æ¥:&lt;/h6&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.jianshu.com/p/5a03995a6ce1&quot;&gt;Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹å†…å®¹åœ¨ä¸Šè¿°æ–‡ç« åŸºç¡€ä¸Šè¿›è¡Œ, è¯·äº‹å…ˆæŸ¥é˜….&lt;/p&gt;

&lt;p&gt;å…¶å®ç°åœ¨iOSå¼€å‘è¿˜æ˜¯åœ¨Objective-Cçš„å¤§ç¯å¢ƒä¸‹, è®©æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨MVVMè¿™ç§æ¶æ„, å…¶å®æˆ‘æ˜¯æ‹’ç»çš„, å› ä¸ºä¸ªäººè§‰å¾—OCçš„ä»£ç è®¾è®¡æ˜¯ä¸é€‚åˆä½¿ç”¨MVVMæ¡†æ¶çš„, å…·ä½“åŸå› å°±æ˜¯ â€œä¸‘â€, ä¸€ä¸ªå­—ä»£è¡¨äº†æ‰€æœ‰çš„è§‚ç‚¹. ä½†ä½œä¸ºæŠ€æœ¯ç ”è®¨, MVVMçš„æ€æƒ³è¿˜æ˜¯æœ‰å‘å¤§å®¶æ™®åŠçš„å¿…è¦çš„.&lt;/p&gt;

&lt;p&gt;MVVM&lt;/p&gt;

&lt;p&gt;MVVMæ˜¯æŒ‡ Model, View, ViewModel, è¿™é‡Œçš„ViewModelä»£æ›¿äº†åŸå…ˆControllerçš„éƒ¨åˆ†å·¥ä½œ, MVVMçš„æ¦‚å¿µæœ€åˆæ˜¯ä»å‰ç«¯å¼€å§‹çš„, ä»¥åé¢ä¼šè¯´åˆ°çš„Vueä¸¾ä¾‹, æ¯ä¸€ä¸ªVueæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªViewModel, å®ç°äº†åŠ¨æ€ç»‘å®šçš„åŠŸèƒ½, é€šä¿—çš„è¯´å°±æ˜¯å½“æ•°æ®å‘ç”Ÿæ”¹å˜, è§†å›¾ç«‹å³æ”¹å˜, ç›¸åå½“ç”¨æˆ·æ“ä½œè§†å›¾ä¹ŸåŒæ—¶æ“ä½œäº†æ•°æ®. ViewModelä»åå­—ä¸Šæ¥çœ‹å°±æ˜¯Viewå’ŒModelçš„ä¸­é—´å±‚.&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç§»åŠ¨ç«¯æ€ä¹ˆå®ç°MVVMæ¶æ„:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â”œâ”€â”€ Controller.swift
â”œâ”€â”€ Model.swift
â”œâ”€â”€ View.swift
â””â”€â”€ ViewModel.swift

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å…ˆåœ¨é¡¹ç›®ç»“æ„ä¸‹æ·»åŠ ViewModel.swift, å°†ä¹‹å‰åœ¨Controllerä¸­çš„ç½‘ç»œè¯·æ±‚ä»£ç ç§»æ¤åˆ°VMä¸­:&lt;/p&gt;

&lt;p&gt;ViewModel.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class ViewModel {
    lazy var models: [Model] = [Model]()
}

extension ViewModel {
    
    func dynamicBinding(finishedCallback : @escaping () -&amp;gt; ()) {
        
        Http.requestData(.get, URLString: &quot;http://localhost:3001/api/J1/getJ1List&quot;) { (response) in
            guard let result = response as? [String : Any] else { return }
            guard let data:[String : Any] = result[&quot;data&quot;] as? [String : Any] else { return }
            guard let models:[[String : Any]] = data[&quot;models&quot;] as? [[String : Any]] else { return }
            
            self.models.removeAll()
            for dict in models {
                self.models.append(Model(dict: dict))
            }
            
            finishedCallback()
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å°è´´å£«:
Swiftä¸­çš„Classå¯ä»¥ä¸ç”¨ç»§æ‰¿ç›´æ¥å®šä¹‰, é™ä½å¼€é”€.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å¯¹åº”ä¿®æ”¹å…¶ä»–ä»£ç å¦‚ä¸‹:&lt;/p&gt;

&lt;p&gt;View.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
class View: UIView {
    
    var viewModel: ViewModel? { //update
        
        didSet {
            tableView.reloadData()
        }
    }
    
    fileprivate lazy var tableView: UITableView = { [weak self] in
        var tableView = UITableView(frame: self!.bounds, style: .plain)
        tableView.dataSource = self
        return tableView
        }()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        addSubview(tableView)
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
}

extension View: UITableViewDataSource {
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&amp;gt; Int {
        return viewModel?.models.count ?? 0 //update
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&amp;gt; UITableViewCell {
        
        let identifier = &quot;identifier&quot;
        let model: Model? = viewModel?.models[indexPath.row] //update
        let cell = tableView.dequeueReusableCell(withIdentifier: identifier) ?? UITableViewCell(style: .subtitle, reuseIdentifier: identifier)
        cell.textLabel?.text = model?.text
        cell.detailTextLabel?.text = model?.detailText
        return cell
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Controller.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
class Controller: UIViewController {

    fileprivate lazy var viewModel: ViewModel = ViewModel() //update
    fileprivate lazy var baseView: View = { [weak self] in
        return View(frame: self!.view.bounds)
    }()
    
    override func loadView() {
        super.loadView()
        title = &quot;J1&quot;
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupView()
        adapterView()
    }
}

extension Controller {
    
    fileprivate func setupView() {
        view.addSubview(baseView)
    }
    

    fileprivate func adapterView() { //update
        viewModel.dynamicBinding {
            self.baseView.viewModel = self.viewModel
        }
    }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬é€šè¿‡å°†ç½‘ç»œè¯·æ±‚å°è£…åˆ°ViewModelä¸­å®ç°äº†ä»£ç åˆ†å±‚, è®¾è®¡ä¹Ÿæ›´ä¸ºç®€æ´. ä½†æ˜¯æˆ‘ä»¬ç°åœ¨çš„ç”¨æˆ·ç•Œé¢å¥½Lowå•Š, æ˜¯ä¸æ˜¯åº”è¯¥åšç‚¹ä»€ä¹ˆ? å¯¹äº†, æˆ‘ä»¬ç»™ç•Œé¢é‡Œæ·»åŠ ç‚¹å›¾ç‰‡å§!&lt;/p&gt;

&lt;p&gt;å½“ç„¶å›¾ç‰‡æˆ‘ä»¬ä¹Ÿæ˜¯é€šè¿‡åç«¯è·å–, æˆ‘ä»¬åœ¨åç«¯ç›®å½•ä¸­æ·»åŠ image.jsæ–‡ä»¶æ¥å®ç°å›¾ç‰‡æœåŠ¡å™¨.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â””â”€â”€ public
  â””â”€â”€ images
	â””â”€â”€ image.js

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;image.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
const http = require('http');
const fs = require('fs');

http.createServer((req, res) =&amp;gt; {
    console.log(req.url);

    let path = '..' + decodeURI(req.url);
    fs.readFile(path, 'binary', (err, file) =&amp;gt; {
        if (err) {
            // console.log(err);
            return;
        } else {
            res.writeHead(200, {
                'Content-Type': 'image/png'
            });
            res.write(file, 'binary');
            res.end();
            return;
        }
    })
}).listen(3002);
console.log('port = 3002');

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨çš„æ˜¯åŸç”Ÿçš„Node.jsæ­å»ºçš„å›¾ç‰‡æœåŠ¡å™¨, ç›‘å¬3002ç«¯å£.&lt;/p&gt;

&lt;p&gt;è¿™é‡Œæˆ‘ä»¬æ¥è¯´è¯´æœåŠ¡å™¨æ˜¯å¦‚ä½•å®ç°æƒ³å®¢æˆ·ç«¯ä¼ é€æ•°æ®çš„, æˆ‘ä»¬ç°åœ¨åˆ†ä¸ºAPIæœåŠ¡å™¨: 3001å’Œå›¾ç‰‡æœåŠ¡å™¨: 3002. APIæœåŠ¡å™¨ä¼ è¾“çš„ç±»å‹æ˜¯Content-Type : application/jsonè¿™ç§æ ¼å¼çš„, è€Œå›¾ç‰‡æœåŠ¡å™¨è¿”å›çš„æ˜¯äºŒè¿›åˆ¶çš„æ ¼å¼Content-Typeâ€™: â€˜image/png. åŸç†å°±æ˜¯å°†æ–‡æœ¬æˆ–æ•°æ®å†™åœ¨Bodyä¸Š.&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬cd åˆ°ç›®å½•ä¸­ é€šè¿‡nodeå‘½ä»¤ $ node image.js æ¥æ‰§è¡Œjsè„šæœ¬æ–‡ä»¶. çœ‹åˆ°port = 3002æ‰“å°åœ¨ç»ˆç«¯ä¸Šè¯´æ˜, æœåŠ¡å¯åŠ¨æˆåŠŸ.&lt;/p&gt;

&lt;p&gt;æœ‰å›¾ç‰‡æœåŠ¡å™¨, æ²¡æœ‰å›¾ç‰‡æ€ä¹ˆè¡Œ? æˆ‘ä»¬åœ¨imagesä¸­æ·»åŠ å›¾ç‰‡æ–‡ä»¶. æ·»åŠ å®Œååœ¨æµè§ˆå™¨ä¸­è¾“å…¥: http://localhost:3002/images/J1/å…³äºå¥ä¸€@2x.png, å°±èƒ½å¤Ÿè®¿é—®åˆ°æœåŠ¡å™¨çš„å›¾ç‰‡äº†.&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°†å›¾ç‰‡çš„URLåœ°å€é€šè¿‡APIçš„å½¢å¼è¿”å›ç»™ç§»åŠ¨ç«¯è°ƒç”¨.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â””â”€â”€ app
  â””â”€â”€ controllers
	â””â”€â”€ J1.js

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;J1.js&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;exports.getJ1List = async(ctx, next) =&amp;gt; {

    ctx.body = {
        models: [{
            text: 'æˆ‘çš„è´¦æˆ·',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;æˆ‘çš„è´¦æˆ·&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/æˆ‘çš„è´¦æˆ·@2x.png&quot;
        }, {
            text: 'æˆ‘çš„ä¼˜æƒ åˆ¸',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;æˆ‘çš„ä¼˜æƒ åˆ¸&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/æˆ‘çš„ä¼˜æƒ åˆ¸@2x.png&quot;
        }, {
            text: 'æ”¶è´§åœ°å€',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;æ”¶è´§åœ°å€&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/æ”¶è´§åœ°å€@2x.png&quot;
        }, {
            text: 'åœ¨çº¿å®¢æœ',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;åœ¨çº¿å®¢æœ&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/åœ¨çº¿å®¢æœ@2x.png&quot;
        }, {
            text: 'ç”¨è¯æé†’',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;ç”¨è¯æé†’&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/ç”¨è¯æé†’@2x.png&quot;
        }, {
            text: 'è¯æŸ¥æŸ¥',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;è¯æŸ¥æŸ¥&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/è¯æŸ¥æŸ¥@2x.png&quot;
        }, {
            text: 'ç–¾ç—…ç™¾ç§‘',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;ç–¾ç—…ç™¾ç§‘&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/ç–¾ç—…ç™¾ç§‘@2x.png&quot;
        }, {
            text: 'è¯å“ç™¾ç§‘',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;è¯å“ç™¾ç§‘&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/è¯å“ç™¾ç§‘@2x.png&quot;
        }, {
            text: 'å¥ä¸€å’¨è¯¢',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;å¥ä¸€å’¨è¯¢&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/å¥ä¸€å’¨è¯¢@2x.png&quot;
        }, {
            text: 'å¸®åŠ©ä¸­å¿ƒ',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;å¸®åŠ©ä¸­å¿ƒ&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/å¸®åŠ©ä¸­å¿ƒ@2x.png&quot;
        }, {
            text: 'ç‚¹èµ/åæ§½',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;ç‚¹èµ/åæ§½&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/ç‚¹èµ:åæ§½@2x.png&quot;
        }, {
            text: 'å…³äºå¥ä¸€',
            detailText: &quot;æ¬¢è¿è¿›å…¥=&amp;gt;å…³äºå¥ä¸€&quot;,
            imageUrl: &quot;http://localhost:3002/images/J1/å…³äºå¥ä¸€@2x.png&quot;
        }]
    }
}


&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åœ¨æµè§ˆå™¨è®¿é—®æ¥å£ http://localhost:3001/api/J1/getJ1List&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;success&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;models&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æˆ‘çš„è´¦æˆ·&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;æˆ‘çš„è´¦æˆ·&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/æˆ‘çš„è´¦æˆ·@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æˆ‘çš„ä¼˜æƒ åˆ¸&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;æˆ‘çš„ä¼˜æƒ åˆ¸&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/æˆ‘çš„ä¼˜æƒ åˆ¸@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ”¶è´§åœ°å€&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;æ”¶è´§åœ°å€&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/æ”¶è´§åœ°å€@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;åœ¨çº¿å®¢æœ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;åœ¨çº¿å®¢æœ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/åœ¨çº¿å®¢æœ@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ç”¨è¯æé†’&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;ç”¨è¯æé†’&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/ç”¨è¯æé†’@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è¯æŸ¥æŸ¥&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;è¯æŸ¥æŸ¥&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/è¯æŸ¥æŸ¥@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ç–¾ç—…ç™¾ç§‘&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;ç–¾ç—…ç™¾ç§‘&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/ç–¾ç—…ç™¾ç§‘@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è¯å“ç™¾ç§‘&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;è¯å“ç™¾ç§‘&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/è¯å“ç™¾ç§‘@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å¥ä¸€å’¨è¯¢&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;å¥ä¸€å’¨è¯¢&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/å¥ä¸€å’¨è¯¢@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å¸®åŠ©ä¸­å¿ƒ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;å¸®åŠ©ä¸­å¿ƒ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/å¸®åŠ©ä¸­å¿ƒ@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ç‚¹èµ/åæ§½&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;ç‚¹èµ/åæ§½&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/ç‚¹èµ:åæ§½@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å…³äºå¥ä¸€&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;detailText&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¬¢è¿è¿›å…¥=&amp;gt;å…³äºå¥ä¸€&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;imageUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://localhost:3002/images/J1/å…³äºå¥ä¸€@2x.png&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ•°æ®è¿”å›æ²¡æœ‰é—®é¢˜äº†, æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä»ç§»åŠ¨ç«¯è®¿é—®æœåŠ¡å™¨å›¾ç‰‡, è¿™é‡Œä½¿ç”¨å–µç¥çš„Kingfisheræ¥è¯·æ±‚å›¾ç‰‡, ä¹‹å‰å·²ç»é€šè¿‡Podså¯¼å…¥åˆ°é¡¹ç›®ä¸­äº†.&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¡†æ¶çš„æ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦åœ¨å¤–é¢å†å°è£…ä¸€å±‚, æˆ‘ä»¬åˆ›å»ºImage.swift&lt;/p&gt;

&lt;p&gt;Image.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import Kingfisher

extension UIImageView {
    
    func loadUrl(imageUrl: String?, placeholder: String = &quot;placeholder&quot;) {
        self.kf.setImage(with: URL(string: imageUrl?.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed) ?? &quot;&quot;), placeholder: UIImage(named: placeholder), options: nil, progressBlock: nil, completionHandler: nil)
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ¥ä¸‹æ¥åœ¨Modelå’ŒViewä¸­æ·»åŠ imageUrlå­—æ®µå¹¶ä¿®æ”¹å¦‚ä¸‹:&lt;/p&gt;

&lt;p&gt;Model.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class Model: NSObject {

    var text : String = &quot;&quot;
    var detailText : String = &quot;&quot;
    var imageUrl : String = &quot;&quot; //update

    init(dict : [String : Any]) {
        super.init()
        setValuesForKeys(dict)
    }
    
    override func setValue(_ value: Any?, forUndefinedKey key: String) {}
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;View.swift&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;class View: UIView {
    
    var viewModel: ViewModel? {
        
        didSet {
            tableView.reloadData()
        }
    }
    
    fileprivate lazy var tableView: UITableView = { [weak self] in
        var tableView = UITableView(frame: self!.bounds, style: .plain)
        tableView.dataSource = self
        tableView.delegate = self //update
        return tableView
    }()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        addSubview(tableView)
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError(&quot;init(coder:) has not been implemented&quot;)
    }
}

extension View: UITableViewDataSource {
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&amp;gt; Int {
        return viewModel?.models.count ?? 0
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&amp;gt; UITableViewCell {
        
        let identifier = &quot;identifier&quot;
        let model: Model? = viewModel?.models[indexPath.row]
        let cell = tableView.dequeueReusableCell(withIdentifier: identifier) ?? UITableViewCell(style: .subtitle, reuseIdentifier: identifier)
        cell.textLabel?.text = model?.text
        cell.detailTextLabel?.text = model?.detailText
        cell.imageView?.loadUrl(imageUrl: model?.imageUrl) //update
        return cell
    }
}

extension View: UITableViewDelegate { //update
    
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&amp;gt; CGFloat {
        return 100
    }
    
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        tableView.deselectRow(at: indexPath, animated: true)
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯ä¸ªäººç†è§£çš„MVVM, ä¹Ÿè¯´å‡ºä½ å¯¹äºMVVMçš„æƒ³æ³•, æˆ‘ä»¬ä¸€èµ·æ¢è®¨!&lt;/p&gt;

&lt;p&gt;About:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/coderZsq/coderZsq.target.swift&quot;&gt;ğŸŒŸ æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸÂ Â»&amp;gt; å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢Â Â»&amp;gt; ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜ŸÂ Â»&amp;gt; æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµÂ Â»&amp;gt; å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº«Â Â»&amp;gt; ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! &lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 11 Apr 2017 12:42:00 +0800</pubDate>
        <link>http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%90%8E%E7%AB%AFKoa.js%E5%B9%B6%E8%BF%87%E5%BA%A6%E5%88%B0MVVM/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/Hybird-%E6%90%AD%E5%BB%BA%E5%90%8E%E7%AB%AFKoa.js%E5%B9%B6%E8%BF%87%E5%BA%A6%E5%88%B0MVVM/</guid>
        
        <category>ç§»åŠ¨å¼€å‘</category>
        
        
      </item>
    
  </channel>
</rss>
