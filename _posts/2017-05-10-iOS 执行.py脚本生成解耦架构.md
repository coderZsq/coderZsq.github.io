---
layout: post
title: iOS 执行.py脚本生成解耦架构
date: 2017.05.10 16:50
tag: 移动开发
---

> 刚刚学习完SpriteKit的第一章, 项目的需求就压过来了, 诶, 时间都去哪啦, 接着之前的热修复架构, 这次为了更加好的进行代码规范, 我们将之间的架构模式进行模板代码生成, 这里会用到一些简单的python, 没接触过的同学们可以先去了解下, 今天我就将零耦合代码生成工具分享与你.

![](http://upload-images.jianshu.io/upload_images/1229762-6b2c8bed102c297f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

###### 参考链接:

- [Hybird 搭建零耦合架构从MVC开始](http://www.jianshu.com/p/5a03995a6ce1)
- [Hybird 搭建后端Koa.js并过度到MVVM](http://www.jianshu.com/p/846b9f181cb7)
- [Hybird 搭建前端Vue.js并升级至MVP](http://www.jianshu.com/p/8d4a84e3ddaa)
- [Hybird 搭建路由Router实现组件化](http://www.jianshu.com/p/36314d0c0032)
- [Hybird 搭建客户端实时降级架构](http://www.jianshu.com/p/7054a694cfeb)


其实代码生成工具好久之前就想试试学着开发, 一直没有头绪和所谓的契机, 最近在学习算法的时候顺带学了下python, 发现python的写文件的代码之简洁, 再看看OC, 诶... 刚学iOS的时候还觉得OC是最好的语言, 说实话, 现在好久不敲OC, 都有些手生了.

先按之前的架构写出对应OC模板 没看过Swift版的点击 --> [Hybird 搭建客户端实时降级架构](http://www.jianshu.com/p/7054a694cfeb)

### 生成器目录结构
```
├── Template //模板文件
│   ├── ControllerTemplate.h
│   ├── ControllerTemplate.m
│   ├── InterfaceTemplate.h
│   ├── ModelTemplate.h
│   ├── ModelTemplate.m
│   ├── PresenterTemplate.h
│   ├── PresenterTemplate.m
│   ├── ViewModelTemplate.h
│   ├── ViewModelTemplate.m
│   ├── ViewTemplate.h
│   └── ViewTemplate.m
├── builder.py //生成器执行文件
└── config.json //生成器配置文件
```
##### InterfaceTemplate.h
```
#import <UIKit/UIKit.h>

@protocol <#Unit#>ViewOperation <NSObject>
<#ViewOperation#>

@end

@protocol <#Unit#>ModelInterface <NSObject>
<#ModelInterface#>

@end

@protocol <#Unit#>ViewModelInterface <NSObject>

@property (nonatomic,strong) id<<#Unit#>ModelInterface> model;

- (void)initializeWithParameter:(NSDictionary *)parameter finishedCallBack:(void(^)())finishCallBack;
<#ViewModelInterface#>
@end

@protocol <#Unit#>ViewInterface <NSObject>

@property (nonatomic,strong) id<<#Unit#>ViewModelInterface> <#unit#>ViewModel;
@property (nonatomic,strong) id<<#Unit#>ViewOperation> <#unit#>Operation;

@end

```
- InterfaceTemplate 是根据规则指定的一套协议, 用来进行解耦
- ViewOperation view的用户交互方法规则
- ModelInterface model的数据结构的规则
- ViewModelInterface viewModel的数据获取规则
- ViewInterface view的适配器模式
