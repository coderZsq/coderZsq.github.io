---
layout: post
title: iOS ç§»åŠ¨ç«¯æ¶æ„åˆæ¢å¿ƒå¾—
date: 2017.11.23 15:46
tag: ç§»åŠ¨å¼€å‘
---

> æœ¬æ–‡ä½œä¸ºè¿™ä¸€ç³»åˆ—çš„æ”¶å°¾æ€»ç»“, è¯¦ç»†å™è¿°äº†è¿™ä¸ªæ¶æ„å·¥å…·çš„è®¾è®¡æ€è·¯ä»¥åŠä¸€æ­¥æ­¥çš„ä¼˜åŒ–, åœ¨æ­¤ä¹Ÿåˆ†äº«ä¸ä½ , å®Œæ•´`keynote`å¯æŸ¥é˜…[github](https://github.com/coderZsq/coderZsq.project.oc)

![](http://upload-images.jianshu.io/upload_images/1229762-6b2c8bed102c297f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

###### å‚è€ƒé“¾æ¥:

- [Hybird æ­å»ºé›¶è€¦åˆæ¶æ„ä»MVCå¼€å§‹](http://www.jianshu.com/p/5a03995a6ce1)
- [Hybird æ­å»ºåç«¯Koa.jså¹¶è¿‡åº¦åˆ°MVVM](http://www.jianshu.com/p/846b9f181cb7)
- [Hybird æ­å»ºå‰ç«¯Vue.jså¹¶å‡çº§è‡³MVP](http://www.jianshu.com/p/8d4a84e3ddaa)
- [Hybird æ­å»ºè·¯ç”±Routerå®ç°ç»„ä»¶åŒ–](http://www.jianshu.com/p/36314d0c0032)
- [Hybird æ­å»ºå®¢æˆ·ç«¯å®æ—¶é™çº§æ¶æ„](http://www.jianshu.com/p/7054a694cfeb)
- [iOS æ‰§è¡Œ.pyè„šæœ¬ç”Ÿæˆè§£è€¦æ¶æ„](http://www.jianshu.com/p/47d565bf200e)
- [iOS æ‰§è¡Œ.pyè„šæœ¬ç”ŸæˆUIå±‚ç»“æ„](http://www.jianshu.com/p/d15379908582)
- [iOS ç§»åŠ¨ç«¯é¢å‘æ–‡æ¡£å¼€å‘](http://www.jianshu.com/p/b35d06cf189a)
- [iOS ç§»åŠ¨ç«¯ç”Ÿæˆå·¥å…·å¼€å‘](http://www.jianshu.com/p/cb36b36f90dd)

æœ¬æ–‡ä½œä¸ºä»¥ä¸Šæ–‡ç« ç³»åˆ—çš„æ€»ç»“, å¦‚ä½•ä¸€æ­¥ä¸€æ­¥è¿›è¡Œæ€è€ƒæ€»ç»“, å¦‚ä½•å¼€å‘å‡ºé€‚åˆè‡ªå·±çš„é€šç”¨æ¶æ„è®¾è®¡.

#### è®¾è®¡æ€è·¯

![](http://upload-images.jianshu.io/upload_images/1229762-ea7c24d2e3c27b2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¯¹äºæ¶æ„, ç§»åŠ¨ç«¯å¸¸è§çš„æ¶æ„è®¾è®¡åŒ…æ‹¬`MVC`, `MVVM`, `MVP`ç­‰, ä¸Šå›¾ç®€è¦çš„è¯´æ˜äº†å„ç§å¸¸è§çš„æ¶æ„ä¹‹é—´çš„äº¤äº’åŠæ•°æ®ä¼ é€’æ–¹å¼.

![](http://upload-images.jianshu.io/upload_images/1229762-7272787947be81a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¯¹äº`MVC`, `MVVM`, `MVP`è¿™ä¸‰ç§æ¶æ„è®¾è®¡æ¨¡å¼, ç›¸ä¿¡å¤§å®¶ä¸€å®šäº†ç„¶äºå¿ƒ, ç›¸å…³çš„æ–‡ç« ä¹Ÿæ˜¯å¤šå¦‚ç¹æ˜Ÿ, å¯¹äºè¿™äº›å¸¸ç”¨æ¶æ„, æ¯ä¸ªäººéƒ½è‚¯å®šæœ‰æ¯ä¸ªäººçš„ç†è§£, ä½†è¿™æ ·ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜, å°±æ˜¯æå¤§çš„è‡ªç”±åº¦å¯¼è‡´äº†æ²¡æœ‰ä»£ç è§„èŒƒ, å¯¹äºç§»åŠ¨ç«¯æˆ–è€…å‰ç«¯åŠåç«¯æ¥è¯´, å…¶æœ¬è´¨å·¥ä½œå°±æ˜¯æ•°æ®å±‚å’Œå±•ç¤ºå±‚çš„äº¤äº’, å¦‚ä½•å°†æ•°æ®æ­£ç¡®å®‰å…¨é«˜æ•ˆçš„ä¼ è¾“åˆ°å±•ç¤ºå±‚.

è¿™é‡Œçš„æ•°æ®å±‚ä»æ•´ä¸ªé¡¹ç›®æ¥è¯´, å¯ä»¥è¯´æ˜¯åç«¯, ä¹Ÿå°±æ˜¯æœåŠ¡ç«¯, å¯¹äºæœåŠ¡ç«¯å¼€å‘çš„æµç¨‹å°±æ˜¯ä»æ•°æ®åº“è·å–æ•°æ®å¹¶å°†æ•°æ®è¿›è¡Œå„ç§é€»è¾‘è¿‡æ»¤ä½œä¸ºå“åº”è¿”å›ç»™å‰ç«¯ç”¨äºå±•ç¤ºå±‚å±•ç¤º, å¯¹äºjavaä¸ºä¾‹, æˆ‘ä»¬æ™®é€šçš„é¡¹ç›®å°±ä¼šåˆ†ä¸º`controller`, `service`, `dao`, `pojo`, `vo`, `bo`ç­‰å±‚çº§è®¾è®¡, å°±ä¼šå°†ä¸åŒåŠŸèƒ½è¿›è¡ŒæŠ½è±¡, ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç»´æŠ¤.

è€Œä½œä¸ºå±•ç¤ºå±‚çš„å‰ç«¯, ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯, å…¶å®ç§»åŠ¨ç«¯åœ¨æˆ‘æ„Ÿè§‰å…¶å®ä¹Ÿæ˜¯å‰ç«¯çš„ä¸€ä¸ªåˆ†æ”¯, è€Œå‰ç«¯çš„æ¶æ„é€šå¸¸ä¸ºç»„ä»¶åŒ–è®¾è®¡, æ¯ä¸€ä¸ªåŠŸèƒ½`view`å¯¹åº”ä¸€ä¸ªç»„ä»¶, è€Œæ•´ä¸ªé¡µé¢å¯ä»¥é€šè¿‡å¤šä¸ªç»„ä»¶åˆ†ç¦»è¿›è¡Œç»´æŠ¤, å¾ˆé«˜æ•ˆçš„å°†ä¸šåŠ¡ä»£ç å’Œè§†å›¾è¿›è¡Œåˆ†ç¦», ä½¿å¾—ä»£ç æ›´æœ‰è§„èŒƒåŠæ˜“ç»´æŠ¤.

è€Œå¯¹äºç§»åŠ¨ç«¯, ä¸ºä»€ä¹ˆè¦åœ¨`controller`ä¸­å†™é‚£ä¹ˆå¤šä¸çŸ¥æ‰€äº‘çš„ä»£ç ? ä¸ºä»€ä¹ˆä¸€ä¸ªæ§åˆ¶å™¨èƒ½è¶…è¿‡1kè¡Œ? ä¸ºä»€ä¹ˆ`view`çš„é€»è¾‘å›è°ƒä»£ç†è¦å†™åœ¨`controller`ä¸­? ä¸ºä»€ä¹ˆæ§åˆ¶å™¨ä¹‹é—´çš„å‚æ•°ä¼ é€’çš„è€¦åˆæ€§é‚£ä¹ˆå¼º? ä¸ºä»€ä¹ˆç½‘ç»œè¯·æ±‚çš„æ–¹æ³•éšå¤„å¯è§? ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å¤Ÿåƒå‰åç«¯é‚£æ ·æœ‰æ¡ç†çš„æ§åˆ¶æˆ‘ä»¬çš„ä»£ç ? è€Œè®©å…¶åƒè„±ç¼°çš„é‡é©¬éš¾ä»¥é©¾é©­å‘¢?

![](http://upload-images.jianshu.io/upload_images/1229762-98b7db037d14f441.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜, æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸€äº›æ¶æ„è®¾è®¡æ¨¡å¼, æœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯ä»¥`controller`ä¸ºä¸­å¿ƒçš„æŠ½è±¡, å°†æ§åˆ¶å™¨çš„åŠŸèƒ½æŠ½è±¡åˆ°è¯¥å…·ä½“è´Ÿè´£çš„æ¨¡å—, ä»å›¾ä¸Šå¯ä»¥çœ‹åˆ°, `controller`ç»´æŠ¤äº†`presenter`, `viewmodel`, `view`, è€Œ`viewmodel`åˆç»´æŠ¤äº†`model`, å…¶ä¸­çš„`model`ä¹Ÿå¯ä»¥è¯´å°±æ˜¯`javabean`å®Œå…¨çš„çº¯æ•°æ®ç»“æ„, `viewmodel`æ˜¯`model`çš„ä¸Šä¸€å±‚, ç”¨äºæ“ä½œå¯¹åº”çš„æ•°æ®, å¯ä»¥çœ‹åˆ°`controller`å°†ä»£ç ä¸‹å‘è‡³ä¸‹é¢ä¸‰å±‚, ä½¿å¾—å„ä¸ªå±‚çº§å„å¸å…¶èŒ.

![](http://upload-images.jianshu.io/upload_images/1229762-3b1cabac93147e7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

åˆšæ‰æ˜¯ç«™åœ¨`controller`çš„è§†è§’ä¸Šæ¥çœ‹çš„, å¯¹äºæ•°æ®çš„ä¼ è¾“, è¿™æ¬¡æˆ‘ä»¬ç«™åœ¨`presenter`çš„è§†è§’ä¸Šæ¥çœ‹, è¿™ä¸ªè®¾è®¡å°±æ˜¯å°†`viewmodel`ä½œä¸ºä¼ é€’å¯¹è±¡é€šè¿‡`presenter`è¿™ä¸ªä¸­é—´ä»¶ä¼ è¾“è‡³`view`å±‚, è¿™æ ·viewå±‚ä¸ä»…å¯ä»¥æ‹¿åˆ°æ•°æ®, ä¹Ÿå¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œ, æŒæ§æ€§æœ‰æ‰€æé«˜.

![](http://upload-images.jianshu.io/upload_images/1229762-43ef0b18f3f5f1f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

åˆšæ‰æˆ‘ä»¬ç«™åœ¨äº†`controller`å’Œ`presenter`è§†è§’ä¸Šåˆ†æäº†æ¶æ„è®¾è®¡çš„æ€è·¯, ä½†è¿™æ ·å„ä¸ªå±‚çº§çš„è€¦åˆä¼šè¶Šæ¥è¶Šå¤§, ä»è€Œå¯¼è‡´é¡¹ç›®ä»£ç æ— æ³•åˆ†å‰², è¿™æ—¶æƒ³åˆ°äº†åç«¯`controller`å’Œ`service`ä¹‹é—´é€šè¿‡æ¥å£è¿›è¡Œäº¤äº’æ¥é™ä½è€¦åˆ, æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å‚è€ƒè¿™ç§æ–¹æ¡ˆé€šè¿‡ä¸€ä¸ª`protocol`æ–‡æ¡£æ–‡ä»¶æ¥é™ä½å„ä¸ªå±‚çº§ä¹‹é—´çš„è€¦åˆå‘¢, å¦‚å›¾æ‰€ç¤º, å°†é™¤äº†`controller`ä¹‹å¤–çš„å…¶ä»–å±‚çº§è¿›è¡Œè§£è€¦. è¿›è¡Œé«˜åº¦æŠ½è±¡.

![](http://upload-images.jianshu.io/upload_images/1229762-6fa4db1de5f4ff15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸Šé¢æˆ‘ä»¬è§£å†³äº†å„ä¸ªå±‚çº§ä¹‹é—´çš„è€¦åˆ, ä½†æˆ‘ä»¬æ€ä¹ˆè§£å†³æ§åˆ¶å™¨ä¹‹é—´çš„è€¦åˆå‘¢? ç­”æ¡ˆæ˜¯`router`, æˆ‘ä»¬ç«™åœ¨è·¯ç”±çš„è§†è§’ä¸Šçœ‹, å„å¤§æ§åˆ¶å™¨éƒ½æ˜¯ç‹¬ç«‹å­˜åœ¨çš„ä¸ªä½“, å½¼æ­¤ä¹‹é—´çš„äº¤äº’é€šè¿‡è·¯ç”±çš„æ˜ å°„è¿›è¡Œäº¤äº’, è¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿå»é™¤å„å¤§æ§åˆ¶å™¨ä¹‹é—´çš„è€¦åˆäº†. è·¯ç”±è¿™ä¸ªæ€è·¯æœ€å…ˆä¹Ÿæ˜¯åœ¨å‰ç«¯çš„æ¶æ„æ¡†æ¶ä¸­çœ‹åˆ°çš„, åæ¥å°±æœ‰äº†`cocoapods`ç§æœ‰åº“ç»„ä»¶åŒ–è¿™ç§é›†æˆåŒ–çš„è§£å†³æ–¹æ¡ˆ, é€šè¿‡è·¯ç”±æ˜ å°„èƒ½å¤Ÿå¾ˆå¥½çš„åšåˆ°æ¨¡å—åˆ†ç¦», æ›´å¯ä»¥åšåˆ°é¡µé¢é™çº§, æ‰€è°“çš„é¡µé¢é™çº§å°±æ˜¯æŒ‡ä¸ä»…è·¯ç”±å¯ä»¥å’Œ`native`è¿›è¡Œäº¤äº’, ä¹Ÿå¯ä»¥å’Œ`h5`è¿›è¡Œäº¤äº’, å½“`native`å’Œ`h5`æ˜¯ä¸€å¥—ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™, `native`ä¸æ…å‡ºç°`bug`æˆ‘ä»¬å¯ä»¥è¯·æ±‚åç«¯æ¥å£ä¿®æ”¹æ•°æ®åº“å°†é¡µé¢ç›´æ¥é™çº§è‡³`h5`é¡µé¢è€Œä¸ç”¨é‡æ–°æ‰“åŒ…ç­‰å¾…è‹¹æœå®¡æ ¸åŠä½¿ç”¨çƒ­ä¿®å¤å·¥å…·å¸¦æ¥äº†æ—¶é—´æ¶ˆè€—. èƒ½å¤Ÿç¬¬ä¸€æ—¶é—´è§£å†³é—®é¢˜.

![](http://upload-images.jianshu.io/upload_images/1229762-07a68a7051508021.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è§£å†³äº†ä¸Šè¿°é—®é¢˜, æˆ‘ä»¬å°±åªå‰©ä¸‹é¡µé¢çš„é—®é¢˜äº†, å¯¹äºç°åœ¨çš„iOSeræ¥è¯´, å†™é¡µé¢å‡ ä¹æ˜¯æ—¥å¸¸å·¥ä½œçš„ç»å¤§éƒ¨åˆ†, ä½†æ˜¯å†™é¡µé¢, å†™ä¸šåŠ¡, å½“é€»è¾‘å¤æ‚çš„æ—¶å€™ä¹Ÿä¼šäº§ç”Ÿä¸€ç³»åˆ—ä¸æ˜“ç»´æŠ¤çš„é—®é¢˜, è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç±»ä¼¼`redux`è¿™ç§çŠ¶æ€æœºçš„æ¨¡å¼, å°†ä¸šåŠ¡é€»è¾‘æ‹†åˆ†å‡ºä¸åŒå¤æ‚çš„çŠ¶æ€, å½“å˜é‡æ”¹å˜çš„æ—¶å€™, è§¦å‘ä¸åŒçš„çŠ¶æ€, è¿™æ ·å°±èƒ½å¤Ÿæœ‰æ•ˆçš„ç®¡ç†æˆ‘ä»¬çš„é¡µé¢é€»è¾‘. æ¨èå¯ä»¥çœ‹çœ‹`react`å’Œ`redux`çš„æ€è·¯, å¯¹è¿™å—ä¹Ÿä¼šæœ‰æ›´å¥½çš„æŒæ¡.

è®¾è®¡æ€è·¯çš„æ€»ç»“å°±æ˜¯, é€šè¿‡é«˜åº¦æŠ½è±¡è¿›è¡Œåˆ†å±‚, é€šè¿‡æ¥å£æ–‡æ¡£è¿›è¡Œé¡¹ç›®å±‚çº§è§£è€¦, é€šè¿‡è·¯ç”±è¿›è¡Œç»„ä»¶åŒ–åŠé™çº§, é€šè¿‡`CDD`æ¨¡å¼è´¯ç©¿`subview`ä½¿å¾—æ‰€æœ‰çš„`view`éƒ½èƒ½å¤Ÿæ‹¿åˆ°æ•°æ®åŠæ“æ§æ•°æ®, é€šè¿‡`AOP`åˆ‡é¢è¿›è¡Œ`hook`ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½å¦‚åŸ‹ç‚¹ç»Ÿè®¡, å…¨å±€å½“å‰æ§åˆ¶å™¨ç­‰ç­‰.

#### è®¾è®¡å®ç°

ä¸Šé¢éƒ¨åˆ†, å™è¿°äº†æ•´ä¸ªæ¶æ„çš„è®¾è®¡æ€è·¯, æ¥ä¸‹æ¥, æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å…·ä½“å®ç°. ä»¥ä¸‹ä»£ç å–è‡ªçœŸå®é¡¹ç›®, å¯¹åº”`viewè§†è§’`å›¾ä¸­çš„è®¾è®¡å›¾.

```
//
//  InterfaceTemplate.h
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import <UIKit/UIKit.h>

@protocol HYAbroadShoppingHomeModelInterface <NSObject>

/**
 * ä»…ç”¨æ¥ä¿æŒPBä¸ä¸ºç©º
 */
@property(nonatomic) NSInteger status ;
/**
 * å¹¿å‘Šä½
 */
@property(nonatomic,strong) NSMutableArray * banners ;
/**
 * å››ä¸ªicon
 */
@property(nonatomic,strong) NSMutableArray * shortCutIcons ;
/**
 * ä¿ƒé”€æ—¶é—´æˆ³ï¼Œæ´»åŠ¨å‰©ä½™æ—¶é—´,è½¬æ¢æˆæ¯«ç§’
 */
@property(nonatomic,strong) NSString * remainingTime ;
/**
 * å€’è®¡æ—¶çš„å•†å“ï¼Œå®¢æˆ·ç«¯æ ¹æ®å½“è¯¥å­—æ®µæœ‰çš„æ—¶å€™ï¼Œå±•ç¤ºâ€œä»Šæ—¥å‰æ‰‹ä»·â€å›¾ç‰‡
 */
@property(nonatomic,strong) NSMutableArray * salesGoods ;
/**
 * å…¨çƒç²¾é€‰å•†å“é›†åˆ
 */
@property(nonatomic,strong) NSMutableArray * selectGoods ;

@property (nonatomic,assign,getter=isLoaded) BOOL loaded;
@property (nonatomic,assign,getter=isReload) BOOL reload;

@end

@protocol HYAbroadShoppingHomeViewModelInterface <NSObject>

@optional
@property (nonatomic,strong) id<HYAbroadShoppingHomeModelInterface> model;

@optional
- (void)initializeWithModel:(id<HYAbroadShoppingHomeModelInterface>)model completion:(void(^)())completion;
/**
*ç«‹å³è´­ä¹°
* @para goodsId è¿™é‡ŒAndroidå°±å»è°ƒç”¨CommonUtilsé‡Œé¢çš„æ–¹æ³•å³å¯ã€‚IOSè¿™é‡Œè‡ªè¡Œæ·»åŠ ç›¸åº”çš„ä»£ç ã€‚æ³¨æ„è¿™é‡Œä¿æŒä¸€ä¸ªé€»è¾‘ï¼šå¦‚æœæ˜¯å¤„æ–¹è¯è¿›å…¥åˆ°å•†å“è¯¦æƒ…é¡µï¼Œéšå½¢çœ¼é•œâ€¦..
*/

- (void)senderAddShoppingCartWithModel:(id<HYAbroadShoppingHomeModelInterface>)model goodsId:(GoodsID *)goodsId completion:(void(^)())completion;
/**
*è·å–æµ·å¤–è´­é¦–é¡µ
*/

- (void)senderAbroadShoppingHomeWithModel:(id<HYAbroadShoppingHomeModelInterface>)model completion:(void(^)())completion;

@end

@protocol HYAbroadShoppingHomeViewInterface <NSObject>

@property (nonatomic,strong) id<HYAbroadShoppingHomeViewModelInterface> abroadshoppinghomeViewModel;
@property (nonatomic,strong) id<HYAbroadShoppingHomeViewModelInterface> abroadshoppinghomeOperator;

@end

```

æ¥å£æ–‡æ¡£æ–‡ä»¶å°†æ•´ä¸ªé¡µé¢æ¨¡å—åˆ†æˆäº†`ModelInterface`, `ViewModelInterface`, `ViewInterface`ä¸‰ä¸ªæ¥å£,`ModelInterface`æ¥å£å¯¹åº”äº†æœåŠ¡å™¨è¿”å›çš„å¤–å±‚æ•°æ®ç»“æ„, `ViewModelInterface`æ¥å£å¯¹åº”äº†æ“ä½œ`model`æ•°æ®çš„æ–¹æ³•, å¦‚å‘èµ·è¯·æ±‚å’Œä»æ•°æ®åº“è¯»å–è¯¸å¦‚æ­¤ç±». `ViewInterface`æ‹¥æœ‰ä¸¤è€…çš„èƒ½åŠ›.


```
//
//  ControllerTemplate.m
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import "HYAbroadShoppingHomeViewController.h"
#import "HYAbroadShoppingHomePresenter.h"
#import "HYAbroadShoppingHomeViewModel.h"
#import "HYAbroadShoppingHomeView.h"

@interface HYAbroadShoppingHomeViewController ()

@property (nonatomic,strong) HYAbroadShoppingHomePresenter * abroadshoppinghomePresenter;
@property (nonatomic,strong) HYAbroadShoppingHomeViewModel * abroadshoppinghomeViewModel;
@property (nonatomic,strong) HYAbroadShoppingHomeView * abroadshoppinghomeView;

@end

@implementation HYAbroadShoppingHomeViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    self.title = @"å…¨çƒè´­";
    [self setupView];
}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    [self adapterView];
}

- (HYAbroadShoppingHomePresenter *)abroadshoppinghomePresenter {
    
    if (!_abroadshoppinghomePresenter) {
        _abroadshoppinghomePresenter = [HYAbroadShoppingHomePresenter new];
    }
    return _abroadshoppinghomePresenter;
}

- (HYAbroadShoppingHomeViewModel *)abroadshoppinghomeViewModel {
    
    if (!_abroadshoppinghomeViewModel) {
        _abroadshoppinghomeViewModel = [HYAbroadShoppingHomeViewModel new];
    }
    return _abroadshoppinghomeViewModel;
}

- (HYAbroadShoppingHomeView *)abroadshoppinghomeView {
    
    if (!_abroadshoppinghomeView) {
        _abroadshoppinghomeView = [HYAbroadShoppingHomeView new];
        _abroadshoppinghomeView.frame = self.view.bounds;
    }
    return _abroadshoppinghomeView;
}

- (void)setupView {
    [self.view addSubview:self.abroadshoppinghomeView];
}

- (void)adapterView {
    [self.abroadshoppinghomePresenter adapterWithAbroadShoppingHomeView:self.abroadshoppinghomeView abroadshoppinghomeViewModel:self.abroadshoppinghomeViewModel];
}

@end

```
ç»è¿‡æŠ½è±¡å, æˆ‘ä»¬å†æ¥çœ‹çœ‹`controller`çš„æ–‡ä»¶, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°, ç»è¿‡æŠ½è±¡åçš„æ§åˆ¶å™¨åŠ ä¸Šé¡¶éƒ¨çš„æ³¨é‡Šä¹Ÿåªæœ‰`68`è¡Œ, åŸºæœ¬æ˜¯ä¸ç”¨å†ç”¨å¿ƒç»´æŠ¤ä¸Šåƒè¡Œçš„æ§åˆ¶å™¨äº†.

```
//
//  PresenterTemplate.m
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import "HYAbroadShoppingHomePresenter.h"

@interface HYAbroadShoppingHomePresenter ()

@property (nonatomic,weak) id<HYAbroadShoppingHomeViewInterface> abroadshoppinghomeView;
@property (nonatomic,weak) id<HYAbroadShoppingHomeViewModelInterface> abroadshoppinghomeViewModel;

@end

@implementation HYAbroadShoppingHomePresenter

- (void)adapterWithAbroadShoppingHomeView:(id<HYAbroadShoppingHomeViewInterface>)abroadshoppinghomeView abroadshoppinghomeViewModel:(id<HYAbroadShoppingHomeViewModelInterface>)abroadshoppinghomeViewModel {

    _abroadshoppinghomeView = abroadshoppinghomeView;
    _abroadshoppinghomeViewModel = abroadshoppinghomeViewModel;

    __weak typeof(self) _self = self;
    __weak id<HYAbroadShoppingHomeViewModelInterface> __abroadshoppinghomeViewModel = _abroadshoppinghomeViewModel;
    [_abroadshoppinghomeViewModel initializeWithModel:__abroadshoppinghomeViewModel.model completion:^{
        _self.abroadshoppinghomeView.abroadshoppinghomeViewModel = __abroadshoppinghomeViewModel;
        _self.abroadshoppinghomeView.abroadshoppinghomeOperator = _self;
    }];
}

/**
*ç«‹å³è´­ä¹°
* @para goodsId è¿™é‡ŒAndroidå°±å»è°ƒç”¨CommonUtilsé‡Œé¢çš„æ–¹æ³•å³å¯ã€‚IOSè¿™é‡Œè‡ªè¡Œæ·»åŠ ç›¸åº”çš„ä»£ç ã€‚æ³¨æ„è¿™é‡Œä¿æŒä¸€ä¸ªé€»è¾‘ï¼šå¦‚æœæ˜¯å¤„æ–¹è¯è¿›å…¥åˆ°å•†å“è¯¦æƒ…é¡µï¼Œéšå½¢çœ¼é•œâ€¦..
*/

- (void)senderAddShoppingCartWithModel:(id<HYAbroadShoppingHomeModelInterface>)model goodsId:(GoodsID *)goodsId completion:(void(^)())completion {

    __weak typeof(self) _self = self;
    __weak id<HYAbroadShoppingHomeViewModelInterface> __abroadshoppinghomeViewModel = _abroadshoppinghomeViewModel;
    [_abroadshoppinghomeViewModel senderAddShoppingCartWithModel:model goodsId:goodsId completion:^{
        _self.abroadshoppinghomeView.abroadshoppinghomeViewModel = __abroadshoppinghomeViewModel;
        completion();
    }];
}

/**
*è·å–æµ·å¤–è´­é¦–é¡µ
*/

- (void)senderAbroadShoppingHomeWithModel:(id<HYAbroadShoppingHomeModelInterface>)model completion:(void(^)())completion {

    __weak typeof(self) _self = self;
    __weak id<HYAbroadShoppingHomeViewModelInterface> __abroadshoppinghomeViewModel = _abroadshoppinghomeViewModel;
    [_abroadshoppinghomeViewModel senderAbroadShoppingHomeWithModel:model completion:^{
        _self.abroadshoppinghomeView.abroadshoppinghomeViewModel = __abroadshoppinghomeViewModel;
        completion();
    }];
}

@end

```
åœ¨`controller`ä¸­, æˆ‘ä»¬å°†`viewmodel`å’Œ`view`, ä¹Ÿå°±æ˜¯ä¸Šè¿°çš„æ•°æ®å±‚å’Œå±•ç¤ºå±‚ä¼ è¾“åˆ° `presenter`çš„ä¸­é—´ä»¶è¿›è¡Œäº¤äº’, æˆ‘ä»¬é€šè¿‡è§‚å¯Ÿå¯ä»¥çœ‹åˆ°å½“è¯·æ±‚å®Œæˆå, å…ˆè¿›è¡Œèµ‹å€¼æ“ä½œ, å†è¿›è¡Œè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘, è¿™æ ·èƒ½å¤Ÿä¿è¯æ“ä½œä¸šåŠ¡é€»è¾‘æ—¶æ•°æ®æ˜¯æœ€æ–°çš„.

```
//
//  ViewModelTemplate.m
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import "HYAbroadShoppingHomeViewModel.h"
#import "HYAbroadShoppingHomeModel.h"
#import "HYAbroadShoppingSender.h"
#import "HYMallGoodsSender.h"

@implementation HYAbroadShoppingHomeViewModel

- (HYAbroadShoppingHomeModel *)model {
    
    if (!_model) {
        _model = [HYAbroadShoppingHomeModel new];
    }
    return _model;
}

- (void)initializeWithModel:(id<HYAbroadShoppingHomeModelInterface>)model completion:(void(^)())completion {
    if (!model.isLoaded) {
        [self senderAbroadShoppingHomeWithModel:model completion:completion];
    }
}

/**
*ç«‹å³è´­ä¹°
* @para goodsId è¿™é‡ŒAndroidå°±å»è°ƒç”¨CommonUtilsé‡Œé¢çš„æ–¹æ³•å³å¯ã€‚IOSè¿™é‡Œè‡ªè¡Œæ·»åŠ ç›¸åº”çš„ä»£ç ã€‚æ³¨æ„è¿™é‡Œä¿æŒä¸€ä¸ªé€»è¾‘ï¼šå¦‚æœæ˜¯å¤„æ–¹è¯è¿›å…¥åˆ°å•†å“è¯¦æƒ…é¡µï¼Œéšå½¢çœ¼é•œâ€¦..
*/

- (void)senderAddShoppingCartWithModel:(id<HYAbroadShoppingHomeModelInterface>)model goodsId:(GoodsID *)goodsId completion:(void(^)())completion {
  
    NSMutableArray * editArray=[@[] mutableCopy];
    EditGoodsM_Builder * editGoodsM_Builder=[[EditGoodsM_Builder alloc]init];
    editGoodsM_Builder.goodsId = goodsId;
    editGoodsM_Builder.amount = 1;
    [editArray addObject:[editGoodsM_Builder build]];
    
    HYSenderResultModel * resultModel = [HYMallGoodsSender senderAddShoppingCart:nil token:nil  editGoods:editArray promoteIDs:nil];
    HYViewController * vc = [HYCurrentVCmanager shareInstance].getCurrentVC;
    [vc startLoading];
    [vc requestWithModel:resultModel success:^(HYResponseModel *model) {
        _model.reload = NO;
        completion();
        [vc endLoading];
    } failure:^(HYResponseModel * model) {
        [vc endLoading];
    }];
}

/**
*è·å–æµ·å¤–è´­é¦–é¡µ
*/

- (void)senderAbroadShoppingHomeWithModel:(id<HYAbroadShoppingHomeModelInterface>)model completion:(void(^)())completion {
    HYSenderResultModel * resultModel = [HYAbroadShoppingSender senderAbroadShoppingHome:model status:0];
    HYViewController * vc = [HYCurrentVCmanager shareInstance].getCurrentVC;
    [vc startLoading];
    [vc requestWithModel:resultModel success:^(HYResponseModel *model) {
        _model.loaded = YES;
        completion();
        [vc endLoading];
    } failure:^(HYResponseModel * model) {
        [vc endLoading];
    }];
}


@end

```

æˆ‘ä»¬å†æ¥çœ‹çœ‹`viewmodel`å±‚å¦‚ä½•è®¾è®¡, `viewmodel`å±‚æŒæœ‰`model`, å¹¶è¿›è¡Œæ•°æ®è·å–, å°†è·å–çš„æ•°æ®èµ‹å€¼åˆ°`model`ä¸­, ç”±äºçº¿ä¸ŠçœŸå®é¡¹ç›®ä½¿ç”¨çš„æ˜¯`TCP`+`ProtoBuffer`, ä»£ç æ˜¾ç¤ºçš„æ˜¯æˆ‘å¸è‡ªè¡Œå°è£…çš„ä¸€å¥—ç½‘ç»œé€»è¾‘, æ‰€ä»¥å¯èƒ½å¯¹ä¸€äº›åŒå­¦ä¸æ˜¯å¾ˆå‹å¥½, è¯·çœ‹ä¸‹é¢çš„ä¾‹å­:

```
//
//  ViewModelTemplate.m
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import "ViewModelTemplate.h"
#import "ModelTemplate.h"
#import "NetWork.h"
#import "DataBase.h"

@implementation ViewModelTemplate

- (void)dynamicBindingWithFinishedCallBack:(void (^)())finishCallBack {

    [DataBase requestDataWithClass:[ModelTemplate class] finishedCallBack:^(NSDictionary *response) {
        _model = [ModelTemplate modelWithDictionary:response];
        finishCallBack();
    }];
    
    [NetWork requestDataWithType:MethodGetType URLString:@"http://localhost:3001/api/J1/getJ1List" parameter:nil finishedCallBack:^(NSDictionary * response){
        _model = [ModelTemplate modelWithDictionary:response[@"data"]];
        [DataBase cache:[ModelTemplate class] data:response[@"data"]];
        finishCallBack();
    }];
}

@end

```

å…¶ä¸­`DataBase`ä»…ä»…æ˜¯`plist`çš„ç¼“å­˜, è€Œ`NetWork`æ˜¯å°è£…çš„`AFNetworking`, è¿™æ ·å¤§éƒ¨åˆ†åŒå­¦å°±å¾ˆç†Ÿæ‚‰äº†å§, åœ¨`viewmodel`å±‚å¯ä»¥å°†æ•°æ•°æ®åº“å’Œç½‘ç»œè¯·æ±‚è¿™ä¸¤ç§è·å–æ•°æ®çš„æ–¹å¼å°è£…åœ¨ä¸€ä¸ªå±‚çº§é‡Œé¢, è¿™æ ·é€»è¾‘åˆ†æ˜ä¹Ÿå¯¹å¤–ç•Œæ²¡æœ‰è€¦åˆ, è€Œå¯¹äºæˆ‘ä»¬çº¿ä¸Šé¡¹ç›®æˆ‘ä»¬åœ¨åº•å±‚è¿˜æœ‰ä¸€ä¸ª`sender`å±‚ç”¨äºç®¡ç†ä¸Šè¿°é—®é¢˜åŠä¸€äº›å…¶ä»–ä¸šåŠ¡é€»è¾‘, é€šç”¨çš„æ¶æ„è®¾è®¡æ˜¯ä¸€ä¸ªæ€æƒ³, éœ€è¦ç»“åˆå®é™…ä¸šåŠ¡é€»è¾‘è¿›è¡Œè°ƒæ•´, æ­£æ‰€è°“ä¸èƒ½è„±ç¦»ä¸šåŠ¡è°ˆæ¶æ„.

```
//
//  ViewTemplate.m
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import "HYAbroadShoppingHomeView.h"
#import "HYAbroadShoppingHomeHeaderView.h"
#import "HYAbroadSelectGoodsViewCell.h"

@interface HYAbroadShoppingHomeView () <UITableViewDataSource, UITableViewDelegate>

@property (nonatomic,strong) UITableView * tableView;
@property (nonatomic,strong) HYAbroadShoppingHomeHeaderView * headerView;

@end

@implementation HYAbroadShoppingHomeView

- (void)dealloc {
    NSLog(@"%@ - execute %s",NSStringFromClass([self class]),__func__);
}

- (instancetype)initWithFrame:(CGRect)frame {
    
    self = [super initWithFrame:frame];
    if (self) {
        [self setupSubviews];
    }
    return self;
}

- (instancetype)initWithCoder:(NSCoder *)coder  {
    
    self = [super initWithCoder:coder];
    if (self) {
        [self setupSubviews];
    }
    return self;
}

- (UITableView *)tableView {
    
    if (!_tableView) {
        _tableView = [UITableView new];
        _tableView.dataSource = self;
        _tableView.delegate = self;
        _tableView.tableHeaderView = self.headerView;
        _tableView.backgroundColor = SQBGC;
        _tableView.separatorStyle = UITableViewCellSeparatorStyleNone;
    }
    return _tableView;
}

- (HYAbroadShoppingHomeHeaderView *)headerView {
    
    if (!_headerView) {
        _headerView = [HYAbroadShoppingHomeHeaderView new];
        _headerView.hidden = YES;
    }
    return _headerView;
}

- (void)setupSubviews {
    [self addSubview:self.tableView];
}

- (void)setAbroadshoppinghomeViewModel:(id<HYAbroadShoppingHomeViewModelInterface>)abroadshoppinghomeViewModel {
    _abroadshoppinghomeViewModel = abroadshoppinghomeViewModel;
    if (abroadshoppinghomeViewModel.model.reload) {
        _headerView.hidden = !abroadshoppinghomeViewModel.model.isLoaded;
        _headerView.model = abroadshoppinghomeViewModel.model;
        CGFloat headerViewH = abroadshoppinghomeViewModel.model.remainingTime.length
        ? kscaleDeviceLength(160) + (self.width / 4) * 1.1 + 290
        : kscaleDeviceLength(160) + (self.width / 4) * 1.1 + 50;
        _headerView.frame = CGRectMake(0, 0, 0, headerViewH);
        [_tableView reloadData];
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return _abroadshoppinghomeViewModel.model.selectGoods.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    
    HYAbroadSelectGoodsViewCell * cell = [HYAbroadSelectGoodsViewCell cellWithTableView:tableView];
    cell.good = _abroadshoppinghomeViewModel.model.selectGoods[indexPath.item];
    cell.abroadshoppinghomeOperator = _abroadshoppinghomeOperator;
    return cell;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return [HYAbroadSelectGoodsViewCell cellHeightWithGood:_abroadshoppinghomeViewModel.model.selectGoods[indexPath.item]];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
}

- (void)layoutSubviews {
    [super layoutSubviews];
    _tableView.frame = self.bounds;
}

@end

```
æ¥ç€æˆ‘ä»¬æ¥çœ‹`view`,æ ¹æ®ä¹‹å‰çš„è®¾è®¡å›¾, æˆ‘ä»¬å°†å…¶åŒºåˆ†ä¸ºä¸¤ä¸ªæ¨¡å—, `tableview`çš„`headerview`å’Œ`tableviewcell`, å…¶ä¸­`headerview`è´Ÿè´£ä¸Šé¢ä¸éœ€è¦å¤ç”¨çš„`view`, è€Œ`tableviewcell`è´Ÿè´£éœ€è¦å¤ç”¨çš„éƒ¨åˆ†. 

è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°é‡å†™`set`æ–¹æ³•æ—¶æ ¹æ®æ˜¯å¦éœ€è¦åˆ·æ–°`tableview`, ä¸€å®šé™åº¦é¿å…äº†æ— æ•ˆçš„åˆ·æ–°æ¶ˆè€—.

è¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯å°†`operator`ç›´æ¥è´¯ç©¿ä¼ é€’åˆ°å„çº§`subview`è¿™é‡Œç”¨åˆ°çš„å°±æ˜¯`CDD`æ¨¡å¼çš„ç²¾é«“, ä½¿å¾—æ‰€æœ‰çš„`subview`éƒ½èƒ½å¤Ÿè·å–æ•°æ®, é¿å…äº†`delegate`, `block`è¿™ç§å†—ä½™å›è°ƒå¸¦æ¥è€¦åˆçš„å°´å°¬, å…³é”®æ˜¯ä¸‘.

```
//
//  HYAbroadSelectGoodsViewFrameHub.m
//  Mall
//
//  Created by æœ±åŒæ³‰ on 19/10/2017.
//  Copyright Â© 2017 _Zhizi_. All rights reserved.
//

#import "HYAbroadSelectGoodsViewFrameHub.h"
#import "NSString+SQExtension.h"

@implementation HYAbroadSelectGoodsViewFrameHub

- (instancetype)initWithGoodsName:(NSString *)goodsName nameGoodEvalution:(NSString *)nameGoodEvalution {
    
    self = [super init];
    if (self) {
        
        CGFloat width = DeviceWidth - 30;
        CGFloat proImageUrlButtonX = 10;
        CGFloat proImageUrlButtonY = proImageUrlButtonX;
        CGFloat proImageUrlButtonW = width - 2 * proImageUrlButtonX;
        CGFloat proImageUrlButtonH = proImageUrlButtonW;
        _proImageUrlButtonFrame = CGRectMake(proImageUrlButtonX, proImageUrlButtonY, proImageUrlButtonW, proImageUrlButtonH);
        
        CGFloat goodsSellerImageViewX = proImageUrlButtonX;
        CGFloat goodsSellerImageViewY = proImageUrlButtonY + proImageUrlButtonH + 13;
        CGFloat goodsSellerImageViewW = 20;
        CGFloat goodsSellerImageViewH = 15;
        _goodsSellerImageViewFrame = CGRectMake(goodsSellerImageViewX, goodsSellerImageViewY, goodsSellerImageViewW, goodsSellerImageViewH);
        
        CGFloat goodsNameLabelX = goodsSellerImageViewX;
        CGFloat goodsNameLabelY = proImageUrlButtonY + proImageUrlButtonH + 10;
        CGFloat goodsNameLabelW = proImageUrlButtonW;
        CGSize  goodsNameLabelSize = [goodsName getSizeWithConstraint:CGSizeMake(goodsNameLabelW, 60) font:KF03_17];
        CGFloat goodsNameLabelH = goodsNameLabelSize.height;
        _goodsNameLabelFrame = CGRectMake(goodsNameLabelX, goodsNameLabelY, goodsNameLabelW, goodsNameLabelH);
        
        CGFloat costPriceLabelY = 0.0;
        if (nameGoodEvalution.length) {
            CGFloat userEvalutionLabelX = proImageUrlButtonX + 10;
            CGFloat userEvalutionLabelY = goodsNameLabelY + goodsNameLabelH + 10;
            CGFloat userEvalutionLabelW = 55;
            CGFloat userEvalutionLabelH = 20;
            _userEvalutionLabelFrame = CGRectMake(userEvalutionLabelX, userEvalutionLabelY, userEvalutionLabelW, userEvalutionLabelH);
            
            CGFloat userEvalutionBackgroundX = proImageUrlButtonX;
            CGFloat userEvalutionBackgroundY = userEvalutionLabelY + userEvalutionLabelH / 2;
            CGFloat userEvalutionBackgroundW = proImageUrlButtonW;
            
            CGFloat nameGoodEvalutionLabelX = userEvalutionBackgroundX + 10;
            CGFloat nameGoodEvalutionLabelY = userEvalutionLabelY + userEvalutionLabelH + 10;
            CGFloat nameGoodEvalutionLabelW = userEvalutionBackgroundW - 20;
            CGSize  nameGoodEvalutionLabelSize = [nameGoodEvalution getSizeWithConstraint:CGSizeMake(nameGoodEvalutionLabelW, 40) font:KF06_12];
            
            CGFloat nameGoodEvalutionLabelH = nameGoodEvalutionLabelSize.height;
            _nameGoodEvalutionLabelFrame = CGRectMake(nameGoodEvalutionLabelX, nameGoodEvalutionLabelY, nameGoodEvalutionLabelW, nameGoodEvalutionLabelH);
            
            CGFloat userEvalutionBackgroundH = nameGoodEvalutionLabelH + 30;
            _userEvalutionBackgroundFrame = CGRectMake(userEvalutionBackgroundX, userEvalutionBackgroundY, userEvalutionBackgroundW, userEvalutionBackgroundH);
            
            costPriceLabelY = userEvalutionBackgroundY + userEvalutionBackgroundH + 10;
        } else {
            costPriceLabelY = goodsNameLabelY + goodsNameLabelH + 10;
        }
        
        CGFloat costPriceLabelX = goodsNameLabelX;
        CGFloat costPriceLabelW = 180;
        CGFloat costPriceLabelH = 30;
        _costPriceLabelFrame = CGRectMake(costPriceLabelX, costPriceLabelY, costPriceLabelW, costPriceLabelH);
        
        CGFloat buyButtonW = 80;
        CGFloat buyButtonX = goodsNameLabelX + goodsNameLabelW - buyButtonW;
        CGFloat buyButtonY = costPriceLabelY;
        CGFloat buyButtonH = costPriceLabelH;
        _buyButtonFrame = CGRectMake(buyButtonX, buyButtonY, buyButtonW, buyButtonH);
        
        _calculateHeight = CGRectGetMaxY(_buyButtonFrame) + 10;
    }
    return self;
}

@end

```

å½“éœ€è¦åŠ¨æ€è®¡ç®—é«˜åº¦çš„æ—¶å€™, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`framehub`è¿™ç§æ¨¡å¼, åå­—æ˜¯è‡ªå·±å–çš„, è¯·åˆ«è§æ€ª, å¯¹æ€§èƒ½æœ‰è¦æ±‚çš„åŒå­¦å¯ä»¥å°†é«˜åº¦è®¡ç®—å€¼ç¼“å­˜ä¸‹æ¥, ä»¥å…`cpu`é‡å¤å¤§é‡è®¡ç®—å¯¼è‡´æ‰‹æœºçš„è€—ç”µ.

```
//
//  HYAbroadSelectGoodsViewCell.m
//  Mall
//
//  Created by æœ±åŒæ³‰ on 12/10/2017.
//  Copyright Â© 2017 _Zhizi_. All rights reserved.
//

#import "HYAbroadSelectGoodsViewCell.h"
#import "HYAbroadSelectGoodsView.h"
#import "HYGoodsDetailViewController.h"
#import "HYCartNewViewController.h"
#import "UIAlertView+SQExtension.h"
#import "NSString+SQExtension.h"

@interface HYAbroadSelectGoodsViewCell ()

@property (nonatomic,strong) HYAbroadSelectGoodsView * selectGoodsView;

@end

@implementation HYAbroadSelectGoodsViewCell

- (void)dealloc {
#if DEBUG
    NSLog(@"--------");
    NSLog(@"%@ - execute %s",NSStringFromClass([self class]),__func__);
    NSLog(@"--------");
#endif
}

+ (instancetype)cellWithTableView:(UITableView *)tableView {
    
    NSString * identifier = NSStringFromClass([HYAbroadSelectGoodsViewCell class]);
    HYAbroadSelectGoodsViewCell * cell = [tableView dequeueReusableCellWithIdentifier:identifier];
    if (!cell) {
        cell = [[HYAbroadSelectGoodsViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:identifier];
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
    }
    return cell;
}

- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier {
    
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        [self setupSubviews];
    }
    return self;
}

- (HYAbroadSelectGoodsView *)selectGoodsView {
    
    if (!_selectGoodsView) {
        _selectGoodsView = [HYAbroadSelectGoodsView new];
        _selectGoodsView.backgroundColor = [UIColor whiteColor];
        _selectGoodsView.layer.cornerRadius = 4;
        _selectGoodsView.layer.masksToBounds = YES;
    }
    return _selectGoodsView;
}

- (void)setupSubviews {
    self.contentView.backgroundColor = SQBGC;
    [self.contentView addSubview:self.selectGoodsView];
}

- (void)setGood:(AbroadGoods *)good {
    _good = good;
    __weak typeof(self) _self = self;
    [_selectGoodsView.proImageUrlButton sd_setBackgroundImageWithURL:[NSURL URLWithString:good.proImageUrl] forState:0 placeholderImage:[UIImage imageNamed:@"placeholder_200"]];
    [_selectGoodsView.proImageUrlButton whenTapped:^{
        [[HYCurrentVCmanager shareInstance].getCurrentVC hyPushDetail:_self.good.targetUrl];
    }];
    [_selectGoodsView.goodsSellerImageView sd_setImageWithURL:[NSURL URLWithString:good.goodsSellerImage]];
    _selectGoodsView.goodsNameLabel.text = [NSString stringWithFormat:@"      %@", [good.goodsName trim]];
    _selectGoodsView.nameGoodEvalutionLabel.text = [good.nameGoodEvalution trim];
    _selectGoodsView.costPriceLabel.text = good.ecPrice;
    [_selectGoodsView.buyButton whenTapped:^{
        if (_self.good.goodsType == GoodsTypePrescriptionAllow ||
            _self.good.goodsType == GoodsTypePrescriptionForbid ||
            _self.good.goodsType == GoodsTypeGlasses) {
            [[HYCurrentVCmanager shareInstance].getCurrentVC HYPushViewController:[HYGoodsDetailViewController new] animated:YES];
        } else {
            [_self.abroadshoppinghomeOperator senderAddShoppingCartWithModel:nil goodsId:_self.good.goodsId completion:^{
                [UIAlertView showAlertViewWithTitle:@"æ·»åŠ æˆåŠŸ!" message:@"å•†å“å·²åŠ å…¥è´­ç‰©è½¦" cancelButtonTitle:@"å†é€›é€›" otherButtonTitles:@[@"å»è´­ç‰©è½¦"] clickAtIndex:^(NSInteger buttonIndex) {
                    if (buttonIndex == 1) {
                        [[HYCurrentVCmanager shareInstance].getCurrentVC HYPushViewController:[HYCartNewViewController new] animated:YES];
                    }
                }];
            }];
        }
    }];
    [_selectGoodsView setNeedsLayout];
    [self setNeedsLayout];
}

- (void)layoutSubviews {
    [super layoutSubviews];
    
    CGFloat selectGoodsViewX = 15;
    CGFloat selectGoodsViewY = 0;
    CGFloat selectGoodsViewW = self.width - 2 * selectGoodsViewX;
    CGFloat selectGoodsViewH = [HYAbroadSelectGoodsView viewHeightWithGoodsName:[NSString stringWithFormat:@"      %@", [_good.goodsName trim]] nameGoodEvalution:[_good.nameGoodEvalution trim]];
    _selectGoodsView.frame = CGRectMake(selectGoodsViewX, selectGoodsViewY, selectGoodsViewW, selectGoodsViewH);
}

+ (CGFloat)cellHeightWithGood:(AbroadGoods *)good {
    return [HYAbroadSelectGoodsView viewHeightWithGoodsName:[NSString stringWithFormat:@"      %@", [good.goodsName trim]] nameGoodEvalution:[good.nameGoodEvalution trim]] + 10;
}

@end

```

å¯ä»¥çœ‹åˆ°, æ¨èå°†`tableviewcell`çš„é«˜åº¦åŠè·å–å°è£…åœ¨å†…, é¿å…å’Œ`tableview`è¿›è¡Œè€¦åˆ, è¿™é‡Œæ³¨æ„çš„æ˜¯ä»¥ä¸‹ä»£ç :

```
[_self.abroadshoppinghomeOperator senderAddShoppingCartWithModel:nil goodsId:_self.good.goodsId completion:^{
                [UIAlertView showAlertViewWithTitle:@"æ·»åŠ æˆåŠŸ!" message:@"å•†å“å·²åŠ å…¥è´­ç‰©è½¦" cancelButtonTitle:@"å†é€›é€›" otherButtonTitles:@[@"å»è´­ç‰©è½¦"] clickAtIndex:^(NSInteger buttonIndex) {
                    if (buttonIndex == 1) {
                        [[HYCurrentVCmanager shareInstance].getCurrentVC HYPushViewController:[HYCartNewViewController new] animated:YES];
                    }
                }];
            }];
```

ç›´æ¥åœ¨`subview`ä¸­è·å–äº†è¯·æ±‚çš„é€»è¾‘, å½“è°ƒç”¨`opeator`çš„æ–¹æ³•æ—¶ä¼šé€šè¿‡`presenter`ä¸­é—´ä»¶ä¼ é€’ç»™`viewmodel`è¿›è¡Œè¯·æ±‚, å½“è¯·æ±‚æˆåŠŸåè¿›è¡Œèµ‹å€¼æ“ä½œåˆ·æ–°`tableview`, æœ€åå›è°ƒè‡ªå®šä¹‰æ“ä½œå¼¹å‡ºäº†`alert`æ¡†, ç”±äºéƒ½æ˜¯ä¸»çº¿ç¨‹æ“ä½œ, ä¹Ÿä¸ä¼šæœ‰çº¿ç¨‹å®‰å…¨çš„é—®é¢˜.

```
//
//  Router.swift
//  RouterPatterm
//
//  Created by åŒæ³‰ æœ± on 17/4/12.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

import UIKit

class Router {
    static let shareRouter = Router()
    var params: [String : Any]?
    var routers: [String : Any]?
    fileprivate let map = ["J1" : "Controller"]
    
    func guardRouters(finishedCallback : @escaping () -> ()) {
        
        Http.requestData(.get, URLString: "http://localhost:3001/api/J1/getRouters") { (response) in
            guard let result = response as? [String : Any] else { return }
            guard let data:[String : Any] = result["data"] as? [String : Any] else { return }
            guard let routers:[String : Any] = data["routers"] as? [String : Any] else { return }
            self.routers = routers
            finishedCallback()
        }
    }
}

extension Router {
    
    func addParam(key: String, value: Any) {
        params?[key] = value
    }
    
    func clearParams() {
        params?.removeAll()
    }
    
    func push(_ path: String) {
        
        guardRouters {
            guard let state = self.routers?[path] as? String else { return }
            
            if state == "app" {
                guard let nativeController = NSClassFromString("RouterPatterm.\(self.map[path]!)") as? UIViewController.Type else { return }
                currentController?.navigationController?.pushViewController(nativeController.init(), animated: true)
            }
            
            if state == "web" {
                
                let host = "http://localhost:3000/"
                var query = ""
                let ref = "client=app"
                
                guard let params = self.params else { return }
                for (key, value) in params {
                    query += "\(key)=\(value)&"
                }
                
                self.clearParams()
                
                let webViewController = WebViewController("\(host)\(path)?\(query)\(ref)")
                currentController?.navigationController?.pushViewController(webViewController, animated: true)
            }
        }
    }
}

```
ç”±äºçº¿ä¸ŠçœŸå®é¡¹ç›®çš„è·¯ç”±æ¶‰åŠå…¬å¸ä¸šåŠ¡, è¿™é‡Œå°±é€šè¿‡æˆ‘çš„ä¸€ä¸ªå°`demo`è¿›è¡Œè®²è§£, `router`çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªæ˜ å°„, é¦–å…ˆ`router`ç±»æ˜¯ä¸€ä¸ªå•ä¾‹, éœ€è¦æœ‰æ·»åŠ å’Œåˆ é™¤å‚æ•°çš„æ¥å£, ä»¥åŠå¯ä»¥åŒºåˆ†æ˜¯`native`å’Œ`h5`çš„è®¾è®¡, ä»¥åŠä¹‹å‰è®²åˆ°çš„é™çº§, ä¸ç”¨çœ‹ä¸€äº›ä¸‰æ–¹åº“çš„è®¾è®¡å¤šä¹ˆé…·ç‚«, ç©¶å…¶æœ¬è´¨è¿˜æ˜¯å¯¹äº`"\(host)\(path)?\(query)\(ref)"`è¿›è¡Œé€»è¾‘æ‹†åˆ†, ä½¿ç”¨è·¯ç”±çš„å¥½å¤„æ˜¯å½“ä½¿ç”¨`cocoapod`ç§æœ‰åº“ç»„ä»¶åŒ–çš„æ—¶å€™, å®Œå…¨é¿å…äº†å¤šæ§åˆ¶å™¨ä¹‹é—´çš„è€¦åˆ.

```
#import <objc/runtime.h>
@interface MySafeDictionary : NSObject
@end
static NSLock *kMySafeLock = nil;
static IMP kMySafeOriginalIMP = NULL;
static IMP kMySafeSwizzledIMP = NULL;
@implementation MySafeDictionary
+ (void)swizzlling {
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        kMySafeLock = [[NSLock alloc] init];
    });
    
    [kMySafeLock lock];
    
    do {
        if (kMySafeOriginalIMP || kMySafeSwizzledIMP) break;
        
        Class originalClass = NSClassFromString(@"__NSDictionaryM");
        if (!originalClass) break;
        
        Class swizzledClass = [self class];
        SEL originalSelector = @selector(setObject:forKey:);
        SEL swizzledSelector = @selector(safe_setObject:forKey:);
        Method originalMethod = class_getInstanceMethod(originalClass, originalSelector);
        Method swizzledMethod = class_getInstanceMethod(swizzledClass, swizzledSelector);
        if (!originalMethod || !swizzledMethod) break;
        
        IMP originalIMP = method_getImplementation(originalMethod);
        IMP swizzledIMP = method_getImplementation(swizzledMethod);
        const char *originalType = method_getTypeEncoding(originalMethod);
        const char *swizzledType = method_getTypeEncoding(swizzledMethod);
        
        kMySafeOriginalIMP = originalIMP;
        kMySafeSwizzledIMP = swizzledIMP;
        
        class_replaceMethod(originalClass,swizzledSelector,originalIMP,originalType);
        class_replaceMethod(originalClass,originalSelector,swizzledIMP,swizzledType);
    } while (NO);
    
    [kMySafeLock unlock];
}
+ (void)restore {
    [kMySafeLock lock];
    
    do {
        if (!kMySafeOriginalIMP || !kMySafeSwizzledIMP) break;
        
        Class originalClass = NSClassFromString(@"__NSDictionaryM");
        if (!originalClass) break;
        
        Method originalMethod = NULL;
        Method swizzledMethod = NULL;
        unsigned int outCount = 0;
        Method *methodList = class_copyMethodList(originalClass, &outCount);
        for (unsigned int idx=0; idx < outCount; idx++) {
            Method aMethod = methodList[idx];
            IMP aIMP = method_getImplementation(aMethod);
            if (aIMP == kMySafeSwizzledIMP) {
                originalMethod = aMethod;
            }
            else if (aIMP == kMySafeOriginalIMP) {
                swizzledMethod = aMethod;
            }
        }
        // å°½å¯èƒ½ä½¿ç”¨exchange,å› ä¸ºå®ƒæ˜¯atomicçš„
        if (originalMethod && swizzledMethod) {
            method_exchangeImplementations(originalMethod, swizzledMethod);
        }
        else if (originalMethod) {
            method_setImplementation(originalMethod, kMySafeOriginalIMP);
        }
        else if (swizzledMethod) {
            method_setImplementation(swizzledMethod, kMySafeSwizzledIMP);
        }
        kMySafeOriginalIMP = NULL;
        kMySafeSwizzledIMP = NULL;
    } while (NO);
    
    [kMySafeLock unlock];
}
- (void)safe_setObject:(id)anObject forKey:(id<NSCopying>)aKey {
    if (anObject && aKey) {
        [self safe_setObject:anObject forKey:aKey];
    }
    else if (aKey) {
        [(NSMutableDictionary *)self removeObjectForKey:aKey];
    }
}
@end
```
å¯¹äº`AOP`è¿™ç§, æˆ‘æˆªå–äº†ä¸€ä½[å¤§ä½¬åšå®¢](http://www.tanhao.me/code/160723.html/)ä¸­çš„ä»£ç , å¯ä»¥çœ‹åˆ°çš„æ˜¯, å½“å¤šçº¿ç¨‹çš„æ—¶å€™, æˆ‘ä»¬åªéœ€è¦åœ¨`hook`çš„æ—¶å€™è¿›è¡ŒåŠ é”å’Œè§£é”ä¿æŒçº¿ç¨‹å®‰å…¨å°±å¯ä»¥äº†, å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨`Aspects`è¿™ä¸ªåº“æ¥ç®€åŒ–`hook`æ“ä½œ,æ¯•ç«Ÿ`AOP`è¿™å—æ˜¯è¦çœ‹ä¸šåŠ¡é€»è¾‘çš„, å¹¶ä¸èƒ½ä¸€æ¦‚è€Œè®º.

```
//
//  UIViewController+hook.m
//  SQTemplate
//
//  Created by æœ±åŒæ³‰ on 23/11/2017.
//  Copyright Â© 2017 Doubles_Z. All rights reserved.
//

#import "UIViewController+hook.h"
#import "CurrentViewController.h"
#import <Aspects.h>

@implementation UIViewController (hook)

+ (void)load {
    
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        [UIViewController aspect_hookSelector:@selector(viewWillAppear:) withOptions:AspectPositionAfter usingBlock:^(id<AspectInfo> aspectInfo, BOOL animated) {
            kCurrentViewController = aspectInfo.instance;
        } error:NULL];
    });
}    
@end

```
æœ€å¸¸ç”¨çš„`AOP`å°±æ˜¯`hook`ç”Ÿå‘½å‘¨æœŸæ¥è·å–å½“å‰æ§åˆ¶å™¨, é€šè¿‡ä¸€ä¸ªå…¨å±€å˜é‡å¯ä»¥å…¨æ–¹ä½è·å–, ä»¥ä¸Šä»£ç å°±æ˜¯é€šè¿‡`AOP`æ¨¡å¼è¿›è¡Œé¢å‘åˆ‡ç‰‡ç¼–ç¨‹, é¿å…éœ€è¦ç»§æ‰¿ä¸€ä¸ªåŸºç±»è€Œå¸¦æ¥çš„å¼ºè€¦åˆ. 

#### ç”Ÿæˆå·¥å…·

![](http://upload-images.jianshu.io/upload_images/1229762-b379242482f64cae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ‰€è°“å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨, ä¸Šé¢çš„æ¶æ„è®¾è®¡è™½å¥½, ä½†è¦è®©å…¶ä»–åŒå­¦æ¨¡ä»¿å†™æ³•å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†, ä¹Ÿä¼šå¯¼è‡´æŠµè§¦æƒ…ç»ª, ä½†ä¸ºäº†æˆ‘ä»¬ä¹‹å‰ä»£ç è§„èŒƒçš„ç›®æ ‡, æ¶æ„è®¾è®¡çš„æ‰§è¡Œä¹Ÿæ˜¯å¿—åœ¨å¿…è¡Œ, è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦è¿›è¡Œä»£ç è‡ªåŠ¨ç”Ÿæˆçš„å·¥ä½œ.

æ‰€è°“çš„ä»£ç ç”Ÿæˆç©¶å…¶æœ¬è´¨å°±æ˜¯å­—ç¬¦ä¸²æ›¿æ¢, å°±æ˜¯å°†å¯å˜çš„å­—ç¬¦ä¸²æ›¿æ¢æ¨¡æ¿ä¸­çš„æ ‡è®°, `ES6`ä¸­çš„æ¨¡æ¿å­—ç¬¦ä¸²`${å˜é‡}`ä¹Ÿæ˜¯è¿™ä¸ªé“ç†.

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¨¡æ¿:

```
//
//  InterfaceTemplate.h
//  SQTemplate
//
//  Created by åŒæ³‰ æœ± on 17/5/5.
//  Copyright Â© 2017å¹´ Doubles_Z. All rights reserved.
//

#import <UIKit/UIKit.h>

@protocol <#Root#><#Unit#>ModelInterface <NSObject>

<#ModelInterface#>
@end

@protocol <#Root#><#Unit#>ViewModelInterface <NSObject>

@optional
@property (nonatomic,strong) id<<#Root#><#Unit#>ModelInterface> model;

@optional
- (void)initializeWithModel:(id<<#Root#><#Unit#>ModelInterface>)model <#InitializeInterface#>completion:(void(^)())completion;
<#ViewModelInterface#>
@end

@protocol <#Root#><#Unit#>ViewInterface <NSObject>

@property (nonatomic,weak) id<<#Root#><#Unit#>ViewModelInterface> <#unit#>ViewModel;
@property (nonatomic,weak) id<<#Root#><#Unit#>ViewModelInterface> <#unit#>Operator;

@end

```

å¹¶è¿›è¡Œè¯»å†™æ“ä½œ:

```
//
//  SQFileParser.m
//  SQBuilder
//
//  Created by æœ±åŒæ³‰ on 17/08/2017.
//  Copyright Â© 2017 Castie!. All rights reserved.
//

#import "SQFileParser.h"

@implementation SQFileParser

+ (NSDictionary *)parser_plist_r {
    
    NSBundle * bundle = [NSBundle bundleWithPath:[[NSBundle mainBundle] pathForResource:@"builder.bundle" ofType:nil]];
    NSDictionary * config = [NSDictionary dictionaryWithContentsOfFile:[bundle pathForResource:@"config/config.plist" ofType:nil]];
    NSMutableDictionary * plist = [NSDictionary dictionaryWithContentsOfFile:[bundle pathForResource:[NSString stringWithFormat:@"config/%@.plist",config[@"builderSource"]] ofType:nil]].mutableCopy;
    [config enumerateKeysAndObjectsUsingBlock:^(id  _Nonnull key, id  _Nonnull obj, BOOL * _Nonnull stop) {
        [plist setObject:obj forKey:key];
    }];
    return plist;
}

+ (void)parser_rw:(NSString *)path code:(NSString *)code filename:(NSString *)filename header:(NSString *)header parameter:(NSMutableArray *)parameter {

    NSString * arch = [[filename componentsSeparatedByString:@"."]firstObject];
    NSString * suffix = [[filename componentsSeparatedByString:@"."]lastObject];
    NSString * filename_r = [NSString stringWithFormat:@"%@Template.%@", arch,suffix];
    NSString * filename_w = [NSString stringWithFormat:@"%@/%@%@.%@", path,header,arch,suffix];
    NSString * template =  [SQFileParser parser_r:filename_r code:[code lowercaseString]];
    [[SQFileParser replaceThougth:template parameter:parameter] writeToFile:filename_w atomically:YES encoding:NSUTF8StringEncoding error:nil];
}

+ (NSString *)parser_r:(NSString *)filename code:(NSString *)code {
    
    NSBundle * bundle = [NSBundle bundleWithPath:[[NSBundle mainBundle] pathForResource:@"builder.bundle" ofType:nil]];
    return [NSMutableString stringWithContentsOfFile:[bundle pathForResource:[NSString stringWithFormat:@"template/%@/%@", code, filename] ofType:nil] encoding:NSUTF8StringEncoding error:nil];
}

static NSString * code;

+ (NSString *)replaceThougth:(NSString *)templete parameter:(NSMutableArray *)parameter {
    
    __block NSString * temp = templete;
    [[parameter firstObject] enumerateKeysAndObjectsUsingBlock:^(NSString *  _Nonnull key, NSString *  _Nonnull obj, BOOL * _Nonnull stop) {
        temp = [templete stringByReplacingOccurrencesOfString:key withString:obj];
    }];
    [parameter removeObjectAtIndex:0];
    if (parameter.count) {
        [SQFileParser replaceThougth:temp parameter:parameter];
    } else {
        code = temp;
    }
    return code;
}

@end

```

å…³äºç”Ÿæˆå·¥å…·çš„å¼€å‘ä¹‹å‰æœ‰ä¸€ç¯‡è¯¦ç»†è®ºè¿°äº†, è¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°äº†. [ç‚¹å‡»è·³è½¬](http://www.jianshu.com/p/cb36b36f90dd)

![](http://upload-images.jianshu.io/upload_images/1229762-192d8c731f9f7a40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘å¸å·²ç»é€šè¿‡è¯»å–è¡¨æ ¼è¿›è¡Œç”Ÿæˆ`iOS`å’Œ`Android`ä¸¤ç«¯çš„ä»£ç , ä¿æŒä¸¤ç«¯é€»è¾‘ç›¸åŒ, ä½†ç”±äºè¡¨æ ¼çš„è®¾è®¡ä¸å…¬å¸ä¸šåŠ¡åŠä¸ªäººä¹ æƒ¯ç›¸å…³, è¿™éƒ¨åˆ†ä»£ç ä¸äºˆå…¬å¼€, è¯·è°…è§£.

![](http://upload-images.jianshu.io/upload_images/1229762-21cbe486dc345f6e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„æ–‡ä»¶é€šè¿‡æ–‡ä»¶å¤¹çš„å½¢å¼å­˜åœ¨, åªéœ€è¦å°†æ–‡ä»¶å¤¹å¯¼å…¥é¡¹ç›®ä¸­å³å¯ç«‹å³è·å¾—ä¹‹å‰æ‰€è®¾è®¡çš„æ¶æ„.

![](http://upload-images.jianshu.io/upload_images/1229762-4b973424329156f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æœ€åæˆ‘å°†`æ¶æ„demo`ä»¥åŠ`å·¥å…·`æ”¾åœ¨äº†[github](https://github.com/coderZsq/coderZsq.project.oc)ä¸Š, å…³äºä¸Šé¢`router`é™çº§è¿™å—å¯ä»¥[ç‚¹å‡»è¿™é‡Œä¸‹è½½](https://github.com/coderZsq/coderZsq.target.swift)

#### å¦‚ä½•ä½¿ç”¨

[coderZsq.project.oc](https://github.com/coderZsq/coderZsq.project.oc)

![](http://upload-images.jianshu.io/upload_images/1229762-57f504685f17ac57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

`git clone` | `download` åæ‰“å¼€`SQTemplate`å·¥ä½œç©ºé—´, å°±èƒ½å¤Ÿçœ‹åˆ°ä¸¤ä¸ªé¡¹ç›®.

`SQBuilder`æ˜¯ç”Ÿæˆå·¥å…·çš„é¡¹ç›®.
![](http://upload-images.jianshu.io/upload_images/1229762-070ec94a17dfb88d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

é…ç½®ç”Ÿæˆå·¥å…·çš„æ¥å£æ–‡æ¡£å­—æ®µå, ç‚¹å‡»`Run`å³å¯ç”Ÿæˆä»£ç , æ˜¾ç¤ºåœ¨æ¡Œé¢.

`SQTemplate`æ˜¯æ¨¡æ¿ç”Ÿæˆååœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„`demo`.

![](http://upload-images.jianshu.io/upload_images/1229762-73c1cf4e7e79c57c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


å¯ä»¥çœ‹åˆ°ä¸Šè¿°æ‰€æœ‰çš„æ¶æ„è®¾è®¡æ¨¡å¼çš„ç®€å•å¼•ç”¨, ç‚¹å‡»ç§’é€Ÿäº”å˜ç±³çš„å›¾ç‰‡, å¯ä»¥é€šè¿‡è·¯ç”±è·³è½¬åˆ°ä¸‹ä¸€é¡µé¢.

å›¾ç‰‡ä¸‹é¢çš„æ•°æ®æ˜¯é€šè¿‡`koa`æœåŠ¡è¿”å›çš„æ•°æ®, ä¸‹è½½[coderZsq.target.swift](https://github.com/coderZsq/coderZsq.target.swift)ä¸­çš„`RouterPattern`ä¸­çš„`/server/RouterPattern`, `cd`è¿›å»åæ‰§è¡Œ`npm start`, å³å¯å¼€å¯æœåŠ¡. å½“ç„¶ä½ éœ€è¦`Node`, ç¯å¢ƒå’Œ`webpack`çš„å…¨å±€ç¯å¢ƒ.

å¦‚æœä½ éœ€è¦æŸ¥çœ‹äº†è§£`Router`éƒ¨åˆ†, å¯ä»¥é€šè¿‡[coderZsq.target.swift](https://github.com/coderZsq/coderZsq.target.swift)è¿™ä¸ªé¡¹ç›®è¿›è¡Œå­¦ä¹ äº¤æµ.

- `app/RouterPattern` ç›´æ¥åŒå‡»æ‰“å¼€é¡¹ç›®å³å¯
- `web/RouterPattern` `cd` è¿›å» `npm run dev`
- `server/RouterPattern` `cd` è¿›å» `npm start`

å…·ä½“å¯ä»¥æŸ¥çœ‹[Hybird æ­å»ºå®¢æˆ·ç«¯å®æ—¶é™çº§æ¶æ„](http://www.jianshu.com/p/7054a694cfeb)ç³»åˆ—.

æ³¨æ„!!! ä½¿ç”¨`git`ä¸Šä¼ æ—¶ä¼šé€šè¿‡`.gitignore`å¿½ç•¥ä¸Šä¼ æ–‡ä»¶, æ‰€ä»¥`pull`ä¸‹æ¥è®°å¾—`pod install`  `npm install`, è®°å¾—`pod install`  `npm install`è®°å¾—`pod install`  `npm install`, é‡è¦çš„äº‹æƒ…è¯´ä¸‰é!!

ä»¥ä¸Šå°±æ˜¯æˆ‘å¯¹äºç§»åŠ¨ç«¯æ¶æ„åˆæ¢çš„å¿ƒå¾—, æœŸå¾…ä¸å„ä½å¤§ä½¬è¿›è¡Œäº¤æµ.

##### About: 

![ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è·³è½¬!!](http://upload-images.jianshu.io/upload_images/1229762-3f8925783027b3fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

 [ğŸŒŸ é¡¹ç›®æºç  è¯·ç‚¹è¿™é‡ŒğŸŒŸ >>> å–œæ¬¢çš„æœ‹å‹è¯·ç‚¹å–œæ¬¢ >>> ä¸‹è½½æºç çš„åŒå­¦è¯·é€ä¸‹å°æ˜Ÿæ˜Ÿ >>> æœ‰é—²é’±çš„å£•ä»¬å¯ä»¥è¿›è¡Œæ‰“èµ >>> å°å¼Ÿä¼šå°½å¿«æ¨å‡ºæ›´å¥½çš„æ–‡ç« å’Œå¤§å®¶åˆ†äº« >>> ä½ çš„æ¿€åŠ±å°±æ˜¯æˆ‘çš„åŠ¨åŠ›!! ](https://github.com/coderZsq/coderZsq.project.oc)



